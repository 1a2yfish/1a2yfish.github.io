<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Java入门 | 1azy_fish.</title><meta name="author" content="1azy_fish."><meta name="copyright" content="1azy_fish."><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Before all拖了好久还是想学一学java。 java基础语法Java是一种面向对象的编程语言，具有简单、可靠、安全和可移植等特点。下面是一些Java基础语法的介绍：  类和对象：Java是面向对象的语言，所有的代码都必须在类中定义。一个类是对象的模版，用于创建对象。可以使用关键字class来定义类，例如：  123public class MyClass &amp;#123;    &#x2F;&#x2F; 类的成员"><meta property="og:type" content="article"><meta property="og:title" content="Java入门"><meta property="og:url" content="https://gitee.com/la2y_fish/blog.git/2023/11/07/Java%E5%85%A5%E9%97%A8/index.html"><meta property="og:site_name" content="1azy_fish."><meta property="og:description" content="Before all拖了好久还是想学一学java。 java基础语法Java是一种面向对象的编程语言，具有简单、可靠、安全和可移植等特点。下面是一些Java基础语法的介绍：  类和对象：Java是面向对象的语言，所有的代码都必须在类中定义。一个类是对象的模版，用于创建对象。可以使用关键字class来定义类，例如：  123public class MyClass &amp;#123;    &#x2F;&#x2F; 类的成员"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://gitee.com/la2y_fish/blog.git/img/19.jpg"><meta property="article:published_time" content="2023-11-07T08:35:58.000Z"><meta property="article:modified_time" content="2023-11-12T08:56:16.228Z"><meta property="article:author" content="1azy_fish."><meta property="article:tag" content="Java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://gitee.com/la2y_fish/blog.git/img/19.jpg"><link rel="shortcut icon" href="/blog/img/%E8%8A%9C%E6%B9%96.png"><link rel="canonical" href="https://gitee.com/la2y_fish/blog.git/2023/11/07/Java%E5%85%A5%E9%97%A8/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/blog/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:{limitDay:500,position:"top",messagePrev:"It has been",messageNext:"days since the last update, the content of the article may be outdated."},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Java入门",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-11-12 16:56:16"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.getCSS=(o,n=!1)=>new Promise((t,e)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/macBlack.css"><link rel="stylesheet" href="/blog/css/mouse.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/blog/img/head%20(1).jpg" onerror='onerror=null,src="/img/head (1).jpg"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/blog/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/blog/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/blog/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/blog/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/shuoshuo/"><i class="fa-fw fa fa-book"></i><span> 分享</span></a></li><li><a class="site-page child" href="/blog/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/blog/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/blog/movies/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/blog/tool/"><i class="fa-fw fas fa-box"></i><span> 工具箱（更新ing）</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/blog/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/blog/img/19.jpg)"><nav id="nav"><span id="blog-info"><a href="/blog/" title="1azy_fish."><span class="site-name">1azy_fish.</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/blog/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/shuoshuo/"><i class="fa-fw fa fa-book"></i><span> 分享</span></a></li><li><a class="site-page child" href="/blog/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/blog/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/blog/movies/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/blog/tool/"><i class="fa-fw fas fa-box"></i><span> 工具箱（更新ing）</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/blog/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java入门</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-07T08:35:58.000Z" title="发表于 2023-11-07 16:35:58">2023-11-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-12T08:56:16.228Z" title="更新于 2023-11-12 16:56:16">2023-11-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/blog/categories/Web/">Web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Java入门"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>拖了好久还是想学一学java。</p><h2 id="java基础语法"><a href="#java基础语法" class="headerlink" title="java基础语法"></a>java基础语法</h2><p>Java是一种面向对象的编程语言，具有简单、可靠、安全和可移植等特点。下面是一些Java基础语法的介绍：</p><ol><li>类和对象：Java是面向对象的语言，所有的代码都必须在类中定义。一个类是对象的模版，用于创建对象。可以使用关键字<code>class</code>来定义类，例如：</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">    <span class="comment">// 类的成员变量和方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方法：方法是类中执行特定任务的一组语句。每个方法都有一个名称和一组参数（可选），并可以返回一个值（也可以是<code>void</code>表示无返回值）。方法的定义包括方法的修饰符、返回类型、名称和参数列表，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>变量：变量用于存储数据，可以是基本类型或引用类型。在Java中，变量需要先声明，然后才能使用。声明变量时，需要指定变量的类型和名称，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> age; <span class="comment">// 声明一个名为age的整数变量</span></span><br></pre></td></tr></table></figure><p>数据类型：Java有两种数据类型，即基本类型和引用类型。基本类型包括整数类型（<code>byte</code>、<code>short</code>、<code>int</code>、<code>long</code>）、浮点类型（<code>float</code>、<code>double</code>）、字符类型（<code>char</code>）和布尔类型（<code>boolean</code>）。引用类型包括类、接口、数组等。</p><p>控制流语句：Java提供了一些控制流语句来控制程序的执行流程，包括条件语句（<code>if-else</code>、<code>switch</code>）、循环语句（<code>for</code>、<code>while</code>、<code>do-while</code>）和跳转语句（<code>break</code>、<code>continue</code>、<code>return</code>）等。</p><p>数组：数组是一组具有相同类型的数据元素的集合。在Java中，可以使用数组来存储和操作多个数据。数组的声明和初始化可以通过以下方式进行：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] numbers = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>]; <span class="comment">// 声明一个包含5个整数的数组</span></span><br></pre></td></tr></table></figure><p>输入输出：Java提供了<code>System.out</code>用于标准输出，可以使用<code>System.out.println()</code>打印文本到控制台。可以使用<code>Scanner</code>类来获取用户的输入，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入一个整数：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;你输入的整数是：&quot;</span> + num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/7.png" title="wuhu"><blockquote><p>好了我们学会1+1了，开始挖洞吧。（x</p></blockquote><h2 id="idea"><a href="#idea" class="headerlink" title="idea"></a>idea</h2><p>在IntelliJ IDEA中调试Java应用程序可以按照以下步骤进行：</p><ol><li>设置断点：在你认为有问题的代码行上设置断点。你可以在代码编辑器中单击行号旁边的空白处来设置断点，或者使用快捷键Ctrl + F8。</li><li>启动调试模式：在IntelliJ IDEA中，你可以通过多种方式启动调试模式，包括：<ul><li>在代码编辑器中单击断点行号旁边的调试按钮（绿色的虫子图标）。</li><li>使用快捷键Shift + F9。</li><li>在菜单栏中选择”Run” -&gt; “Debug”。</li></ul></li><li>配置调试配置：如果你是第一次进行调试，可能需要配置调试配置。IntelliJ IDEA会为你的应用程序自动创建一个调试配置，你可以在弹出的对话框中选择相应的配置。</li><li>访问应用程序：在调试模式下，你可以通过多种方式运行应用程序，包括：<ul><li>在IDEA中使用右上角的运行按钮（绿色的三角形图标）。</li><li>使用快捷键Shift + F10。</li><li>在菜单栏中选择”Run” -&gt; “Run”。</li></ul></li><li>调试过程：一旦应用程序进入断点，调试器会暂停应用程序的执行。你可以使用调试器的各种工具和功能来查看和修改变量的值，跳过代码行，单步执行代码等。常用的调试工具包括：<ul><li>变量观察窗口：显示当前作用域的变量及其值。</li><li>断点窗口：显示已设置的断点列表，并提供断点的管理功能。</li><li>控制台窗口：可以在断点暂停时执行命令，并查看输出结果。</li></ul></li><li>观察和分析：在调试过程中，观察应用程序的行为和变量的值。通过查看变量的值并与预期值进行比较，你可以找到问题所在。</li><li>修改代码：根据观察和分析的结果，你可以决定是否需要修改代码来修复问题。在这种情况下，你可以在IDEA中编辑代码并保存更改。</li><li>重新运行：一旦你修改了代码并保存更改，你可以停止调试模式并重新运行应用程序，以测试你的更改是否解决了问题。</li></ol><p>简单的调试如下：</p><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/2.png" title="wuhu"><h2 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h2><p>Maven是一个项目管理工具，用于构建、部署和管理Java项目。它提供了一种统一的方式来管理项目的依赖、编译、测试和部署等过程。</p><p>以下是Maven的一些基本特点和使用方式：</p><ol><li>项目对象模型（Project Object Model，POM）：Maven使用POM文件来描述项目的配置和依赖关系。POM是一个XML文件，定义了项目的坐标、依赖、构建配置等信息。</li><li>依赖管理：Maven通过POM文件中的依赖配置来管理项目的依赖库。你可以在POM文件中指定所需的依赖库和版本号，Maven会自动下载并管理这些依赖库。</li><li>构建生命周期：Maven定义了一套构建生命周期，包括一系列的阶段（Phase）和插件（Plugin）。通过在POM文件中配置构建插件和阶段，可以在构建过程中执行特定的任务，例如编译、测试、打包等。</li><li>中央仓库：Maven维护了一个中央仓库，包含了大量的开源Java库和插件。当你在POM文件中声明依赖时，Maven会自动从中央仓库下载相应的库文件。</li><li>插件系统：Maven具有强大的插件系统，可以通过插件扩展和定制构建过程。你可以使用现有的插件，也可以编写自己的插件来满足特定需求。</li><li>命令行工具和集成开发环境（IDE）支持：Maven提供了命令行工具和与主流IDE（如Eclipse、IntelliJ IDEA）的集成支持，方便项目的构建和管理。</li></ol><p>安装配置：下载配置环境变量就ok</p><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/1.png" title="wuhu"><p>如何加速</p><p>由于默认情况下执行 mvn 各种命令是去国外的 mvn 官方镜像源获取需要安装的具体软件信息，所以在不使用代理、不FQ的情况下，从国内访问国外服务器的速度相对比较慢</p><h3 id="如何修改镜像源"><a href="#如何修改镜像源" class="headerlink" title="如何修改镜像源"></a>如何修改镜像源</h3><p>阿里旗下维护着一个国内 maven 镜像源。感谢阿里为开源届，为开发者做的贡献，之前发布的两篇关于 npm, yarn 的国内加速镜像源也是使用阿里提供的，之后会发布一篇介绍 gradle 的国内加速方法，依旧会使用阿里提供的镜像源</p><h4 id="配置只在当前项目生效"><a href="#配置只在当前项目生效" class="headerlink" title="配置只在当前项目生效"></a>配置只在当前项目生效</h4><p>在 pom.xml 文件内添加以下配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>ali-maven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="配置全局生效"><a href="#配置全局生效" class="headerlink" title="配置全局生效"></a>配置全局生效</h4><p>修改 settings.xml 文件</p><p>找到 mirrors 标签，在里面加入以下内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以在以下路径查找到 settings.xml 文件</p><ol><li>(用户根目录)&#x2F;.m2&#x2F;settings.xml</li><li>(maven安装目录)&#x2F;conf&#x2F;settings.xml，</li></ol><p>如果以上两个位置同时存在 settings.xml 文件，用户根目录的配置文件权重更高</p><h3 id="各种常见Maven插件"><a href="#各种常见Maven插件" class="headerlink" title="各种常见Maven插件"></a>各种常见Maven插件</h3><p>我们可以通过<code>mvn help:describe</code>命令来查看插件、命令等操作的详细说明，比如我们在命令行执行<code>mvn help:describe -Dplugin=org.apache.maven.plugins:maven-jar-plugin</code>,便可以看到maven-jar-plugin插件的详细介绍</p><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/3.png" title="wuhu"><h4 id="maven-compiler-plugin"><a href="#maven-compiler-plugin" class="headerlink" title="maven-compiler-plugin"></a>maven-compiler-plugin</h4><p>该插件用于编译项目的源代码，用于设置和控制Java编译器的版本和参数。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">source</span>&gt;</span>18<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">target</span>&gt;</span>18<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>18<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span> <span class="comment">&lt;!--这里写的是jdk版本，通常是1.8--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>18<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span> <span class="comment">&lt;!--这里写的是jdk版本，通常是1.8--&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="maven-dependency-plugin"><a href="#maven-dependency-plugin" class="headerlink" title="maven-dependency-plugin"></a>maven-dependency-plugin</h4><p>用于复制依赖的jar包到指定的文件夹里</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-dependency-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>copy-dependencies<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>copy-dependencies<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/lib<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span><span class="comment">&lt;!--输出的文件夹--&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="maven-jar-plugin"><a href="#maven-jar-plugin" class="headerlink" title="maven-jar-plugin"></a>maven-jar-plugin</h4><p>jar项目默认的打包工具，默认情况下只会将项目源码编译生成的class文件和资源文件打包进来，不会打包进项目依赖的jar包。</p><p>打成jar时，设定manifest的参数，比如指定运行的Main class，还有依赖的jar包，加入classpath中</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-jar-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">archive</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">addClasspath</span>&gt;</span>true<span class="tag">&lt;/<span class="name">addClasspath</span>&gt;</span><span class="comment">&lt;!--指定信息--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">classpathPrefix</span>&gt;</span>/data/lib<span class="tag">&lt;/<span class="name">classpathPrefix</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.zhang.spring.App<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">archive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="maven-antrun-plugin"><a href="#maven-antrun-plugin" class="headerlink" title="maven-antrun-plugin"></a>maven-antrun-plugin</h4><p><code>maven-antrun-plugin</code> 是 Maven 的一个官方插件，主要用于在 Maven 构建过程中执行 Apache Ant 任务。下面是对这个插件的详细解释：</p><p><strong>Maven 与 Ant</strong>：</p><ul><li><strong>Maven</strong> 是一个项目管理和综合工具，提供了项目对象模型 (POM)、依赖管理和构建生命周期等功能。</li><li><strong>Ant</strong> 是一个用于构建 Java 应用程序的工具，类似于 <code>make</code>，但是使用 XML 格式的构建文件。</li></ul><p><strong>为什么需要 <code>maven-antrun-plugin</code>呢</strong>：</p><ul><li>尽管 Maven 有其自己的构建生命周期和任务系统，但有时，开发者可能希望或需要使用 Ant 中的某些特定功能或任务，这可能是因为它们在 Maven 中不容易实现，或者团队已经有现成的 Ant 脚本。</li><li><code>maven-antrun-plugin</code> 允许开发者在 Maven 构建中嵌入这些 Ant 任务。</li></ul><p><strong>功能</strong>：</p><ul><li>使用 <code>maven-antrun-plugin</code>，开发者可以定义要在 Maven 构建过程的特定阶段执行的 Ant 任务。</li><li>这提供了一个桥梁，允许在 Maven 构建中利用 Ant 的强大和灵活性。</li></ul><p><strong>常见用途</strong>：</p><ul><li>文件操作，如复制、移动和删除。</li><li>文本处理，如替换文件中的文本。</li><li>执行系统命令。</li><li>任何其他 Ant 可以执行但 Maven 不直接支持的任务。</li></ul><p>总的来说，<code>maven-antrun-plugin</code> 提供了一种在 Maven 构建中利用 Apache Ant 功能的方法。它为那些需要或想要在 Maven 项目中运行 Ant 任务的开发者提供了一个方便的工具。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-antrun-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>run<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span> <span class="attr">name</span>=<span class="string">&quot;copy&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">delete</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">fileset</span> <span class="attr">dir</span>=<span class="string">&quot;target&quot;</span> <span class="attr">includes</span>=<span class="string">&quot;*.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">fileset</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">copy</span> <span class="attr">todir</span>=<span class="string">&quot;target&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">fileset</span> <span class="attr">dir</span>=<span class="string">&quot;files&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">fileset</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">copy</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="wagon-maven-plugin"><a href="#wagon-maven-plugin" class="headerlink" title="wagon-maven-plugin"></a>wagon-maven-plugin</h4><p>用于一键部署，把本地打包的jar文件，上传到远程服务器上，并执行服务器上的shell命令</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>wagon-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">serverId</span>&gt;</span>crawler<span class="tag">&lt;/<span class="name">serverId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fromDir</span>&gt;</span>target<span class="tag">&lt;/<span class="name">fromDir</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span>*.jar,*.properties,*.sh<span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>sftp://服务器ip地址/home/dream<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commands</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">command</span>&gt;</span>chmod 755 /home/dream/update.sh<span class="tag">&lt;/<span class="name">command</span>&gt;</span><span class="comment">&lt;!--shell--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">command</span>&gt;</span>/home/dream/update.sh<span class="tag">&lt;/<span class="name">command</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commands</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">displayCommandOutputs</span>&gt;</span>true<span class="tag">&lt;/<span class="name">displayCommandOutputs</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="maven-shade-plugin"><a href="#maven-shade-plugin" class="headerlink" title="maven-shade-plugin"></a>maven-shade-plugin</h4><p>用于把多个jar包，打成1个jar包</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">transformers</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">transformer</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">implementation</span>=<span class="string">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">manifestEntries</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">Main-Class</span>&gt;</span>me.dream.App<span class="tag">&lt;/<span class="name">Main-Class</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">X-Compile-Source-JDK</span>&gt;</span>$&#123;maven.compile.source&#125;<span class="tag">&lt;/<span class="name">X-Compile-Source-JDK</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">X-Compile-Target-JDK</span>&gt;</span>$&#123;maven.compile.target&#125;<span class="tag">&lt;/<span class="name">X-Compile-Target-JDK</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">manifestEntries</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">transformer</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">transformers</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="maven-archetype-plugin"><a href="#maven-archetype-plugin" class="headerlink" title="maven-archetype-plugin"></a>maven-archetype-plugin</h4><p>Archtype指项目的骨架，Maven初学者最开始执行的Maven命令可能就是mvn archetype:generate，这实际上就是让maven-archetype-plugin生成一个很简单的项目骨架，帮助开发者快速上手。</p><p>可能也有人看到一些文档写了mvn archetype:create，但实际上create目标已经被弃用了，取而代之的是generate目标，该目标使用交互式的方式提示用户输入必要的信息以创建项目，体验更好。</p><p>maven-archetype-plugin还有一些其他目标帮助用户自己定义项目原型，例如你由一个产品需要交付给很多客户进行二次开发，你就可以为他们提供一个Archtype，帮助他们快速上手。</p><p>Maven Archetype Plugin是一个用于创建项目原型（archetype）的Maven插件。项目原型是一种用于快速生成新项目结构的模板。通过使用Maven Archetype Plugin，您可以定义并创建自己的项目原型，以便在需要时轻松生成项目结构。</p><p>以下是Maven Archetype Plugin的一些常见用法：</p><blockquote><ol><li>create：创建一个新的项目原型。您可以使用该目标指定原型的groupId、artifactId、version等信息，并选择要包含的文件和目录结构。</li><li>generate：根据指定的项目原型生成一个新项目。您可以使用该目标指定原型的groupId、artifactId、version等信息，并选择要包含的文件和目录结构。</li><li>list：列出所有可用的项目原型。使用该目标可以查看本地或远程仓库中可用的项目原型列表。</li><li>delete：删除本地仓库中的指定项目原型。</li></ol></blockquote><p>使用示例：</p><p>创建项目原型：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate</span><br><span class="line">  -DgroupId=com.example</span><br><span class="line">  -DartifactId=my-project</span><br><span class="line">  -Dversion=<span class="number">1</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">  -DarchetypeGroupId=org.apache.maven.archetypes</span><br><span class="line">  -DarchetypeArtifactId=maven-archetype-quickstart</span><br></pre></td></tr></table></figure><p>上述命令将使用”Maven Quickstart Archetype”原型创建一个名为”my-project”的新项目。可以根据需要修改groupId、artifactId和version参数。</p><ol><li>选择项目原型：<br>当执行上述命令时，Maven会列出可用的项目原型列表供您选择。您可以根据列表中的编号选择相应的原型。例如，选择编号为1的原型。</li><li>生成新项目：<br>根据您的选择，Maven Archetype Plugin将在当前目录中生成一个新的项目结构，包括源代码、测试代码、资源文件等。</li></ol><p>groupId、artifactId和version是Maven项目的核心标识和版本信息。</p><ol><li>groupId：groupId代表项目所属的组织或团队的唯一标识。通常使用反向域名的方式来命名，例如”com.example”。groupId用于确保项目的唯一性，并帮助组织和识别项目。</li><li>artifactId：artifactId代表项目的唯一标识符。通常使用项目名称来命名，例如”my-project”。artifactId用于识别和定位项目，它是项目构建产物（如JAR包、WAR包）的名称。</li><li>version：version代表项目的版本号。它是一个字符串，可以是数字和字符的组合，例如”1.0.0”。version用于标识和管理项目的不同版本，以便开发者和用户可以区分不同的发布版本。</li></ol><p>这些参数在Maven项目的构建、依赖管理和部署过程中非常重要。它们可以确保项目的唯一性、版本控制和协作开发。在Maven的pom.xml文件中，这些参数通常作为项目的基本信息和属性定义。通过使用这些参数，Maven可以根据项目标识和版本信息来管理和构建项目。</p><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/4.png" title="wuhu"><h4 id="maven-assembly-plugin"><a href="#maven-assembly-plugin" class="headerlink" title="maven-assembly-plugin"></a>maven-assembly-plugin</h4><p>该插件的用途是制作项目分发包，该分发包可能包含了项目的可执行文件、源代码、readme、平台脚本等等。</p><p>一些常用配置和用法：</p><blockquote><ol><li>配置assembly描述符：在项目的pom.xml文件中，您可以定义一个assembly描述符，用于指定要打包的文件和目录结构、包含&#x2F;排除的规则、文件的权限等。描述符通常以assembly.xml或assembly.xml文件的形式存在。</li><li>定义组件：在assembly描述符中，您可以定义一个或多个组件。每个组件可以指定一个或多个文件和目录，以及打包到发布包中的路径和文件名。</li><li>指定发布包类型：Maven Assembly Plugin支持多种发布包类型，如JAR、ZIP、TAR等。您可以在assembly描述符中指定所需的发布包类型。</li><li>配置附加构建阶段：通过配置Maven Assembly Plugin的execution元素，您可以指定插件在项目构建的特定阶段执行。例如，您可以配置插件在package阶段之后执行，以便在打包完成后生成自定义的发布包。</li><li>自定义文件、目录、权限等：通过配置assembly描述符，您可以自定义发布包中的文件、目录和文件权限。您可以包括额外的资源文件、配置文件，以及调整文件的权限和属性。</li></ol></blockquote><p>maven-assembly-plugin要求用户使用一个名为assembly.xml的元数据文件来表述打包，它的single目标可以直接在命令行调用，也可以被绑定至生命周期。</p><p>下面是一个使用Maven Assembly Plugin创建可执行JAR包的示例：</p><p>在项目的pom.xml文件中，添加Maven Assembly Plugin的配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">descriptor</span>&gt;</span>src/assembly/assembly.xml<span class="tag">&lt;/<span class="name">descriptor</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>create-executable-jar<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>single<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在项目中创建一个名为assembly.xml的assembly描述符，指定要打包的文件和目录结构：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">assembly</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>executable-jar<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">formats</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">format</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">format</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">formats</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">files</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">source</span>&gt;</span>target/my-project.jar<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>/<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">files</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencySets</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencySet</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>/lib<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">unpack</span>&gt;</span>false<span class="tag">&lt;/<span class="name">unpack</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencySet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencySets</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">assembly</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述描述符指定了一个名为”executable-jar”的组件，将target目录下的my-project.jar文件打包到发布包的根目录，并将依赖的JAR文件放入lib目录。</p><p>运行以下命令生成可执行JAR包：</p><p><code>mvn package</code></p><p>执行完上述命令后，Maven Assembly Plugin将在target目录下生成一个名为my-project-assembly.jar的可执行JAR包，包含了您在assembly.xml中定义的文件和目录结构。</p><h4 id="maven-dependency-plugin-1"><a href="#maven-dependency-plugin-1" class="headerlink" title="maven-dependency-plugin"></a>maven-dependency-plugin</h4><p>最大的用途是帮助分析项目依赖</p><blockquote><ol><li>list：列出项目的依赖关系。可以使用该目标查看项目的直接依赖、传递依赖和冲突依赖。</li><li>tree：以树状结构展示项目的依赖关系。可以使用该目标查看项目依赖的层级结构和依赖传递路径。</li><li>analyze：分析项目的依赖关系。可以使用该目标找出项目中未使用的依赖、潜在的冲突依赖和过时的依赖。</li><li>copy：复制项目的依赖到指定目录。可以使用该目标将项目的依赖复制到指定的目录，便于离线构建或其他用途。</li><li>unpack：解压项目的依赖。可以使用该目标将项目依赖的JAR文件解压到指定的目录，以便查看或修改依赖的内容。</li></ol></blockquote><p>Maven Dependency Plugin还支持其他配置和参数，例如指定依赖的范围、排除依赖、过滤依赖等。</p><blockquote><ol><li><p>列出项目的依赖关系：<code>mvn dependency:list</code></p><p>上述命令将列出项目的直接依赖和传递依赖，包括每个依赖的groupId、artifactId、版本号等信息。</p></li><li><p>以树状结构展示项目的依赖关系：<code>mvn dependency:tree</code></p><p>这个命令将以树状结构展示项目的依赖关系，显示每个依赖的groupId、artifactId、版本号及其传递路径。</p></li><li><p>分析项目的依赖关系：<code>mvn dependency:analyze</code></p><p>该命令将分析项目的依赖关系，找出未使用的依赖、潜在的冲突依赖和过时的依赖，并提供相应的建议。</p></li><li><p>复制项目的依赖到指定目录：<code>mvn dependency:copy-dependencies -DoutputDirectory=/path/to/directory</code></p><p>上述命令将项目的依赖复制到指定的目录，便于离线构建或其他用途。</p></li><li><p>解压项目的依赖：<code>mvn dependency:unpack -Dartifact=groupId:artifactId:version -DoutputDirectory=/path/to/directory</code></p><p>这个命令将指定的依赖JAR文件解压到指定的目录，以便查看或修改依赖的内容。</p></li></ol></blockquote><h4 id="maven-enforcer-plugin"><a href="#maven-enforcer-plugin" class="headerlink" title="maven-enforcer-plugin"></a>maven-enforcer-plugin</h4><p>Maven Enforcer Plugin是一个用于强制执行构建规则和限制的Maven插件。它提供了一系列目标，可以帮助您在构建过程中强制执行各种规则和限制，以确保项目的构建和质量符合预期。</p><p>用法：</p><blockquote><ol><li>enforce：强制执行规则和限制。可以使用该目标配置和应用各种规则，例如强制使用特定的Maven版本、限制依赖的版本范围、强制执行特定的构建配置等。</li><li>display-info：显示构建信息。可以使用该目标显示有关构建环境、插件版本、配置信息等的详细信息。</li><li>display-requirement：显示规则和限制信息。可以使用该目标显示已配置的规则和限制的详细信息。</li><li>display-properties：显示项目属性。可以使用该目标显示项目中定义的属性及其值。</li><li>display-plugin-updates：显示插件更新信息。可以使用该目标显示项目中可用的插件的最新版本和更新说明。</li></ol></blockquote><p>Maven Enforcer Plugin还支持其他配置和参数，例如自定义规则、忽略规则、设置规则的错误级别等。</p><p>示例：</p><p>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-enforcer-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0-M3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>enforce-maven-version<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>enforce<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">rules</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">requireMavenVersion</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">requireMavenVersion</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">rules</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了一个执行阶段（execution），并配置了一个要求Maven版本的规则。该规则要求使用的Maven版本必须是3.6.3。</p><p>接下来，执行以下命令来验证规则是否被强制执行：</p><p><code>mvn clean install</code></p><p>如果当前使用的Maven版本不符合规定的要求（不是3.6.3），则构建将失败，并显示类似以下的错误信息：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ERROR] Failed to execute goal org.apache.maven.plugins:maven-enforcer-plugin:<span class="number">3</span>.<span class="number">0</span>.<span class="number">0</span>-M3:enforce (enforce-maven-version) on project your-project: Some Enforcer rules have failed. Look above <span class="keyword">for</span> specific messages explaining why the rule failed. -&gt; [<span class="built_in">Help</span> <span class="number">1</span>]</span><br></pre></td></tr></table></figure><h4 id="maven-help-plugin"><a href="#maven-help-plugin" class="headerlink" title="maven-help-plugin"></a>maven-help-plugin</h4><p>maven-help-plugin是一个小巧的辅助工具。</p><p>最简单的<code>mvn help:system</code>可以打印所有可用的环境变量和Java系统属性。</p><p><code>mvn help:effective-pom</code>和<code>mvn help:effective-settings</code>最为有用，它们分别打印项目的有效POM和有效settings，有效POM是指合并了所有父POM（包括Super POM）后的XML，</p><p>当你不确定POM的某些信息从何而来时，就可以查看有效POM。</p><p>有效settings同理，特别是当你发现自己配置的settings.xml没有生效时，就可以用<code>mvn help:effective-settings</code>来验证。</p><p>此外，maven-help-plugin的describe目标可以帮助你描述任何一个Maven插件的信息，还有all-profiles目标和active-profiles目标帮助查看项目的Profile。</p><h4 id="maven-release-plugin"><a href="#maven-release-plugin" class="headerlink" title="maven-release-plugin"></a>maven-release-plugin</h4><p>该插件的用途是帮助自动化项目版本发布，它依赖于POM中的SCM信息。</p><p>用法：</p><blockquote><ol><li>prepare：准备发布。执行该目标将自动更新项目的版本号、生成发布文档、打上版本标签等。</li><li>perform：执行发布。执行该目标将自动构建项目、生成发布包，并将发布包发布到远程Maven仓库。</li><li>rollback：回滚发布。执行该目标将回滚之前准备的发布操作，恢复项目到之前的状态。</li><li>release：执行完整的发布流程。执行该目标将依次执行prepare和perform目标，实现自动化的版本管理和发布过程。</li></ol></blockquote><p>示例配置和命令：</p><p>首先，在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-release-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0-M5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tagNameFormat</span>&gt;</span>@&#123;project.version&#125;<span class="tag">&lt;/<span class="name">tagNameFormat</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">autoVersionSubmodules</span>&gt;</span>true<span class="tag">&lt;/<span class="name">autoVersionSubmodules</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Maven Release Plugin的版本为3.0.0-M5，并配置了一些参数。<code>tagNameFormat</code>参数指定了标签名的格式，使用了项目的版本号作为标签名。<code>autoVersionSubmodules</code>参数指定是否自动版本化子模块。</p><p>接下来，执行以下命令来执行版本管理和发布操作：</p><p><code>mvn release:prepare</code></p><p>上述命令会执行准备发布的操作，包括更新版本号、生成发布文档、打上版本标签等。根据配置的参数，插件会自动化处理子模块的版本管理。</p><p>完成准备发布后，可以执行以下命令来执行实际的发布操作：</p><p><code>mvn release:perform</code></p><p>上述命令会构建项目、生成发布包，并将发布包发布到远程Maven仓库。</p><p>如果需要回滚之前的发布操作，可以执行以下命令：</p><p><code>mvn release:rollback</code></p><p>上述命令会回滚之前准备的发布操作，恢复项目到之前的状态。</p><h4 id="maven-resources-plugin"><a href="#maven-resources-plugin" class="headerlink" title="maven-resources-plugin"></a>maven-resources-plugin</h4><p>为了使项目结构更为清晰，Maven区别对待Java代码文件和资源文件，maven-compiler-plugin用来编译Java代码，maven-resources-plugin则用来处理资源文件。</p><p>以下是Maven Resources Plugin的一些常见用法：</p><blockquote><ol><li>resources：复制项目资源。执行该目标将复制项目中的资源文件到指定的输出目录。</li><li>testResources：复制测试资源。执行该目标将复制测试代码中的资源文件到指定的输出目录。</li><li>copy-resources：复制指定资源。执行该目标可以复制指定的资源文件或目录到指定的输出目录。</li><li>filtering：过滤资源。执行该目标将对资源文件进行变量替换，替换掉配置文件中的占位符等。</li></ol></blockquote><p>Maven Resources Plugin还支持其他配置和参数，例如指定资源文件的包含或排除规则、设置输出目录、配置变量替换等。</p><p>示例配置和命令：</p><p>复制项目资源：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/custom-resources<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Maven Resources Plugin的版本为3.2.0，并配置了一个<code>outputDirectory</code>参数，指定资源文件的输出目录为<code>$&#123;project.build.directory&#125;/custom-resources</code>。</p><p>然后，执行以下命令来复制项目资源：</p><p><code>mvn resources:resources</code></p><p>上述命令将会复制项目中的资源文件到指定的输出目录。</p><p>复制测试资源：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">id</span>&gt;</span>copy-test-resources<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">phase</span>&gt;</span>generate-test-resources<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>testResources<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/custom-test-resources<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们配置了一个<code>testResources</code>目标，并将其绑定到<code>generate-test-resources</code>阶段。我们还指定了一个<code>outputDirectory</code>参数，指定测试资源文件的输出目录为<code>$&#123;project.build.directory&#125;/custom-test-resources</code>。</p><p>然后，执行以下命令来复制测试资源：</p><p><code>mvn resources:testResources</code></p><p>上述命令将会复制测试代码中的资源文件到指定的输出目录。</p><h4 id="maven-surefire-plugin"><a href="#maven-surefire-plugin" class="headerlink" title="maven-surefire-plugin"></a>maven-surefire-plugin</h4><p>Maven Surefire Plugin是一个用于执行项目测试的Maven插件。它提供了一组目标，用于自动化运行测试代码、生成测试报告以及处理测试覆盖率等。</p><p>以下是Maven Surefire Plugin的一些常见用法：</p><blockquote><ol><li>test：运行测试。执行该目标将自动运行项目中的测试代码。</li><li>report：生成测试报告。执行该目标将生成测试结果的报告文件，例如HTML、XML等格式。</li><li>test-compile：编译测试代码。执行该目标将编译项目中的测试代码。</li><li>test-coverage：生成测试覆盖率报告。执行该目标将生成测试代码的覆盖率报告。</li></ol></blockquote><p>Maven Surefire Plugin还支持其他配置和参数，例如指定测试代码的包含或排除规则、设置测试报告的输出目录、配置并行执行等。</p><p>示例配置和命令：</p><p>运行测试：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0-M5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*Test.java<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Maven Surefire Plugin的版本为3.0.0-M5，并配置了一个<code>includes</code>参数，指定要运行的测试类的包含规则。</p><p>然后，执行以下命令来运行测试：</p><p><code>mvn surefire:test</code></p><p>上述命令将会自动运行项目中符合包含规则的测试代码。</p><p>生成测试报告：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0-M5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*Test.java<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>surefire-report<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>report<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们配置了一个<code>report</code>目标，并将其绑定到<code>test</code>阶段。我们还指定了一个<code>includes</code>参数，指定要生成测试报告的测试类的包含规则。</p><p>然后，执行以下命令来生成测试报告：</p><p><code>mvn surefire:report</code></p><p>上述命令将会生成测试结果的报告文件，通常以HTML格式呈现。</p><h4 id="build-helper-maven-plugin"><a href="#build-helper-maven-plugin" class="headerlink" title="build-helper-maven-plugin"></a>build-helper-maven-plugin</h4><p>Build Helper Maven Plugin是一个用于扩展Maven构建的插件。它提供了一组目标，用于动态添加、修改和管理Maven项目的构建信息。</p><p>以下是Build Helper Maven Plugin的一些常见用法：</p><blockquote><ol><li>add-source：添加源代码目录。执行该目标将向项目中添加额外的源代码目录，使其能够被编译和构建。</li><li>add-test-source：添加测试源代码目录。执行该目标将向项目中添加额外的测试源代码目录，使其能够被编译和运行测试。</li><li>add-resource：添加资源目录。执行该目标将向项目中添加额外的资源目录，使其能够被复制到构建输出目录。</li><li>add-test-resource：添加测试资源目录。执行该目标将向项目中添加额外的测试资源目录，使其能够被复制到测试构建输出目录。</li></ol></blockquote><p>Build Helper Maven Plugin还支持其他配置和参数，例如指定源代码或资源的目录位置、配置过滤器等。</p><p>示例配置和命令：</p><p>添加源代码目录：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>build-helper-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>generate-sources<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">sources</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">source</span>&gt;</span>src/main/java2<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">sources</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Build Helper Maven Plugin的版本为3.2.0，并配置了一个<code>add-source</code>目标，并将其绑定到<code>generate-sources</code>阶段。我们指定了一个<code>sources</code>参数，指定要添加的源代码目录为<code>src/main/java2</code>。</p><p>然后，执行以下命令来添加源代码目录：</p><p><code>mvn build-helper:add-source</code></p><p>上述命令将会向项目中添加指定的源代码目录。</p><p>添加资源目录：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>build-helper-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>add-resource<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>generate-resources<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-resource<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources2<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Build Helper Maven Plugin的版本为3.2.0，并配置了一个<code>add-resource</code>目标，并将其绑定到<code>generate-resources</code>阶段。我们指定了一个<code>resources</code>参数，指定要添加的资源目录为<code>src/main/resources2</code>。</p><p>然后，执行以下命令来添加资源目录：</p><p><code>mvn build-helper:add-resource</code></p><p>上述命令将会向项目中添加指定的资源目录。</p><h4 id="exec-maven-plugin"><a href="#exec-maven-plugin" class="headerlink" title="exec-maven-plugin"></a>exec-maven-plugin</h4><p>Exec Maven Plugin是一个用于在Maven构建过程中执行外部命令的插件。它提供了一组目标，用于在构建过程中执行自定义的命令行脚本或外部程序。</p><p>以下是Exec Maven Plugin的一些常见用法：</p><blockquote><ol><li>exec：执行命令行脚本或外部程序。通过配置该目标，可以在构建过程中执行自定义的命令行脚本或外部程序。</li><li>java：执行Java程序。通过配置该目标，可以在构建过程中执行Java程序，例如运行测试类、启动应用程序等。</li><li>execSet：执行一组命令。通过配置该目标，可以执行多个命令行脚本或外部程序，按顺序执行。</li></ol></blockquote><p>Exec Maven Plugin还支持其他配置和参数，例如指定命令行参数、设置工作目录、配置环境变量等。</p><p>示例配置和命令：</p><p>执行命令行脚本：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>execute-command<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>process-resources<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>exec<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">executable</span>&gt;</span>echo<span class="tag">&lt;/<span class="name">executable</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">argument</span>&gt;</span>Hello, 1azy_fish!<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Exec Maven Plugin的版本为3.0.0，并配置了一个<code>exec</code>目标，并将其绑定到<code>process-resources</code>阶段。我们使用<code>executable</code>参数指定要执行的命令行脚本，然后使用<code>arguments</code>参数指定脚本的参数。</p><p>然后，执行以下命令来执行命令行脚本：<code>mvn exec:exec</code></p><p>上述命令将会执行我们指定的命令行脚本，输出”Hello, 1azy_fish!”。</p><p>执行Java程序：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>execute-java<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>java<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.example.MyApp<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">argument</span>&gt;</span>arg1<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">argument</span>&gt;</span>arg2<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Exec Maven Plugin的版本为3.0.0，并配置了一个<code>java</code>目标，并将其绑定到<code>test</code>阶段。我们使用<code>mainClass</code>参数指定要执行的Java程序的主类，然后使用<code>arguments</code>参数指定程序的参数。</p><p>然后，执行以下命令来执行Java程序：<code>mvn exec:java</code></p><p>上述命令将会执行我们指定的Java程序，传递参数”arg1”和”arg2”给程序。</p><h4 id="jetty-maven-plugin"><a href="#jetty-maven-plugin" class="headerlink" title="jetty-maven-plugin"></a>jetty-maven-plugin</h4><p>Jetty Maven Plugin是一个用于在Maven构建过程中启动和管理Jetty Web服务器的插件。它提供了一组目标，用于在开发和测试阶段快速启动和部署Web应用程序。</p><p>以下是Jetty Maven Plugin的一些常见用法：</p><blockquote><ol><li>jetty:run：启动Jetty服务器。执行该目标将启动内嵌的Jetty服务器，并将当前项目部署到该服务器上。可以通过访问<code>http://localhost:8080</code>来访问部署的应用程序。</li><li>jetty:run-forked：以独立进程方式启动Jetty服务器。执行该目标将启动一个独立的Jetty服务器进程，并将当前项目部署到该服务器上。</li><li>jetty:deploy：部署Web应用程序。执行该目标将构建和打包项目，并将生成的WAR文件部署到Jetty服务器中。可以通过访问<code>http://localhost:8080</code>来访问部署的应用程序。</li></ol></blockquote><p>Jetty Maven Plugin还支持其他配置和参数，例如指定端口号、上下文路径、配置SSL等。</p><p>示例配置和命令：</p><p>启动Jetty服务器：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetty-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.4.43.v20210629<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">webApp</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">contextPath</span>&gt;</span>/<span class="tag">&lt;/<span class="name">contextPath</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">webApp</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Jetty Maven Plugin的版本为9.4.43.v20210629，并配置了一个<code>jetty-maven-plugin</code>插件。我们通过<code>configuration</code>元素可以配置插件的参数。在上述示例中，我们指定了Web应用程序的上下文路径为<code>/</code>。</p><p>然后，执行以下命令来启动Jetty服务器：<code>mvn jetty:run</code></p><p>上述命令将会启动Jetty服务器，并将当前项目部署到该服务器上。可以通过访问<code>http://localhost:8080</code>来访问部署的应用程序。</p><p>部署Web应用程序：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jetty-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.4.43.v20210629<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">webApp</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">contextPath</span>&gt;</span>/myapp<span class="tag">&lt;/<span class="name">contextPath</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">webApp</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Jetty Maven Plugin的版本为9.4.43.v20210629，并配置了一个<code>jetty-maven-plugin</code>插件。我们通过<code>configuration</code>元素可以配置插件的参数。在上述示例中，我们指定了Web应用程序的上下文路径为<code>/myapp</code>。</p><p>然后，执行以下命令来部署Web应用程序：<code>mvn jetty:deploy</code></p><p>上述命令将会构建和打包项目，并将生成的WAR文件部署到Jetty服务器中。可以通过访问<code>http://localhost:8080/myapp</code>来访问部署的应用程序。</p><h4 id="versions-maven-plugin"><a href="#versions-maven-plugin" class="headerlink" title="versions-maven-plugin"></a>versions-maven-plugin</h4><p>很多Maven用户遇到过这样一个问题，当项目包含大量模块的时候，为他们集体更新版本就变成一件烦人的事情，到底有没有自动化工具能帮助完成这件事情呢？</p><p>（当然你可以使用sed之类的文本操作工具，不过不在本文讨论范围）答案是肯定的，versions-maven- plugin提供了很多目标帮助你管理Maven项目的各种版本信息。</p><p>以下是Versions Maven Plugin的一些常见用法：</p><blockquote><ol><li>versions:display-dependency-updates：显示更新的依赖版本。执行该目标将显示当前项目依赖的库中可用的新版本。</li><li>versions:display-plugin-updates：显示更新的插件版本。执行该目标将显示当前项目中可用的新插件版本。</li><li>versions:update-properties：更新项目属性中的依赖版本。执行该目标将根据可用的新版本更新项目属性中的依赖版本。</li></ol></blockquote><p>Versions Maven Plugin还支持其他配置和参数，例如指定要排除的依赖、配置更新策略等。</p><p>示例：</p><p>显示更新的依赖版本：<br>执行以下命令来显示项目中可用的更新的依赖版本：<code>mvn versions:display-dependency-updates</code></p><p>显示更新的插件版本：<br>执行以下命令来显示项目中可用的更新的插件版本：<code>mvn versions:display-plugin-updates</code></p><p>更新项目属性中的依赖版本：<br>执行以下命令来更新项目属性中的依赖版本：<code>mvn versions:update-properties</code></p><h4 id="maven-war-plugin"><a href="#maven-war-plugin" class="headerlink" title="maven-war-plugin"></a>maven-war-plugin</h4><p>war项目默认的打包工具，默认情况下会打包项目编译生成的.class文件、资源文件以及项目依赖的所有jar包。</p><p>示例：</p><p>将项目打包为WAR文件：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">warSourceDirectory</span>&gt;</span>src/main/webapp<span class="tag">&lt;/<span class="name">warSourceDirectory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">failOnMissingWebXml</span>&gt;</span>false<span class="tag">&lt;/<span class="name">failOnMissingWebXml</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Maven War Plugin的版本为3.3.1，并配置了一个<code>maven-war-plugin</code>插件。我们通过<code>configuration</code>元素可以配置插件的参数。在上述示例中，我们指定了Web资源目录为<code>src/main/webapp</code>，并设置<code>failOnMissingWebXml</code>参数为<code>false</code>，表示允许项目中没有<code>web.xml</code>文件。</p><p>然后，执行以下命令来将项目打包为WAR文件：<code>mvn war:war</code></p><p>将项目解压为目录结构：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">warSourceDirectory</span>&gt;</span>src/main/webapp<span class="tag">&lt;/<span class="name">warSourceDirectory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">failOnMissingWebXml</span>&gt;</span>false<span class="tag">&lt;/<span class="name">failOnMissingWebXml</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">webappDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/exploded<span class="tag">&lt;/<span class="name">webappDirectory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们添加了一个<code>webappDirectory</code>配置，将解压后的文件和目录结构输出到<code>$&#123;project.build.directory&#125;/exploded</code>目录。</p><p>然后，执行以下命令来将项目解压为目录结构：<code>mvn war:exploded</code></p><h4 id="maven-shade-plugin-1"><a href="#maven-shade-plugin-1" class="headerlink" title="maven-shade-plugin"></a>maven-shade-plugin</h4><p>需要在pom文件的plugin元素中引入才可以使用，它可以让用户配置Main-Class的值，然后在打包的时候将值填入&#x2F;META-INF&#x2F;MANIFEST.MF文件。关于项目的依赖，它很聪明地将依赖的JAR文件全部解压后，再将得到的.class文件连同当前项目的.class文件一起合并到最终的CLI包(可以直接运行的jar包)中，这样，在执行CLI JAR文件的时候，所有需要的类就都在Classpath中了。</p><p>示例配置和命令：</p><p>将项目及其依赖库打包为可执行的JAR文件：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">createDependencyReducedPom</span>&gt;</span>false<span class="tag">&lt;/<span class="name">createDependencyReducedPom</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">transformers</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">transformer</span> <span class="attr">implementation</span>=<span class="string">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.example.Main<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">transformer</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">transformers</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们指定了Maven Shade Plugin的版本为3.2.4，并配置了一个<code>maven-shade-plugin</code>插件。我们通过<code>configuration</code>元素可以配置插件的参数。在上述示例中，我们设置<code>createDependencyReducedPom</code>为<code>false</code>，表示不生成精简的POM文件。我们还添加了一个<code>transformers</code>配置，指定了一个<code>ManifestResourceTransformer</code>转换器，其中指定了主类为<code>com.example.Main</code>。</p><p>然后，执行以下命令来将项目及其依赖库打包为可执行的JAR文件：<code>mvn package</code></p><p>上述命令将会构建和打包项目，并生成一个包含所有依赖库的JAR文件。</p><p>对依赖库进行重定位：<br>在项目的pom.xml文件中添加以下插件配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">relocations</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">relocation</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>com.google.common<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">shadedPattern</span>&gt;</span>myapp.shaded.com.google.common<span class="tag">&lt;/<span class="name">shadedPattern</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">relocation</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">relocations</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述配置中，我们添加了一个<code>relocations</code>配置，指定了一个重定位规则，将<code>com.google.common</code>包重命名为<code>myapp.shaded.com.google.common</code>。</p><p>然后，执行以下命令来对依赖库进行重定位：<code>mvn package</code></p><p>上述命令将会构建和打包项目，并将符合重定位规则的依赖库进行重命名。</p><h3 id="Maven多模块项目"><a href="#Maven多模块项目" class="headerlink" title="Maven多模块项目"></a>Maven多模块项目</h3><p>Maven多模块项目是指由多个子模块组成的项目结构。每个子模块都是一个独立的项目，可以有自己的源代码、资源文件、依赖等。这种项目结构使得大型项目能够更好地组织和管理，提高了代码的可维护性和复用性。</p><p>在Maven中，多模块项目通过父子关系来组织。通常，一个Maven多模块项目会有一个顶级的父项目，以及多个子项目（也称为模块）。父项目负责统一管理子项目的依赖、构建配置等，子项目可以继承父项目的配置，也可以有自己的特定配置。</p><p>多模块项目的好处包括：</p><blockquote><ol><li>提供了更好的代码组织结构：多模块项目可以将相关的功能模块或组件划分为独立的子模块，使得代码更加有序和可维护。</li><li>支持代码复用和共享：子模块之间可以共享代码、资源和依赖，提高了代码的复用性和共享性。</li><li>管理依赖更加方便：父项目可以集中管理所有子项目的依赖库版本，避免版本冲突和重复引入。</li><li>允许并行构建和测试：由于子模块之间是相互独立的，因此可以并行地构建和测试各个子模块，提高构建速度和效率。</li></ol></blockquote><p>Maven多模块项目的结构如下所示：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">my-parent-project</span><br><span class="line">├── module1</span><br><span class="line">│   ├── src</span><br><span class="line">│   ├── pom.xml</span><br><span class="line">├── module2</span><br><span class="line">│   ├── src</span><br><span class="line">│   ├── pom.xml</span><br><span class="line">├── module3</span><br><span class="line">│   ├── src</span><br><span class="line">│   ├── pom.xml</span><br><span class="line">├── pom.xml</span><br></pre></td></tr></table></figure><p>在父项目的pom.xml中，使用<code>&lt;modules&gt;</code>元素列出所有的子模块。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>module1<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>module2<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>module3<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br></pre></td></tr></table></figure><p>每个子模块都有自己的pom.xml文件，用于配置该模块的构建和依赖等信息。父项目和子项目之间可以通过Maven的继承机制来共享和继承配置。</p><h3 id="Gradle是啥？？？"><a href="#Gradle是啥？？？" class="headerlink" title="Gradle是啥？？？"></a>Gradle是啥？？？</h3><p>Gradle是一种开源的自动化构建工具，用于构建、测试和部署软件项目。它是基于Groovy编程语言和DSL（领域特定语言）的构建工具，具有强大的灵活性和可扩展性。</p><p>以下是Gradle的一些特点和优势：</p><ol><li>声明式构建脚本：Gradle使用基于Groovy的DSL来定义构建脚本，使得构建逻辑更易于理解和维护。构建脚本可以声明项目的依赖、任务和构建流程等。</li><li>高度可定制：Gradle提供了丰富的插件和扩展机制，可以根据项目的需求定制构建逻辑。开发人员可以编写自己的插件，或者使用现有的插件来扩展Gradle的功能。</li><li>多项目支持：Gradle支持多项目构建，可以轻松管理和构建复杂的多模块项目。通过定义项目之间的依赖关系，可以实现模块化的构建和自动化任务的执行。</li><li>并行构建：Gradle能够根据项目的依赖关系和任务之间的依赖关系，自动进行任务的并行执行，提高构建效率。</li><li>强大的依赖管理：Gradle支持各种依赖管理工具，如Maven和Ivy，可以轻松管理项目的依赖库。它还支持动态版本解析和增量构建，提供了更高效的依赖管理机制。</li><li>跨平台支持：Gradle可以在各种操作系统上运行，包括Windows、Linux和Mac OS等。它通过使用Java虚拟机（JVM）来实现跨平台的支持。</li></ol><p>Gradle被广泛应用于Java、Android和Kotlin等项目的构建和自动化。</p><p>（不想再学下去，暂时先学maven</p><h2 id="Java-Web"><a href="#Java-Web" class="headerlink" title="Java Web"></a>Java Web</h2><h3 id="Servlet-Tomcat-JSP"><a href="#Servlet-Tomcat-JSP" class="headerlink" title="Servlet Tomcat JSP"></a>Servlet Tomcat JSP</h3><p>Servlet、Tomcat和JSP是Java Web开发中常用的技术组合，用于构建动态的Web应用程序。</p><ol><li>Servlet（服务器端小程序）：Servlet是Java编写的服务器端程序，用于处理Web请求和生成动态的Web内容。它可以接收HTTP请求并生成响应，通常用于处理表单提交、用户身份验证、数据查询等任务。Servlet通常被部署在Servlet容器中（如Tomcat），并通过URL映射来处理特定的请求。</li><li>Tomcat（Apache Tomcat）：Tomcat是一个开源的Servlet容器和Web服务器，用于运行Java Web应用程序。它是Java Servlet和JavaServer Pages（JSP）规范的参考实现之一。Tomcat提供了一个运行环境，可以加载和执行Servlet和JSP，并处理HTTP请求和响应。开发人员可以将他们的Servlet和JSP部署到Tomcat中，以提供Web应用程序的服务。</li><li>JSP（JavaServer Pages）：JSP是一种用于在服务器端生成动态Web内容的技术。它允许开发人员在HTML页面中嵌入Java代码，以便动态地生成页面内容。JSP可以与Servlet一起使用，Servlet负责处理请求和业务逻辑，而JSP负责生成动态的HTML页面。JSP在被访问时会被容器翻译为Servlet，并在运行时执行。</li></ol><p>这些技术在Java Web开发中相互配合，共同构建出具有动态功能的Web应用程序。Servlet负责处理请求和业务逻辑，Tomcat作为Servlet容器提供运行环境，而JSP用于生成动态的HTML内容。通过使用这些技术，开发人员可以构建出灵活、可交互的Web应用程序。</p><h3 id="传统XML配置SSM-x2F-SSH"><a href="#传统XML配置SSM-x2F-SSH" class="headerlink" title="传统XML配置SSM&#x2F;SSH"></a>传统XML配置SSM&#x2F;SSH</h3><p>在传统的SSM（SpringMVC + Spring + MyBatis）或SSH（Struts2 + Spring + Hibernate）框架中，配置文件通常使用XML来进行配置。下面是一个简单的步骤指南，帮助你了解如何进行传统XML配置。</p><ol><li>创建项目和目录结构：<ul><li>使用IDE（如Eclipse）创建一个动态Web项目。</li><li>创建以下目录结构：<ul><li>src&#x2F;main&#x2F;java：用于存放Java代码。</li><li>src&#x2F;main&#x2F;resources：用于存放配置文件和资源文件。</li><li>src&#x2F;main&#x2F;resources&#x2F;mapper：用于存放MyBatis的SQL映射文件。</li><li>src&#x2F;main&#x2F;resources&#x2F;spring：用于存放Spring的配置文件。</li><li>src&#x2F;main&#x2F;resources&#x2F;sql：用于存放SQL脚本文件。</li><li>src&#x2F;main&#x2F;webapp：用于存放前端静态资源。</li><li>src&#x2F;main&#x2F;webapp&#x2F;resources：用于存放项目的静态资源，如JavaScript、CSS和图片等。</li><li>src&#x2F;main&#x2F;webapp&#x2F;WEB-INF：用于存放JSP文件和web.xml配置文件。</li></ul></li></ul></li><li>配置SpringMVC：<ul><li>在src&#x2F;main&#x2F;webapp&#x2F;WEB-INF目录下创建一个名为springmvc-servlet.xml的SpringMVC配置文件。</li><li>在配置文件中进行SpringMVC的相关配置，如扫描包、视图解析器、处理器映射等。</li></ul></li><li>配置Spring：<ul><li>在src&#x2F;main&#x2F;resources&#x2F;spring目录下创建一个名为spring-context.xml的Spring配置文件。</li><li>在配置文件中进行Spring的相关配置，如扫描包、数据源配置、事务管理等。</li></ul></li><li>配置MyBatis：<ul><li>在src&#x2F;main&#x2F;resources&#x2F;spring目录下创建一个名为spring-mybatis.xml的MyBatis配置文件。</li><li>在配置文件中进行MyBatis的相关配置，如数据源配置、Mapper扫描等。</li><li>在src&#x2F;main&#x2F;resources&#x2F;mapper目录下创建Mapper接口对应的XML文件，用于编写SQL语句。</li></ul></li><li>配置web.xml：<ul><li>在src&#x2F;main&#x2F;webapp&#x2F;WEB-INF目录下创建一个名为web.xml的配置文件。</li><li>在配置文件中进行Servlet、Filter和Listener的配置，以及SpringMVC的DispatcherServlet配置。</li></ul></li><li>编写业务代码：<ul><li>在src&#x2F;main&#x2F;java目录下创建相应的包和类，包括dao、entity、service等。</li><li>在dao包中创建接口，定义数据访问方法。</li><li>在entity包中创建实体类，与数据库表对应。</li><li>在service包中创建接口和实现类，定义业务逻辑。</li><li>在controller包中创建控制器类，处理用户请求。</li></ul></li><li>部署和运行：<ul><li>将项目部署到Web服务器中（如Tomcat）。</li><li>启动Web服务器，访问项目的URL，测试功能是否正常。</li></ul></li></ol><p>这些步骤只是一个简单的指南，实际配置过程可能会因项目需求和框架版本而有所不同。</p><h3 id="SpringBoot"><a href="#SpringBoot" class="headerlink" title="SpringBoot"></a>SpringBoot</h3><p>Spring Boot是一个基于Spring的套件，它帮助我们以尽可能少的代码和配置来开发基于Spring的Java应用程序。它预组装了Spring的一系列组件，使开发变得更加简单和高效。</p><p>以下是使用Spring Boot的基本步骤：</p><ol><li>创建一个Spring Boot项目：可以使用Maven或Gradle构建工具创建一个新的Spring Boot项目。可以使用IDE（如IntelliJ IDEA或Eclipse）的Spring Initializr插件来快速生成项目结构。</li><li>添加Spring Boot依赖：在项目的pom.xml（如果使用Maven）或build.gradle（如果使用Gradle）文件中，添加Spring Boot的依赖项。这些依赖项包括Spring Boot的核心库和其他需要的功能库。</li><li>编写应用程序代码：在src&#x2F;main&#x2F;java目录下编写应用程序的Java代码。可以使用Spring Boot的注解和自动配置来简化开发过程。例如，使用@SpringBootApplication注解标记主类，使用@RestController注解创建一个RESTful API。</li><li>配置应用程序：可以使用application.properties或application.yml文件来配置应用程序的属性，如数据库连接、端口号等。Spring Boot会自动加载这些配置。</li><li>运行应用程序：可以使用IDE的运行按钮或命令行工具来运行Spring Boot应用程序。Spring Boot会自动启动嵌入式的Web服务器，并将应用程序部署到该服务器上。</li><li>测试应用程序：编写单元测试和集成测试来验证应用程序的功能和性能。Spring Boot提供了一些测试工具和注解，使测试变得更加简单和方便。</li><li>打包和部署应用程序：使用Maven或Gradle的打包命令将应用程序打包成可执行的JAR文件或WAR文件。可以将该文件部署到服务器上，或使用Docker等容器技术进行部署。</li></ol><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/5.png" title="wuhu"> <img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/6.png" title="wuhu"><h3 id="SpringCloud-（了解即可）"><a href="#SpringCloud-（了解即可）" class="headerlink" title="SpringCloud （了解即可）"></a>SpringCloud （了解即可）</h3><p>Spring Cloud 是一个开发分布式系统的框架，为开发者提供了一系列的工具集，用于构建分布式系统。它提供了一套简单易用的解决方案，包括服务注册与发现、配置中心、服务网关、负载均衡、断路器、分布式消息队列等等。Spring Cloud 通过封装复杂的配置和实现原理，使开发者能够快速启动服务或构建应用，并与云平台资源进行对接。</p><p>Spring Cloud 包含多个子项目，其中最常用的是 Spring Cloud Netflix 和 Spring Cloud Alibaba。</p><h4 id="Spring-Cloud-Netflix"><a href="#Spring-Cloud-Netflix" class="headerlink" title="Spring Cloud Netflix"></a>Spring Cloud Netflix</h4><p>Spring Cloud Netflix 是 Spring Cloud 的第一代实现，它基于 Netflix 公司的开源组件，提供了以下工具包：</p><ul><li>Netflix Eureka：一个基于 REST 服务的服务治理组件，包括服务注册中心和服务发现机制的实现。</li><li>Netflix Ribbon：客户端负载均衡的服务调用组件。</li><li>Netflix Hystrix：容错管理工具，实现断路器模式，提供强大的容错能力。</li><li>Netflix Feign：基于 Ribbon 和 Hystrix 的声明式服务调用组件。</li><li>Netflix Zuul：微服务网关，提供动态路由和访问过滤等功能。</li><li>Netflix Archaius：配置管理 API，提供动态类型化属性、线程安全配置操作等功能。</li></ul><h4 id="Spring-Cloud-Alibaba"><a href="#Spring-Cloud-Alibaba" class="headerlink" title="Spring Cloud Alibaba"></a>Spring Cloud Alibaba</h4><p>Spring Cloud Alibaba 是 Spring Cloud 的第二代实现，它是一套微服务解决方案，提供了以下组件：</p><ul><li>Nacos：一个动态服务发现、配置管理和服务管理平台。</li><li>Sentinel：面向分布式服务架构的流量控制产品，保护服务的稳定性。</li><li>RocketMQ：一款高可靠的分布式消息系统。</li><li>Dubbo：一款高性能的 Java RPC 框架，用于实现服务通信。</li><li>Seata：一个易于使用的高性能微服务分布式事务解决方案。</li></ul><p>Spring Cloud Alibaba 还包含了阿里云商业化组件，如 Alibaba Cloud ACM、Alibaba Cloud OSS、Alibaba Cloud SchedulerX、Alibaba Cloud SMS 等。</p><h4 id="常用组件"><a href="#常用组件" class="headerlink" title="常用组件"></a>常用组件</h4><p>除了 Netflix 和 Alibaba 的组件，Spring Cloud 还提供了其他常用的组件，包括：</p><ul><li>Spring Cloud Zookeeper：服务注册中心。</li><li>Spring Cloud Consul：服务注册和配置管理中心。</li><li>Spring Cloud Gateway：基于 Spring 5.0、Spring Boot 2.0 和 Project Reactor 等技术开发的网关，提供统一的 API 路由管理方式。</li></ul><p>总之，Spring Cloud 是一个强大的分布式系统开发框架，通过提供丰富的工具集，帮助开发者快速构建和管理分布式系统。</p><h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><p>Java反射是Java语言的一种特性，它允许在程序运行时动态地获取和操作类的信息。通过反射，我们可以在运行时获取类的属性、方法和构造函数等信息，并且可以动态地调用这些属性和方法。这种动态获取和调用的功能对于框架设计和一些特定场景非常有用。</p><h3 id="反射的基本概念和作用"><a href="#反射的基本概念和作用" class="headerlink" title="反射的基本概念和作用"></a>反射的基本概念和作用</h3><p>Java的反射机制允许我们在运行时获取一个类的信息，包括类的成员变量、方法和构造函数等。通过反射，我们可以实现以下功能：</p><ul><li>动态创建对象：可以在运行时根据类的信息动态地创建对象。</li><li>动态调用方法：可以在运行时根据方法名动态地调用对象的方法。</li><li>动态修改属性：可以在运行时根据属性名动态地修改对象的属性值。</li></ul><p>反射的常用类和方法：</p><p>在Java中，反射相关的类主要包括以下几个：</p><ul><li>Class类：表示一个类的信息，可以通过该类获取类的属性、方法和构造函数等信息。</li><li>Constructor类：表示一个类的构造函数，可以通过该类创建对象。</li><li>Field类：表示一个类的成员变量，可以通过该类修改对象的属性值。</li><li>Method类：表示一个类的方法，可以通过该类调用对象的方法。</li></ul><p>常用的反射方法包括：</p><ul><li>Class.forName(String className)：根据类的全限定名获取Class对象。</li><li>Class.getDeclaredFields()：获取类的所有成员变量。</li><li>Class.getDeclaredMethods()：获取类的所有方法。</li><li>Class.getDeclaredConstructors()：获取类的所有构造函数。</li><li>Constructor.newInstance(Object… args)：根据构造函数创建对象。</li><li>Field.set(Object obj, Object value)：设置对象的属性值。</li><li>Method.invoke(Object obj, Object… args)：调用对象的方法。</li></ul><h3 id="反射调用方法与反射修改字段"><a href="#反射调用方法与反射修改字段" class="headerlink" title="反射调用方法与反射修改字段"></a>反射调用方法与反射修改字段</h3><p>动态创建对象、调用方法和修改属性：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Person.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello, my name is &quot;</span> + <span class="built_in">this</span>.name + <span class="string">&quot; and I am &quot;</span> + <span class="built_in">this</span>.age + <span class="string">&quot; years old.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person [name=&quot;</span> + name + <span class="string">&quot;, age=&quot;</span> + age + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ReflectionExample.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 获取Person类的Class对象</span></span><br><span class="line">        Class&lt;?&gt; personClass = Class.forName(<span class="string">&quot;com.example.Person&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 动态创建对象</span></span><br><span class="line">        Constructor&lt;?&gt; constructor = personClass.getConstructor(String.class, <span class="type">int</span>.class);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">person</span> <span class="operator">=</span> constructor.newInstance(<span class="string">&quot;John&quot;</span>, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 动态调用方法</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> personClass.getMethod(<span class="string">&quot;sayHello&quot;</span>);</span><br><span class="line">        method.invoke(person);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 动态修改属性</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> personClass.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.setInt(person, <span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/8.png" title="wuhu"><p><strong>JAVA反射的常规使用步骤</strong></p><p>反射调用一般分为3个步骤：</p><ul><li><p>得到要调用类的class</p></li><li><p>得到要调用的类中的方法(Method)</p></li><li><p>方法调用(invoke)</p><p>代码示例：</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Student.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(<span class="type">int</span> age, String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">(<span class="type">int</span> age, String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hi, I&#x27;m &quot;</span> + name + <span class="string">&quot;, &quot;</span> + age + <span class="string">&quot; years old.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hi, I&#x27;m &quot;</span> + name + <span class="string">&quot;, &quot;</span> + age + <span class="string">&quot; years old.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello, I&#x27;m a static method in Student class.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; Stu = Class.forName(<span class="string">&quot;Student&quot;</span>);</span><br><span class="line">Constructor&lt;?&gt; constructor = Stu.getConstructor(<span class="type">int</span>.class,String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">student</span> <span class="operator">=</span> constructor.newInstance(<span class="number">19</span>,<span class="string">&quot;lazy_fish&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">lms</span> <span class="operator">=</span> Stu.getDeclaredMethod(<span class="string">&quot;hi&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">int</span>.class,String.class&#125;);</span><br><span class="line">lms.invoke(student,<span class="number">20</span>,<span class="string">&quot;lms&quot;</span>);</span><br><span class="line">System.out.println(student);</span><br></pre></td></tr></table></figure><p><strong>方法调用中的参数类型</strong></p><p>​ 在方法调用中，参数类型必须正确，这里需要注意的是不能使用包装类替换基本类型，比如不能使用Integer.class代替int.class。</p><p>​ 如我要调用Student的setAge方法，下面的调用是正确的：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; Stu = Class.forName(<span class="string">&quot;Student&quot;</span>);</span><br><span class="line">Constructor&lt;?&gt; constructor = Stu.getConstructor(<span class="type">int</span>.class,String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">student</span> <span class="operator">=</span> constructor.newInstance(<span class="number">19</span>,<span class="string">&quot;lazy_fish&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">lms</span> <span class="operator">=</span> Stu.getDeclaredMethod(<span class="string">&quot;setAge&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">int</span>.class&#125;);</span><br><span class="line">lms.invoke(student,<span class="number">20</span>);</span><br><span class="line">System.out.println(student);</span><br></pre></td></tr></table></figure><p>而如果我们用Integer.class替代int.class就会出错，如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; Stu = Class.forName(<span class="string">&quot;Student&quot;</span>);</span><br><span class="line">Constructor&lt;?&gt; constructor = Stu.getConstructor(<span class="type">int</span>.class,String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">student</span> <span class="operator">=</span> constructor.newInstance(<span class="number">19</span>,<span class="string">&quot;lazy_fish&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">lms</span> <span class="operator">=</span> Stu.getDeclaredMethod(<span class="string">&quot;setAge&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Integer.class&#125;);</span><br><span class="line">lms.invoke(student,<span class="number">20</span>);</span><br><span class="line">System.out.println(student);</span><br></pre></td></tr></table></figure><p>jvm会报出如下异常：</p><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/9.png" title="wuhu"><p><strong>static方法的反射调用</strong></p><p>static方法调用时，不必得到对象示例，如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;Student&quot;</span>);</span><br><span class="line"><span class="comment">// 获取静态方法</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;sayHello&quot;</span>);</span><br><span class="line"><span class="comment">// 调用静态方法</span></span><br><span class="line">method.invoke(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><p><strong>private的成员变量赋值</strong></p><p>如果直接通过反射给类的private成员变量赋值，是不允许的，这时我们可以通过setAccessible方法解决。代码示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; Stu = Class.forName(<span class="string">&quot;Student&quot;</span>);</span><br><span class="line">Constructor&lt;?&gt; constructor = Stu.getConstructor(<span class="type">int</span>.class,String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">student</span> <span class="operator">=</span> constructor.newInstance(<span class="number">19</span>,<span class="string">&quot;lazy_fish&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">lms</span> <span class="operator">=</span> Stu.getDeclaredMethod(<span class="string">&quot;setAge&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">int</span>.class&#125;);</span><br><span class="line">lms.invoke(student,<span class="number">20</span>);</span><br><span class="line"><span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> Stu.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">field.set(student, <span class="number">10</span>);</span><br><span class="line">System.out.println(field.get(student));</span><br><span class="line">System.out.println(student);</span><br></pre></td></tr></table></figure><p>运行如上代码，系统会报出如下异常：</p><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/10.png" title="wuhu"><p>解决方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; Stu = Class.forName(<span class="string">&quot;Student&quot;</span>);</span><br><span class="line">Constructor&lt;?&gt; constructor = Stu.getConstructor(<span class="type">int</span>.class,String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">student</span> <span class="operator">=</span> constructor.newInstance(<span class="number">19</span>,<span class="string">&quot;lazy_fish&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">lms</span> <span class="operator">=</span> Stu.getDeclaredMethod(<span class="string">&quot;setAge&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">int</span>.class&#125;);</span><br><span class="line">lms.invoke(student,<span class="number">20</span>);</span><br><span class="line"><span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> Stu.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">field.setAccessible(<span class="literal">true</span>);<span class="comment">//设置允许访问  </span></span><br><span class="line">field.set(student, <span class="number">10</span>);</span><br><span class="line">System.out.println(field.get(student));</span><br><span class="line">System.out.println(student);</span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/11.png" title="wuhu"><p>其实，在某些场合下(类中有get,set方法)，可以先反射调用set方法，再反射调用get方法达到如上效果，代码示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">20</span>, <span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反射调用setAge方法设置年龄</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">setAgeMethod</span> <span class="operator">=</span> Student.class.getDeclaredMethod(<span class="string">&quot;setAge&quot;</span>, <span class="type">int</span>.class);</span><br><span class="line">setAgeMethod.invoke(student, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反射调用getAge方法获取年龄</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">getAgeMethod</span> <span class="operator">=</span> Student.class.getDeclaredMethod(<span class="string">&quot;getAge&quot;</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> (<span class="type">int</span>) getAgeMethod.invoke(student);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Age: &quot;</span> + age);</span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/12.png" title="wuhu"><h3 id="反射修改final的问题"><a href="#反射修改final的问题" class="headerlink" title="反射修改final的问题"></a>反射修改final的问题</h3><blockquote><ol><li>Java 8及更早版本：在Java 8及更早的版本中，可以使用反射机制绕过final修饰的变量的限制来修改它的值。通过获取final变量的Field对象，并将其可访问性设置为true，然后使用Field对象的set()方法来修改final变量的值。但是，需要注意的是，这种做法是不安全的，并且可能导致不可预测的行为。</li><li>Java 9及更高版本：从Java 9开始，对于final修饰的变量，Java引入了一个新的概念叫做”Effectively Final”。”Effectively Final”意味着虽然变量被声明为final，但在实际使用中可以修改其值。在这种情况下，反射机制无法修改”Effectively Final”变量的值。因此，从Java 9开始，使用反射机制修改final变量的值可能会导致编译错误或运行时异常。</li></ol></blockquote><p>修改<code>static final</code>属性值，关键在于通过反射将字段的<code>final</code>修饰符去掉</p><p>通过修改<code>Field</code>对象的修饰符可以实现使用反射修改<code>final</code>字段的值。</p><p>在JDK&lt;&#x3D;11，可以按照如下流程修改：</p><blockquote><ol><li>通过反射获取<code>java.lang.reflect.Field</code>内部的<code>modifiers</code> Field</li><li>将修改目标字段的 <code>modifiers</code> 修改为非 <code>final</code></li><li>设置目标字段为新的值</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Student.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(<span class="type">int</span> age, String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单来说，我们通过反射，拿到某个属性的Field对象，再将Field对象中的修饰符<code>modifiers</code>修改成非final，最后再调用反射去修改就可以成功了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Modifier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 创建Student对象</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">20</span>, <span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 反射获取final字段</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">nameField</span> <span class="operator">=</span> Student.class.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置字段的可访问性</span></span><br><span class="line">        nameField.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 修改字段的修饰符为非final</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">modifiersField</span> <span class="operator">=</span> Field.class.getDeclaredField(<span class="string">&quot;modifiers&quot;</span>);</span><br><span class="line">        modifiersField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        modifiersField.setInt(nameField, nameField.getModifiers() &amp; ~Modifier.FINAL);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 修改字段的值</span></span><br><span class="line">        nameField.set(student, <span class="string">&quot;Bob&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 打印修改后的名字</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Name: &quot;</span> + student.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的示例中，我们首先使用反射获取<code>name</code>字段，并通过调用<code>setAccessible(true)</code>方法设置字段的可访问性。然后，我们获取<code>modifiers</code>字段并设置其值，将字段的修饰符中的<code>final</code>标志位设为0，从而使字段变为非<code>final</code>。最后，我们使用<code>set</code>方法将字段的值设置为新的名字。最后，我们打印修改后的名字。</p><p>但自从 Java 12 开始，直接获取 Field 的 <code>modifiers</code> 字段会得到以下错误</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception java.lang.NoSuchFieldException: modifiers <span class="built_in">at</span> java.base/java.lang.Class.getDeclaredField</span><br></pre></td></tr></table></figure><p>但是实际可以通过<code>getDeclaredFields0</code>获取到<code>Fields</code>所有字段</p><p><code>getDeclaredFields0</code>是<code>java.lang.Class</code>下的成员，恰好上面的<code>fieldFilterMap</code>只过滤了<code>java.lang.Class</code>下的<code>classLoader</code>成员，因此我们直接反射调用<code>getDeclaredFields0</code>就能获取到<code>Fields</code>的所有成员</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Method</span> <span class="variable">getDeclaredFields0</span> <span class="operator">=</span> Class.class.getDeclaredMethod(<span class="string">&quot;getDeclaredFields0&quot;</span>, <span class="type">boolean</span>.class);</span><br><span class="line">getDeclaredFields0.setAccessible(<span class="literal">true</span>);</span><br><span class="line">Field[] fields = (Field[]) getDeclaredFields0.invoke(Field.class, <span class="literal">false</span>);</span><br><span class="line"><span class="type">Field</span> <span class="variable">modifierField</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">for</span> (Field f : fields) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;modifiers&quot;</span>.equals(f.getName())) &#123;</span><br><span class="line">        modifierField = f;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">modifierField.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">// 创建Student对象</span></span><br><span class="line"><span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">20</span>, <span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"><span class="comment">// 反射获取final字段</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">nameField</span> <span class="operator">=</span> Student.class.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"><span class="comment">// 设置字段的可访问性</span></span><br><span class="line">nameField.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">// 修改字段的修饰符为非final</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">modifiersField</span> <span class="operator">=</span> Field.class.getDeclaredField(<span class="string">&quot;modifiers&quot;</span>);</span><br><span class="line">modifiersField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">modifiersField.setInt(nameField, nameField.getModifiers() &amp; ~Modifier.FINAL);</span><br><span class="line"><span class="comment">// 修改字段的值</span></span><br><span class="line">nameField.set(student, <span class="string">&quot;Bob&quot;</span>);</span><br><span class="line"><span class="comment">// 打印修改后的名字</span></span><br><span class="line">System.out.println(<span class="string">&quot;Name: &quot;</span> + student.getName());</span><br></pre></td></tr></table></figure><h3 id="利用反射命令执行"><a href="#利用反射命令执行" class="headerlink" title="利用反射命令执行"></a>利用反射命令执行</h3><p>最简单的命令执行</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br></pre></td></tr></table></figure><p>跟踪调用栈可以发现，<code>Runtime#exec</code>并不是命令执行的最终点</p><blockquote><p>java.lang.Runtime#exec</p><p>-&gt; java.lang.ProcessBuilder#start</p><p>-&gt; java.lang.ProcessImpl#start</p><p>-&gt; ProcessImpl#</p><p>-&gt; native create</p></blockquote><p>所以，理论上，下面的方法都可以命令执行</p><blockquote><p>ProcessBuilder.start()</p><p>Runtime.exec()</p><p>ProcessImpl.start()</p><p>ProcessImpl</p></blockquote><p><code>java.lang.Runtime</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">runTime</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;getRuntime&quot;</span>).invoke(<span class="literal">null</span>);</span><br><span class="line">clazz.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(runTime, <span class="string">&quot;calc&quot;</span>);</span><br></pre></td></tr></table></figure><p>也可以获取<code>Runtime</code>的私有构造器去构造<code>Runtime</code>对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"><span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> clazz.getDeclaredConstructor();</span><br><span class="line">constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">clazz.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(constructor.newInstance(), <span class="string">&quot;calc&quot;</span>);</span><br></pre></td></tr></table></figure><p><code>java.lang.ProcessBuilder</code></p><p>除了<code>Runtime.exec()</code>，<code>ProcessBuilder.start()</code>是另外一种命令执行的方式。</p><p><code>java.lang.ProcessBuilder</code>有两个构造函数</p><blockquote><p>public ProcessBuilder(List command)</p><p>public ProcessBuilder(String… command)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">clazz.getMethod(<span class="string">&quot;start&quot;</span>).invoke(clazz.getConstructor(List.class).newInstance(Arrays.asList(<span class="string">&quot;calc&quot;</span>)));</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">clazz.getMethod(<span class="string">&quot;start&quot;</span>).invoke(clazz.getConstructor(String[].class).newInstance(<span class="keyword">new</span> <span class="title class_">String</span>[][]&#123;&#123;<span class="string">&quot;calc&quot;</span>&#125;&#125;));</span><br></pre></td></tr></table></figure><p><code>java.lang.ProcessImpl</code></p><p>start非public类，需要反射调用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessImpl&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">start</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;start&quot;</span>, String[].class, Map.class, String.class, ProcessBuilder.Redirect[].class, <span class="type">boolean</span>.class);</span><br><span class="line">start.setAccessible(<span class="literal">true</span>);</span><br><span class="line">start.invoke(clazz, <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p>ProcessImpl.start()最终调用的是ProceImpl的构造方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessImpl&quot;</span>);</span><br><span class="line"><span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> clazz.getDeclaredConstructor(String[].class, String.class, String.class, <span class="type">long</span>[].class, <span class="type">boolean</span>.class);</span><br><span class="line">constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">constructor.newInstance(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;, <span class="literal">null</span>, <span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">long</span>[]&#123;-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p>通过上述的方法就可以达成命令注入的效果。</p><h3 id="java反射加载字节码GETshell"><a href="#java反射加载字节码GETshell" class="headerlink" title="java反射加载字节码GETshell"></a>java反射加载字节码GETshell</h3><p><strong>介绍</strong></p><p>Java不像其他脚本语言，如js、php、python等有eval函数，可以把字符串当作代码来执行。</p><p>因此在Java中最直接的任意代码执行的方式就是加载字节码了。</p><p>加载字节码的几种方法：</p><blockquote><ol><li>URLClassLoader#loadClass：需要出网或文件落地</li><li>TransletClassLoader#defineClass：一般通过反序列化漏洞打进来</li><li>ClassLoader#defineClass：需要通过反射调用</li></ol></blockquote><p><strong>加载字节码</strong><br>Java中的类加载器负责将字节码文件加载到内存中，并生成对应的Class对象。可以通过自定义ClassLoader来实现动态加载字节码文件。</p><p><strong>动态加载字节码获取shell</strong><br>通过反射和动态加载字节码，可以实现在Java程序中执行恶意代码，从而获取shell权限。具体步骤如下：</p><blockquote><ol><li>创建一个自定义的ClassLoader，继承自java.lang.ClassLoader类。</li><li>在自定义ClassLoader中定义一个方法，接收字节数组类型的参数，并调用父类的defineClass方法动态解析字节码，返回对应的Class对象。</li><li>使用反射调用ClassLoader的defineClass方法，传入字节数组参数，实现动态加载字节码。</li><li>实例化加载的类，并调用其中的方法来执行恶意代码，获取shell权限。</li></ol></blockquote><p>测试实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    Class&lt;?&gt; c = Class.forName(<span class="string">&quot;java.lang.ClassLoader&quot;</span>);</span><br><span class="line">    <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, <span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class);</span><br><span class="line">    method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">byte</span>[] bytes = getEvilCode(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    Class&lt;?&gt; aClass = (Class&lt;?&gt;) method.invoke(Thread.currentThread().getContextClassLoader(), bytes, <span class="number">0</span>, bytes.length);</span><br><span class="line">    aClass.newInstance();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>modifiers Bypass</strong></p><p><code>ClassLoader</code>为PUBLIC，我们只需将<code>defineClass</code>方法的修饰符修改为<code>PUBLIC</code>即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bypassModifier</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;sun.misc.Unsafe&quot;</span>);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">    field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">Unsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> (Unsafe) field.get(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Method</span> <span class="variable">defineClassMethod</span> <span class="operator">=</span> ClassLoader.class.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, <span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">modifiers</span> <span class="operator">=</span> defineClassMethod.getClass().getDeclaredField(<span class="string">&quot;modifiers&quot;</span>);</span><br><span class="line">    unsafe.putShort((Object) defineClassMethod, unsafe.objectFieldOffset(modifiers), (<span class="type">short</span>) Modifier.PUBLIC);</span><br><span class="line"></span><br><span class="line">    <span class="type">byte</span>[] bytes = getEvilCode(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    Class&lt;?&gt; aClass = (Class&lt;?&gt;) defineClassMethod.invoke(Thread.currentThread().getContextClassLoader(), bytes, <span class="number">0</span>, bytes.length);</span><br><span class="line">    aClass.newInstance();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>override Bypass</strong></p><p>注意<code>setAccessible</code>的调用逻辑</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@CallerSensitive</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAccessible</span><span class="params">(<span class="type">boolean</span> flag)</span> &#123;</span><br><span class="line">    AccessibleObject.checkPermission();</span><br><span class="line">    <span class="keyword">if</span> (flag) checkCanSetAccessible(Reflection.getCallerClass());</span><br><span class="line">    setAccessible0(flag);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//checkCanSetAccessible去判断目标的修饰符、目标类是否对调用类开放...最后返回flag再传给setAccessible0</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">setAccessible0</span><span class="params">(<span class="type">boolean</span> flag)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.override = flag;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>setAccessible0</code>直接将flag赋值给<code>this.override</code>，<code>override</code>是其父类<code>AccessibleObject</code>的属性</p><p>因此也可以直接修改<code>java.lang.reflect.AccessibleObject</code>的<code>override</code>属性</p><blockquote><p>注意：</p><p>JDK&gt;&#x3D;12之后（JDK 12&#x2F;13&#x2F;14），反射也过滤<code>java.lang.reflect.AccessibleObject</code>类的所有成员，得通过<code>getDeclaredFields0</code>去获取<code>override</code>属性</p><p>JDK&gt;&#x3D;12报错提示：没有modifiers字段</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.NoSuchFieldException: modifiers <span class="built_in">at</span> java.base/java.lang.Class.getDeclaredField</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bypassOverride</span><span class="params">(Object accessibleObject)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.misc.Unsafe&quot;</span>).getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">    f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">Unsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> (Unsafe) f.get(<span class="literal">null</span>);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">override</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.reflect.AccessibleObject&quot;</span>).getDeclaredField(<span class="string">&quot;override&quot;</span>);</span><br><span class="line">    unsafe.putBoolean(accessibleObject, unsafe.objectFieldOffset(override), <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">Class&lt;?&gt; c = Class.forName(<span class="string">&quot;java.lang.ClassLoader&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, <span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class);</span><br><span class="line">bypassOverride(method);</span><br><span class="line"><span class="type">byte</span>[] bytes = getEvilCode(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">Class&lt;?&gt; aClass = (Class&lt;?&gt;) method.invoke(Thread.currentThread().getContextClassLoader(), bytes, <span class="number">0</span>, bytes.length);</span><br><span class="line">aClass.newInstance();</span><br></pre></td></tr></table></figure><p><strong>fieldFilterMap Bypass</strong></p><p>置空<code>fieldFilterMap</code>置空了。</p><p>通过<code>unsafe.defineAnonymousClass</code>创建匿名内部类，由此匿名类来获取类成员偏移量，最后再通过<code>unsafe.putObject</code>修改原来<code>Reflection</code>类的静态成员<code>fieldFilterMap</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bypassFieldFilterMap</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.misc.Unsafe&quot;</span>).getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">    f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">Unsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> (Unsafe) f.get(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    Class&lt;?&gt; reflectionClass = Class.forName(<span class="string">&quot;jdk.internal.reflect.Reflection&quot;</span>);</span><br><span class="line">    <span class="type">byte</span>[] classBuffer = reflectionClass.getResourceAsStream(<span class="string">&quot;Reflection.class&quot;</span>).readAllBytes();</span><br><span class="line">    Class&lt;?&gt; reflectionAnonymousClass = unsafe.defineAnonymousClass(reflectionClass, classBuffer, <span class="literal">null</span>);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">fieldFilterMap</span> <span class="operator">=</span> reflectionAnonymousClass.getDeclaredField(<span class="string">&quot;fieldFilterMap&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fieldFilterMap.getType().isAssignableFrom(HashMap.class)) &#123;</span><br><span class="line">        unsafe.putObject(reflectionClass, unsafe.staticFieldOffset(fieldFilterMap), <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">byte</span>[] clz = Class.class.getResourceAsStream(<span class="string">&quot;Class.class&quot;</span>).readAllBytes();</span><br><span class="line">    Class&lt;?&gt; classAnonymousClass = unsafe.defineAnonymousClass(Class.class, clz, <span class="literal">null</span>);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">reflectionData</span> <span class="operator">=</span> classAnonymousClass.getDeclaredField(<span class="string">&quot;reflectionData&quot;</span>);</span><br><span class="line">    unsafe.putObject(Class.class, unsafe.objectFieldOffset(reflectionData), <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>defineAnonymousClass Bypass</strong></p><p>虽然JDK11把<code>Unsafe#defineClass</code>移除了，但<code>Unsafe#defineAnonymousClass</code>还在</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.misc.Unsafe&quot;</span>).getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">f.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="type">Unsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> (Unsafe) f.get(<span class="literal">null</span>);</span><br><span class="line">unsafe.defineAnonymousClass(Class.class, getEvilCode(<span class="string">&quot;calc&quot;</span>), <span class="literal">null</span>).newInstance();</span><br></pre></td></tr></table></figure><h2 id="序列化与反序列化"><a href="#序列化与反序列化" class="headerlink" title="序列化与反序列化"></a>序列化与反序列化</h2><p>Java的序列化和反序列化是将Java对象转换为字节序列和将字节序列恢复为Java对象的过程。序列化可以将对象保存到文件或在网络中传输，而反序列化则可以将字节序列转换回原始对象。</p><h3 id="序列化和反序列化的概念"><a href="#序列化和反序列化的概念" class="headerlink" title="序列化和反序列化的概念"></a>序列化和反序列化的概念</h3><p>序列化是将对象转换为字节序列的过程，而反序列化是将字节序列恢复为对象的过程。</p><h3 id="序列化和反序列化的必要性"><a href="#序列化和反序列化的必要性" class="headerlink" title="序列化和反序列化的必要性"></a>序列化和反序列化的必要性</h3><p>序列化和反序列化在以下情况下非常有用：</p><ul><li>分布式对象：序列化可以实现分布式对象，例如在远程调用中运行对象。</li><li>对象复制：序列化不仅可以保存一个对象的数据，还可以递归保存对象引用的每个对象的数据，实现对象的深复制。</li><li>持久化存储：序列化可以将内存中的对象写入文件或数据库中，实现数据的持久化存储。</li><li>跨平台传输：序列化后的对象可以以字节流的形式进行通用的格式传输或保存，传输结束后可以进行反序列化还原。</li></ul><h3 id="实现Java序列化和反序列化的方法"><a href="#实现Java序列化和反序列化的方法" class="headerlink" title="实现Java序列化和反序列化的方法"></a>实现Java序列化和反序列化的方法</h3><p>要实现Java序列化和反序列化，需要按照以下步骤进行：</p><h4 id="实现Serializable接口"><a href="#实现Serializable接口" class="headerlink" title="实现Serializable接口"></a>实现Serializable接口</h4><p>要使一个类可以序列化，需要让该类实现Serializable接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">// 类的成员和方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="序列化对象"><a href="#序列化对象" class="headerlink" title="序列化对象"></a>序列化对象</h4><p>使用ObjectOutputStream类将对象序列化为字节序列。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="type">MyClass</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="type">FileOutputStream</span> <span class="variable">fileOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;object.ser&quot;</span>);</span><br><span class="line"><span class="type">ObjectOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fileOut);</span><br><span class="line">out.writeObject(obj);</span><br><span class="line">out.close();</span><br><span class="line">fileOut.close();</span><br></pre></td></tr></table></figure><h4 id="反序列化对象"><a href="#反序列化对象" class="headerlink" title="反序列化对象"></a>反序列化对象</h4><p>使用ObjectInputStream类将字节序列反序列化为对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fileIn</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;object.ser&quot;</span>);</span><br><span class="line"><span class="type">ObjectInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(fileIn);</span><br><span class="line"><span class="type">MyClass</span> <span class="variable">obj</span> <span class="operator">=</span> (MyClass) in.readObject();</span><br><span class="line">in.close();</span><br><span class="line">fileIn.close();</span><br></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>要进行序列化和反序列化的类必须实现Serializable接口。</li><li>静态变量不会被序列化。</li><li>transient关键字可以用于标记不需要序列化的成员变量。</li></ul><h3 id="反序列化实现漏洞利用"><a href="#反序列化实现漏洞利用" class="headerlink" title="反序列化实现漏洞利用"></a>反序列化实现漏洞利用</h3><h4 id="readObject-方法"><a href="#readObject-方法" class="headerlink" title="readObject()方法"></a>readObject()方法</h4><p>特地提到这个方法是因为在反序列化漏洞中它起到了关键作用，readObject()方法被重写的的话，反序列化该类时调用便是重写后的readObject()方法。如果该方法书写不当的话就有可能引发恶意代码的执行，如</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> evilSerialize;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Evil</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String cmd;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(java.io.ObjectInputStream stream)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        stream.defaultReadObject();</span><br><span class="line">        Runtime.getRuntime().exec(cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> evilSerialize;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Evil evil=<span class="keyword">new</span> <span class="title class_">Evil</span>();</span><br><span class="line">        evil.cmd=<span class="string">&quot;calc&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] serializeData=serialize(evil);</span><br><span class="line">        unserialize(serializeData);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] serialize(<span class="keyword">final</span> Object obj) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">btout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">objOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(btout);</span><br><span class="line">        objOut.writeObject(obj);</span><br><span class="line">        <span class="keyword">return</span> btout.toByteArray();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(<span class="keyword">final</span> <span class="type">byte</span>[] serialized)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ByteArrayInputStream</span> <span class="variable">btin</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(serialized);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">objIn</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(btin);</span><br><span class="line">        <span class="keyword">return</span> objIn.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-original="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/13.png" title="wuhu"><p>但肯定不会有程序员写出这样的代码，所以往往实际中反序列化漏洞的构造比较复杂，而且需要借助Java的一些特性如Java的反射，上文已经较为详细的介绍了反射的使用。</p><h2 id="ASM-x2F-Javassist"><a href="#ASM-x2F-Javassist" class="headerlink" title="ASM&#x2F;Javassist"></a>ASM&#x2F;Javassist</h2><h3 id="字节码是什么？？？"><a href="#字节码是什么？？？" class="headerlink" title="字节码是什么？？？"></a>字节码是什么？？？</h3><p>字节码是一种中间代码，通常指的是经过编译器编译后的、与特定机器码无关的代码。它是一种由编码后的数值常量、引用和指令构成的序列，不像源代码那样容易阅读。字节码的主要目的是实现特定软件的运行和软件环境，与硬件环境无关。它的实现方式是通过编译器和虚拟机器。编译器将源代码编译成字节码，而特定平台上的虚拟机器将字节码转译为可以直接执行的指令。</p><p>Java字节码是Java虚拟机（JVM）执行的一种指令格式，它是Java程序编译后的中间代码。Java字节码具有跨平台的特性，可以在不同的操作系统和硬件平台上运行。它是一种与具体硬件平台无关的中间表示形式，使得Java程序可以在不同的平台上运行而无需重新编译。</p><p>Java字节码是由Java编译器将Java源代码编译成的一系列指令，这些指令被称为字节码指令。每个字节码指令都对应着一种特定的操作，例如存储、加载、算术运算、类型转换、方法调用等。这些指令以二进制形式存储在.class文件中，并由JVM解释执行。</p><p>Java字节码具有以下特点：</p><ol><li>中间表示形式：Java字节码是一种中间表示形式，它不直接运行在物理硬件上，而是由JVM解释执行。</li><li>跨平台性：由于Java字节码与具体硬件平台无关，可以在任何支持Java虚拟机的平台上运行。</li><li>安全性：Java字节码在执行之前会经过严格的安全检查，确保代码的安全性和可靠性。</li><li>可移植性：由于Java字节码可以在不同的平台上运行，使得Java程序具有很高的可移植性。</li></ol><p>Java字节码的执行过程如下：</p><ol><li>Java源代码通过Java编译器编译成字节码文件（.class文件）。</li><li>JVM将字节码文件加载到内存中，并进行解析。</li><li>JVM逐条解释执行字节码指令，执行相应的操作。</li><li>在执行过程中，JVM会进行一些优化操作，如即时编译（Just-In-Time Compilation）等。</li></ol><p>总结起来，Java字节码是一种中间表示形式，它使得Java程序具有跨平台的特性，可以在不同的操作系统和硬件平台上运行。它是由Java编译器将Java源代码编译成的一系列指令，这些指令被JVM解释执行。</p><h3 id="如何用asm修改字节码"><a href="#如何用asm修改字节码" class="headerlink" title="如何用asm修改字节码"></a>如何用asm修改字节码</h3><p>导入ASM库<br>首先，需要导入ASM库到你的项目中。你可以在Maven或Gradle中添加以下依赖项：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Maven--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.ow2.asm<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>asm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>创建ClassVisitor<br>ASM使用访问者模式来处理字节码。你需要创建一个继承自<code>ClassVisitor</code>的类，用于访问和修改字节码的不同部分。你可以重写<code>visitMethod</code>方法来修改方法的字节码。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.objectweb.asm.ClassVisitor;</span><br><span class="line"><span class="keyword">import</span> org.objectweb.asm.MethodVisitor;</span><br><span class="line"><span class="keyword">import</span> org.objectweb.asm.Opcodes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClassVisitor</span> <span class="keyword">extends</span> <span class="title class_">ClassVisitor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyClassVisitor</span><span class="params">(ClassVisitor classVisitor)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(Opcodes.ASM9, classVisitor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MethodVisitor <span class="title function_">visitMethod</span><span class="params">(<span class="type">int</span> access, String name, String desc, String signature, String[] exceptions)</span> &#123;</span><br><span class="line">        <span class="type">MethodVisitor</span> <span class="variable">methodVisitor</span> <span class="operator">=</span> cv.visitMethod(access, name, desc, signature, exceptions);</span><br><span class="line">        <span class="keyword">if</span> (name.equals(<span class="string">&quot;process&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">// 在process方法前插入代码</span></span><br><span class="line">            methodVisitor.visitFieldInsn(Opcodes.GETSTATIC, <span class="string">&quot;java/lang/System&quot;</span>, <span class="string">&quot;out&quot;</span>, <span class="string">&quot;Ljava/io/PrintStream;&quot;</span>);</span><br><span class="line">            methodVisitor.visitLdcInsn(<span class="string">&quot;start&quot;</span>);</span><br><span class="line">            methodVisitor.visitMethodInsn(Opcodes.INVOKEVIRTUAL, <span class="string">&quot;java/io/PrintStream&quot;</span>, <span class="string">&quot;println&quot;</span>, <span class="string">&quot;(Ljava/lang/String;)V&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> methodVisitor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改字节码<br>在你的代码中，使用<code>ClassReader</code>读取原始的字节码文件，然后使用<code>MyClassVisitor</code>来修改字节码，最后使用<code>ClassWriter</code>将修改后的字节码写回到文件中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.objectweb.asm.ClassReader;</span><br><span class="line"><span class="keyword">import</span> org.objectweb.asm.ClassWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BytecodeModifier</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 读取原始的字节码文件</span></span><br><span class="line">        <span class="type">ClassReader</span> <span class="variable">classReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassReader</span>(<span class="string">&quot;com.example.Base&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建ClassWriter</span></span><br><span class="line">        <span class="type">ClassWriter</span> <span class="variable">classWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassWriter</span>(ClassWriter.COMPUTE_MAXS);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建自定义的ClassVisitor</span></span><br><span class="line">        <span class="type">MyClassVisitor</span> <span class="variable">classVisitor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClassVisitor</span>(classWriter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 修改字节码</span></span><br><span class="line">        classReader.accept(classVisitor, ClassReader.SKIP_DEBUG);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取修改后的字节码</span></span><br><span class="line">        <span class="type">byte</span>[] modifiedClass = classWriter.toByteArray();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将修改后的字节码写回到文件中</span></span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;path/to/modified/Bytecode.class&quot;</span>);</span><br><span class="line">        outputStream.write(modifiedClass);</span><br><span class="line">        outputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样，你就可以使用ASM修改Java字节码了。在上面的示例中，我们通过<code>MyClassVisitor</code>类的<code>visitMethod</code>方法，在<code>process</code>方法前插入了一段输出代码。</p><h3 id="如何使用javassist生成字节码"><a href="#如何使用javassist生成字节码" class="headerlink" title="如何使用javassist生成字节码"></a>如何使用javassist生成字节码</h3><p>使用Javassist生成字节码可以通过以下步骤实现：</p><p>导入Javassist库：首先，需要在项目中导入Javassist库。可以通过Maven或手动下载jar包的方式导入。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span><span class="comment">&lt;!--maven--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.18.1-GA<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>创建类池（ClassPool）：使用Javassist进行字节码操作时，需要创建一个类池对象来存储和管理CtClass对象。类池是Javassist中的核心概念之一。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br></pre></td></tr></table></figure><p>创建CtClass对象：CtClass对象代表一个Java类。可以通过类池对象创建CtClass对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CtClass</span> <span class="variable">ctClass</span> <span class="operator">=</span> pool.makeClass(<span class="string">&quot;com.example.MyClass&quot;</span>);</span><br></pre></td></tr></table></figure><p>添加类的属性和方法：可以使用CtClass对象的方法来添加类的属性和方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加字段</span></span><br><span class="line"><span class="type">CtField</span> <span class="variable">field</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CtField</span>(CtClass.intType, <span class="string">&quot;myField&quot;</span>, ctClass);</span><br><span class="line">ctClass.addField(field);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加方法</span></span><br><span class="line"><span class="type">CtMethod</span> <span class="variable">method</span> <span class="operator">=</span> CtNewMethod.make(<span class="string">&quot;public void myMethod() &#123; System.out.println(\&quot;Hello, Javassist!\&quot;); &#125;&quot;</span>, ctClass);</span><br><span class="line">ctClass.addMethod(method);</span><br></pre></td></tr></table></figure><p>生成字节码文件：可以使用CtClass对象的writeFile方法将生成的字节码文件写入磁盘。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctClass.writeFile();</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://gitee.com/la2y_fish/blog.git">1azy_fish.</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://gitee.com/la2y_fish/blog.git/2023/11/07/Java%E5%85%A5%E9%97%A8/">https://gitee.com/la2y_fish/blog.git/2023/11/07/Java%E5%85%A5%E9%97%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gitee.com/la2y_fish/blog.git" target="_blank">1azy_fish.</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/Java/">Java</a></div><div class="post_share"><div class="social-share" data-image="/blog/img/19.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/2023/11/12/%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2022-22965%EF%BC%89/" title="Spring远程命令执行漏洞（CVE-2022-22965）"><img class="cover" src="/img/loading.gif" data-original="/blog/img/23.jpg" onerror='onerror=null,src="/blog/img/loading.gif"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Spring远程命令执行漏洞（CVE-2022-22965）</div></div></a></div><div class="next-post pull-right"><a href="/blog/2023/11/07/web%E4%B8%8E%E6%BA%AF%E6%BA%90/" title="web与溯源"><img class="cover" src="/img/loading.gif" data-original="/blog/img/22.jpg" onerror='onerror=null,src="/blog/img/loading.gif"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">web与溯源</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/blog/2023/11/12/%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2022-22965%EF%BC%89/" title="Spring远程命令执行漏洞（CVE-2022-22965）"><img class="cover" src="/img/loading.gif" data-original="/blog/img/23.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-12</div><div class="title">Spring远程命令执行漏洞（CVE-2022-22965）</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/blog/img/head%20(1).jpg" onerror='this.onerror=null,this.src="/blog/img/head%20(1).jpg"' alt="avatar"></div><div class="author-info__name">1azy_fish.</div><div class="author-info__description">视他人之疑目如盏盏鬼火，大胆去走你的夜路。——史铁生《病隙碎笔》</div></div><div class="card-info-data site-data is-center"><a href="/blog/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/blog/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/blog/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">时光的沙漏里，细沙流走的是光阴。<br>淡淡檀香里，裊袅燃尽的是光阴。<br>白月光只有泡在福尔马林里才不会烂掉。<br><img src="/img/loading.gif" data-original="/blog/img/IP.jpg" width="250" alt="抱歉，可能是我的原因，没有加载出来"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">java基础语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#idea"><span class="toc-number">3.</span> <span class="toc-text">idea</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven"><span class="toc-number">4.</span> <span class="toc-text">Maven</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E9%95%9C%E5%83%8F%E6%BA%90"><span class="toc-number">4.1.</span> <span class="toc-text">如何修改镜像源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%8F%AA%E5%9C%A8%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%94%9F%E6%95%88"><span class="toc-number">4.1.1.</span> <span class="toc-text">配置只在当前项目生效</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%85%A8%E5%B1%80%E7%94%9F%E6%95%88"><span class="toc-number">4.1.2.</span> <span class="toc-text">配置全局生效</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E5%B8%B8%E8%A7%81Maven%E6%8F%92%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">各种常见Maven插件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-compiler-plugin"><span class="toc-number">4.2.1.</span> <span class="toc-text">maven-compiler-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-dependency-plugin"><span class="toc-number">4.2.2.</span> <span class="toc-text">maven-dependency-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-jar-plugin"><span class="toc-number">4.2.3.</span> <span class="toc-text">maven-jar-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-antrun-plugin"><span class="toc-number">4.2.4.</span> <span class="toc-text">maven-antrun-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wagon-maven-plugin"><span class="toc-number">4.2.5.</span> <span class="toc-text">wagon-maven-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-shade-plugin"><span class="toc-number">4.2.6.</span> <span class="toc-text">maven-shade-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-archetype-plugin"><span class="toc-number">4.2.7.</span> <span class="toc-text">maven-archetype-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-assembly-plugin"><span class="toc-number">4.2.8.</span> <span class="toc-text">maven-assembly-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-dependency-plugin-1"><span class="toc-number">4.2.9.</span> <span class="toc-text">maven-dependency-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-enforcer-plugin"><span class="toc-number">4.2.10.</span> <span class="toc-text">maven-enforcer-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-help-plugin"><span class="toc-number">4.2.11.</span> <span class="toc-text">maven-help-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-release-plugin"><span class="toc-number">4.2.12.</span> <span class="toc-text">maven-release-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-resources-plugin"><span class="toc-number">4.2.13.</span> <span class="toc-text">maven-resources-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-surefire-plugin"><span class="toc-number">4.2.14.</span> <span class="toc-text">maven-surefire-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#build-helper-maven-plugin"><span class="toc-number">4.2.15.</span> <span class="toc-text">build-helper-maven-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exec-maven-plugin"><span class="toc-number">4.2.16.</span> <span class="toc-text">exec-maven-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jetty-maven-plugin"><span class="toc-number">4.2.17.</span> <span class="toc-text">jetty-maven-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#versions-maven-plugin"><span class="toc-number">4.2.18.</span> <span class="toc-text">versions-maven-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-war-plugin"><span class="toc-number">4.2.19.</span> <span class="toc-text">maven-war-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maven-shade-plugin-1"><span class="toc-number">4.2.20.</span> <span class="toc-text">maven-shade-plugin</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Maven%E5%A4%9A%E6%A8%A1%E5%9D%97%E9%A1%B9%E7%9B%AE"><span class="toc-number">4.3.</span> <span class="toc-text">Maven多模块项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gradle%E6%98%AF%E5%95%A5%EF%BC%9F%EF%BC%9F%EF%BC%9F"><span class="toc-number">4.4.</span> <span class="toc-text">Gradle是啥？？？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-Web"><span class="toc-number">5.</span> <span class="toc-text">Java Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Servlet-Tomcat-JSP"><span class="toc-number">5.1.</span> <span class="toc-text">Servlet Tomcat JSP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9FXML%E9%85%8D%E7%BD%AESSM-x2F-SSH"><span class="toc-number">5.2.</span> <span class="toc-text">传统XML配置SSM&#x2F;SSH</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBoot"><span class="toc-number">5.3.</span> <span class="toc-text">SpringBoot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringCloud-%EF%BC%88%E4%BA%86%E8%A7%A3%E5%8D%B3%E5%8F%AF%EF%BC%89"><span class="toc-number">5.4.</span> <span class="toc-text">SpringCloud （了解即可）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Cloud-Netflix"><span class="toc-number">5.4.1.</span> <span class="toc-text">Spring Cloud Netflix</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Cloud-Alibaba"><span class="toc-number">5.4.2.</span> <span class="toc-text">Spring Cloud Alibaba</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="toc-number">5.4.3.</span> <span class="toc-text">常用组件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84"><span class="toc-number">6.</span> <span class="toc-text">反射</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E4%BD%9C%E7%94%A8"><span class="toc-number">6.1.</span> <span class="toc-text">反射的基本概念和作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95%E4%B8%8E%E5%8F%8D%E5%B0%84%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5"><span class="toc-number">6.2.</span> <span class="toc-text">反射调用方法与反射修改字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E4%BF%AE%E6%94%B9final%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">6.3.</span> <span class="toc-text">反射修改final的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%8F%8D%E5%B0%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">6.4.</span> <span class="toc-text">利用反射命令执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java%E5%8F%8D%E5%B0%84%E5%8A%A0%E8%BD%BD%E5%AD%97%E8%8A%82%E7%A0%81GETshell"><span class="toc-number">6.5.</span> <span class="toc-text">java反射加载字节码GETshell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">7.</span> <span class="toc-text">序列化与反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">7.1.</span> <span class="toc-text">序列化和反序列化的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7"><span class="toc-number">7.2.</span> <span class="toc-text">序列化和反序列化的必要性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0Java%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">7.3.</span> <span class="toc-text">实现Java序列化和反序列化的方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0Serializable%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.3.1.</span> <span class="toc-text">实现Serializable接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.3.2.</span> <span class="toc-text">序列化对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.3.3.</span> <span class="toc-text">反序列化对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">7.4.</span> <span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AE%9E%E7%8E%B0%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">7.5.</span> <span class="toc-text">反序列化实现漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#readObject-%E6%96%B9%E6%B3%95"><span class="toc-number">7.5.1.</span> <span class="toc-text">readObject()方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ASM-x2F-Javassist"><span class="toc-number">8.</span> <span class="toc-text">ASM&#x2F;Javassist</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E7%A0%81%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%EF%BC%9F%EF%BC%9F"><span class="toc-number">8.1.</span> <span class="toc-text">字节码是什么？？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%94%A8asm%E4%BF%AE%E6%94%B9%E5%AD%97%E8%8A%82%E7%A0%81"><span class="toc-number">8.2.</span> <span class="toc-text">如何用asm修改字节码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8javassist%E7%94%9F%E6%88%90%E5%AD%97%E8%8A%82%E7%A0%81"><span class="toc-number">8.3.</span> <span class="toc-text">如何使用javassist生成字节码</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/11/12/%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2022-22965%EF%BC%89/" title="Spring远程命令执行漏洞（CVE-2022-22965）"><img src="/img/loading.gif" data-original="/blog/img/23.jpg" onerror='this.onerror=null,this.src="/blog/img/loading.gif"' alt="Spring远程命令执行漏洞（CVE-2022-22965）"></a><div class="content"><a class="title" href="/blog/2023/11/12/%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2022-22965%EF%BC%89/" title="Spring远程命令执行漏洞（CVE-2022-22965）">Spring远程命令执行漏洞（CVE-2022-22965）</a><time datetime="2023-11-12T09:00:30.000Z" title="发表于 2023-11-12 17:00:30">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/" title="Java入门"><img src="/img/loading.gif" data-original="/blog/img/19.jpg" onerror='this.onerror=null,this.src="/blog/img/loading.gif"' alt="Java入门"></a><div class="content"><a class="title" href="/blog/2023/11/07/Java%E5%85%A5%E9%97%A8/" title="Java入门">Java入门</a><time datetime="2023-11-07T08:35:58.000Z" title="发表于 2023-11-07 16:35:58">2023-11-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/11/07/web%E4%B8%8E%E6%BA%AF%E6%BA%90/" title="web与溯源"><img src="/img/loading.gif" data-original="/blog/img/22.jpg" onerror='this.onerror=null,this.src="/blog/img/loading.gif"' alt="web与溯源"></a><div class="content"><a class="title" href="/blog/2023/11/07/web%E4%B8%8E%E6%BA%AF%E6%BA%90/" title="web与溯源">web与溯源</a><time datetime="2023-11-07T04:18:32.000Z" title="发表于 2023-11-07 12:18:32">2023-11-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/11/03/%E6%88%91%E7%9A%84%E5%B0%8F%E8%AF%B4%E3%80%8A%E5%8F%88%E4%B8%80%E8%BD%AE%E7%A7%8B%E3%80%8B/" title="《又一轮秋》"><img src="/img/loading.gif" data-original="/blog/img/1.png" onerror='this.onerror=null,this.src="/blog/img/loading.gif"' alt="《又一轮秋》"></a><div class="content"><a class="title" href="/blog/2023/11/03/%E6%88%91%E7%9A%84%E5%B0%8F%E8%AF%B4%E3%80%8A%E5%8F%88%E4%B8%80%E8%BD%AE%E7%A7%8B%E3%80%8B/" title="《又一轮秋》">《又一轮秋》</a><time datetime="2023-11-03T08:14:14.000Z" title="发表于 2023-11-03 16:14:14">2023-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/10/17/Golang%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95/" title="Golang的一些简单漏洞测试"><img src="/img/loading.gif" data-original="/blog/img/20.jpg" onerror='this.onerror=null,this.src="/blog/img/loading.gif"' alt="Golang的一些简单漏洞测试"></a><div class="content"><a class="title" href="/blog/2023/10/17/Golang%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95/" title="Golang的一些简单漏洞测试">Golang的一些简单漏洞测试</a><time datetime="2023-10-17T09:03:46.000Z" title="发表于 2023-10-17 17:03:46">2023-10-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 1azy_fish.</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async mobile="false"></script><div class="fb-customerchat" id="fb-customer-chat" attribution="biz_inbox"></div><script>var chatBtnFn;function chatBtnHide(){FB.CustomerChat.hide()}function chatBtnShow(){FB.CustomerChat.show(!1)}document.getElementById("fb-root")||document.body.insertAdjacentHTML("afterend",'<div id="fb-root"></div>'),window.fbAsyncInit=function(){FB.init({xfbml:!0,version:"v15.0"})},function(t,e,n){var o=t.getElementsByTagName(e)[0];t.getElementById(n)||((t=t.createElement(e)).id=n,t.src="https://connect.facebook.net/zh_CN/sdk/xfbml.customerchat.js",o.parentNode.insertBefore(t,o))}(document,"script","facebook-jssdk")</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>